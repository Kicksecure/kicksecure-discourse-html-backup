<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>USBGuard - what should we allow or disallow by default? - Page 4 - Development - Kicksecure Forums</title>
    <meta name="description" content="Kicksecure 18 is intended to ship USBGuard by default, with a configuration that should block likely-malicious, unknown, and unusual devices. The hope is that it won‚Äôt block so much as to significantly increase the diffi&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.2 - https://github.com/discourse/discourse version 47399adbd4bb44cf4df8a1ae376c83d527378c0a">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1248fdb0.html?page=4" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_light-default_-1_3_b9defff21b08d13cc69fa671cf78b9adfd6d2d01.css_%3b%20filename_%3dUTF-8%27%27color_definitions_light-default_-1_3_b9defff21b08d13cc69?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="../../stylesheets/common_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27common_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/desktop_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27desktop_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/checklist_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27checklist_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-details_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-details_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_38444776255f14470443461f6df0a5b22686426b61cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_38444776255f14470443461f6df0a5b22686426b61cf.cs?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27docker_manager_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27footnote_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27poll_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_38444776255f14470443461f6df0a5b?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_38444776255f14470443461f6df0a5b22686426b.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_38444776255f14470443461f6df0a5b22686426b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_3_eb6c45b414c47cf1d69cd19f601ff6a37d664a5e.css_%3b%20filename_%3dUTF-8%27%27common_theme_3_eb6c45b414c47cf1d69cd19f601ff6a37d664a5e61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/common_theme_2_32d30442083790f9d550ee2919afcddf99dd6419.css_%3b%20filename_%3dUTF-8%27%27common_theme_2_32d30442083790f9d550ee2919afcddf99dd641961cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="header"/>
    <link href="../../stylesheets/desktop_theme_3_e46f64db0c690b5427f0000b2db6865ee6f3cf78.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_e46f64db0c690b5427f0000b2db6865ee6f3cf7861cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>

<script defer="" src="../../theme-javascripts/6bb970c15b81e0b2379f3512812ba45e05a9b972.js_%3b%20filename_%3dUTF-8%27%276bb970c15b81e0b2379f3512812ba45e05a9b97261cf.js?__ws=forums.kicksecure.com" data-theme-id="2" nonce="Wj1BFmRfZepw4PiyD06QPLI4P"></script>

<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;USBGuard - what should we allow or disallow by default?&#39;" href="1248.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248?page=4" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248?page=4" />
<meta property="og:title" content="USBGuard - what should we allow or disallow by default?" />
<meta name="twitter:title" content="USBGuard - what should we allow or disallow by default?" />
<meta property="og:description" content="The Tails configuration seems to be:   Allow all devices that are already connected when the daemon starts   If I am not mistaken, that means if a BadUSB such as a mass storage device also having a hidden keyboard is connected when Tails is booting, that device would be permitted.  I‚Äôve searched the Tails website.   site:https://tails.net/ usbguard   I haven‚Äôt found any documentation by Tails on USBGuard. Related documentation:    I found some noteworthy Tails tickets.      Something to be cons..." />
<meta name="twitter:description" content="The Tails configuration seems to be:   Allow all devices that are already connected when the daemon starts   If I am not mistaken, that means if a BadUSB such as a mass storage device also having a hidden keyboard is connected when Tails is booting, that device would be permitted.  I‚Äôve searched the Tails website.   site:https://tails.net/ usbguard   I haven‚Äôt found any documentation by Tails on USBGuard. Related documentation:    I found some noteworthy Tails tickets.      Something to be cons..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="18 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="51 ‚ù§" />
<meta property="article:published_time" content="2025-11-01T19:24:11+00:00" />
<meta property="og:ignore_canonical" content="true" />

        <link rel="prev" href="12489ba9.html?page=3">

    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>

<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">Kicksecure Forums</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1248.html">USBGuard - what should we allow or disallow by default?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='USBGuard - what should we allow or disallow by default?'>
      <link itemprop='url' href='1248.html'>
      <meta itemprop='datePublished' content='2025-08-24T02:33:02Z'>
        <meta itemprop='articleSection' content='Development'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>

          <span itemprop='author' itemscope itemtype="../../../external.html?link=http://schema.org/Person">
            <meta itemprop='name' content='arraybolt3'>
            <link itemprop='url' rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'>
          </span>
        <meta itemprop='text' content='Kicksecure 18 is intended to ship USBGuard by default, with a configuration that should block likely-malicious, unknown, and unusual devices. The hope is that it won‚Äôt block so much as to significantly increase the diffi&amp;hellip;'>

          <div id='post_61' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-11-01T19:24:11Z' class='post-time'>
                    November 1, 2025,  7:24pm
                  </time>
                  <meta itemprop='dateModified' content='2025-11-01T19:24:11Z'>
              <span itemprop='position'>61</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Quiksilver" data-post="60" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>next to <a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/blob/stable/config/chroot_local-hooks/12-usbguard">Tails</a> (Theirs only protects against Scenario 1),</p>
</blockquote>
</aside>
<p>The Tails configuration seems to be:</p>
<blockquote>
<p>Allow all devices that are already connected when the daemon starts</p>
</blockquote>
<p>If I am not mistaken, that means if a BadUSB such as a mass storage device also having a hidden keyboard is connected when Tails is booting, that device would be permitted.</p>
<p>I‚Äôve searched the Tails website.</p>
<blockquote>
<p>site:<a href="../../../external.html?link=https://tails.net/">https://tails.net/</a> usbguard</p>
</blockquote>
<p>I haven‚Äôt found any documentation by Tails on USBGuard. Related documentation:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://tails.net/doc/about/warnings/computer/">
  <header class="source">
      <img src="../../../external.html?link=https://tails.net/favicon.ico" class="site-icon" alt="" width="37" height="48">

      <a href="../../../external.html?link=https://tails.net/doc/about/warnings/computer/" target="_blank" rel="noopener">tails.net</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="../../../external.html?link=https://tails.net/doc/about/warnings/computer/" target="_blank" rel="noopener">Tails - Reducing risks when using untrusted computers</a></h3>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>I found some noteworthy Tails tickets.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/9569">
  <header class="source">
      <img src="../../../external.html?link=https://gitlab.tails.boum.org/uploads/-/system/appearance/favicon/1/gitlab.png" class="site-icon" alt="" width="32" height="32">

      <a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/9569" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img width="64" height="64" src="../../../external.html?link=https://gitlab.tails.boum.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" class="thumbnail onebox-avatar" alt="">

<h3><a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/9569" target="_blank" rel="noopener">Protect against rogue USB devices with the GNOME USB protection feature...</a></h3>

  <p>Originally created by @intrigeri on #9569 (Redmine) By ‚Äúrogue USB‚Äù...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/20421">
  <header class="source">
      <img src="../../../external.html?link=https://gitlab.tails.boum.org/uploads/-/system/appearance/favicon/1/gitlab.png" class="site-icon" alt="" width="32" height="32">

      <a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/20421" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img width="64" height="64" src="../../../external.html?link=https://gitlab.tails.boum.org/assets/twitter_card-570ddb06edf56a2312253c5872489847a0f385112ddbcd71ccfa1570febab5d2.jpg" class="thumbnail onebox-avatar" alt="">

<h3><a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/issues/20421" target="_blank" rel="noopener">USBGuard bypass (#20421) ¬∑ Issues ¬∑ tails / tails ¬∑ GitLab</a></h3>

  <p>Full Description: https://pulsesecurity.co.nz/advisories/usbguard-bypass GNOME issue: https://gitlab.gnome.org/GNOME/gnome-settings-daemon/-/issues/780</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Something to be considered.</p>
<p>At time of writing, we have the same issue. Consideration on how to fix this below. [1]</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="60" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>They then precede to plug in USB device. Since user can now allow/deny, the device in theory could load code that auto allows since it now has sudo privlages via the change to allow sudo privalges to user for usbguard?</p>
</blockquote>
</aside>
<p>There may be a misunderstanding on your side or my side here.</p>
<p>usbguard-notifier is <strong>not</strong> sudo and does not give account <code>user</code> general sudo/root privileges in user session.</p>
<p>The usbguard daemon runs as root and exposes an IPC interface. Kicksecure adds an IPCAccessControl rule that says ‚Äúusers in this group are allowed to tell usbguard to accept/reject a device.‚Äù The daemon enforces that itself.</p>
<p>So the desktop user only gets a narrow capability (authorize/reject USB devices). Not full sudo/root.</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="60" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Scenario Targeted: user buys USB peripheral online (ie. charging cable, adapter, or mass storage). The USB is swapped with a malicious one in via mail tampering and is swapped for a BadUSB.</p>
</blockquote>
</aside>
<p>For example, a malicious keyboard could always inject extra malicious keystrokes. I.e. inject a unicode character that makes the text that follows invisible, then inject malicious commands to install malware.</p>
<p>Expanded <a href="../../../external.html?link=https://www.kicksecure.com/wiki/USBGuard#Limitations">USBGuard, Limitations</a> just now:</p>
<blockquote>
<p>USBGuard is a device-level gate, not a keystroke-level firewall. Once you have decided ‚Äúthis is a keyboard, and I will allow it,‚Äù the operating system intentionally trusts it exactly like a real human typing. At that point:</p>
<ul>
<li>it can send any keystrokes,</li>
<li>including weird Unicode/control sequences,</li>
<li>including opening a terminal and pasting a malicious payload.</li>
</ul>
<p>USBGuard can help before that point (by refusing extra/composite/suspicious HIDs, or ‚Äúsecond keyboard‚Äù devices). It cannot help after you have allowed a malicious keyboard.</p>
<p>The only protection is ‚Äúdo not allow the wrong keyboard be accepted in the first place‚Äù. ‚ÄúAccept a malicious keyboard and hope USBGuard filters bad keystrokes‚Äù is impossible.</p>
</blockquote>
<p>Related:</p><aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.kicksecure.com/wiki/Unicode">
  <header class="source">
      <img src="../../../external.html?link=https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1761989425" class="site-icon" alt="" width="151" height="151">

      <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Unicode" target="_blank" rel="noopener" title="02:18PM - 07 August 2025">Kicksecure ‚Äì 7 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:640/314;"><img src="../../../external.html?link=https://www.kicksecure.com/w/images/6/69/Unicode123123.png?version=4ba16a3bc989d8453f231f7c07edb359" class="thumbnail" alt="" width="640" height="314"></div>

<h3><a href="../../../external.html?link=https://www.kicksecure.com/wiki/Unicode" target="_blank" rel="noopener">Invisible Malicious Unicode Risks</a></h3>

  <p>Invisible textual characters that leading to security compromises during copy and paste.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Back to your scenario.</p>
<ul>
<li>Charging cable:
<ul>
<li>In a good case, that should be invisible and only show up as the device that is actually connected to it.</li>
<li>In a bad case, it‚Äôs emulates a second keyboard.</li>
</ul>
</li>
<li>Adapter: Same as above.</li>
<li>mass storage: If one USB keyboard is already connected before one plugs in a BadUSB that pretends to be mass storage but also has a hidden keyboard - and suppose our USBGuard rules are set up correctly, then that hidden keyboard interface will be rejected.</li>
</ul>
<hr>
<p>[1] Let‚Äôs suppose a user is using their notebooks internal keyboard (not USB) only but unknowingly has a BadUSB mass storage device that also comes with a hidden keyboard connected at boot time.</p>
<p>How to prevent this?</p>
<p>Default configuration could disallow all USB devices by default unless explicitly, manually allowed by the user.</p>
<p>That wouldn‚Äôt work if the notebook internal keyboard is USB based. In that case, we would have to allow 1 USB keyboard at boot time. Can probably be scripted.</p>
<p>But even if we had this. For best protection, the user would then have to review their USB devices and create their own configuration file. The user would need to have advanced knowledge about USBGuard.</p>
<p>But if the user has advanced knowledge of USBGuard does really our existing configuration get into the way?</p>
<p>This is a clear case of <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Stable_Version_User_Experience#Security_versus_Usability">Security versus Usability</a> / <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reasonable_Security" class="inline-onebox">Reasonable Security</a>.</p>
<p>This is exactly the security vs. usability point: a distribution default has to stay usable for people who just plug in keyboards, mice, webcams, storage. An expert user who‚Äôs worried about mail-swapped cables can (and should) tighten the rules to ‚Äúno HID at boot except this exact device.‚Äù</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_62' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-11-02T11:42:47Z' class='post-time'>
                    November 2, 2025, 11:42am
                  </time>
                  <meta itemprop='dateModified' content='2025-11-02T11:42:47Z'>
              <span itemprop='position'>62</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="onebox githubcommit" data-onebox-src="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/29685938bdfd5c14828091342dbe21283ed45fd1">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/29685938bdfd5c14828091342dbe21283ed45fd1" target="_blank" rel="noopener">github.com/Kicksecure/security-misc</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/29685938bdfd5c14828091342dbe21283ed45fd1" target="_blank" rel="noopener">move usbguard reject rules to the top</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2025-11-02" data-time="10:57:52" data-timezone="UTC">10:57AM - 02 Nov 25 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="" src="../../../external.html?link=https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 22 additions and 22 deletions">
        <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/29685938bdfd5c14828091342dbe21283ed45fd1" target="_blank" rel="noopener">
          <span class="added">+22</span>
          <span class="removed">-22</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubcommit" data-onebox-src="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/5121f80f28d374d78bb3897a46fe924d750f4643">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/5121f80f28d374d78bb3897a46fe924d750f4643" target="_blank" rel="noopener">github.com/Kicksecure/security-misc</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/5121f80f28d374d78bb3897a46fe924d750f4643" target="_blank" rel="noopener">comment</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2025-11-02" data-time="11:00:24" data-timezone="UTC">11:00AM - 02 Nov 25 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/adrelanos" target="_blank" rel="noopener">
          <img alt="" src="../../../external.html?link=https://avatars.githubusercontent.com/u/1985040?v=4" class="onebox-avatar-inline" width="20" height="20">
          adrelanos
        </a>
      </div>

      <div class="lines" title="changed 1 files with 5 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/commit/5121f80f28d374d78bb3897a46fe924d750f4643" target="_blank" rel="noopener">
          <span class="added">+5</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_63' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-12-19T08:46:02Z' class='post-time'>
                    December 19, 2025,  8:46am
                  </time>
                  <meta itemprop='dateModified' content='2025-12-19T08:46:02Z'>
              <span itemprop='position'>63</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="onebox githubissue" data-onebox-src="../../../external.html?link=https://github.com/Kicksecure/security-misc/issues/342">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/issues/342" target="_blank" rel="noopener">github.com/Kicksecure/security-misc</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue" data-github-private-repo="false">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/Kicksecure/security-misc/issues/342" target="_blank" rel="noopener">Evaluate Blocking vendor‚Äëspecific USB Classes (e.g.,‚ÄØFFh) in USBGuard?</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2025-12-15" data-time="16:13:44" data-timezone="UTC">04:13PM - 15 Dec 25 UTC</span>
      </div>


      <div class="user">
        <a href="../../../external.html?link=https://github.com/Gerry-Manders" target="_blank" rel="noopener">
          <img alt="" src="../../../external.html?link=https://avatars.githubusercontent.com/u/225925156?v=4" class="onebox-avatar-inline" width="20" height="20">
          Gerry-Manders
        </a>
      </div>
    </div>

    <div class="labels">
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">My ethernet usb adapter shows `with-interface ff:ff:00 with-connect-type "hotplu<span class="show-more-container"><a href="#" rel="noopener" class="show-more">‚Ä¶</a></span><span class="excerpt hidden">g"`

&gt;Base Class FFh (Vendor Specific)
&gt;&gt; This base class is defined for vendors to use as they please. These class codes can be used in both Device and Interface Descriptors.

`ff:*:*` is the vendor‚Äëspecific class code (class‚ÄØ0xFF) with a vendor‚Äëspecific subclass (0xFF) and protocol‚ÄØ0x00. It is commonly used by USB‚ÄëEthernet chips (e.g., ASIX‚ÄØAX88179, Realtek RTL8153) and other devices that provide their own *proprietary protocol* over USB.

https://www.asix.com.tw/en/product/USBEthernet/Super-Speed_USB_Ethernet/AX88179A

https://devicehunt.com/view/type/usb/vendor/0B95

https://forum.openwrt.org/t/usb-to-ethernet-adapter-asix-elec-corp-ax88x72a/164968/7

F****** proprietary should I be concerned now or what? Because the class is undefined by the USB‚ÄëIF, can it also be abused to hide unexpected functionality? 

With so much proprietary today is it only generic adapters that use this? Do you think its commonplace with name brand Ethernet adapters commonly found in box stores to also use vendor-specific aka proprietary?


Also both my mouse and keyboard I bought in person say HID? ( I bought in person not online)

Wired optical mouse (Walmart ONN brand) output: `with-interface 03:01:02 with-connect-type "hotplug"`

Wired keyboard output: `with-interface { 03:01:01 03:00:00 } with-connect-type "hotplug"`

The USB Ethernet Adapter I bought on Amazon so...kinda worried here

Does the driver listed with usbcore mean that it can secretly use HID or is that global dependency for the whole USB stack of all active USB devices?

```
user@host:~$ lsmod | grep ax88179
ax88179_178a           36864  0
usbnet                 57344  1 ax88179_178a
mii                    16384  2 usbnet,ax88179_178a
usbcore               348160  9 xhci_hcd,ehci_pci,usbnet,usbhid,usb_storage,ehci_hcd,xhci_pci,uas,ax88179_178a
```

Can udev be used to see which kernel driver was selected. Like If a device that should be a plain mouse or ethernet ends up bound to a generic driver that accepts vendor‚Äëspecific control transfers would that indicate a red flag?

---
## Key points
### Security surface
&gt; Vendor‚Äëspecific class‚ÄØFFh lets a device define its own protocol. An attacker could craft a malicious dongle that pretends to be a harmless peripheral (network card, storage, etc.) while actually executing hidden commands.


### Device compatibility
&gt; A portion of consumer‚Äëgrade USB‚ÄëEthernet adapters (ASIX‚ÄØAX88179, Realtek‚ÄØRTL8153, etc.) use class‚ÄØFFh. \
How much that is undetermined and needs more research.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_64' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2026-01-13T01:22:00Z' class='post-time'>
                    January 13, 2026,  1:22am
                  </time>
                  <meta itemprop='dateModified' content='2026-01-13T01:22:00Z'>
              <span itemprop='position'>64</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="onebox githubcommit" data-onebox-src="../../../external.html?link=https://github.com/ArrayBolt3/user-sysmaint-split/commit/dcaf6b7a924e832e646023fc8f81865389e50764">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/ArrayBolt3/user-sysmaint-split/commit/dcaf6b7a924e832e646023fc8f81865389e50764" target="_blank" rel="noopener">github.com/ArrayBolt3/user-sysmaint-split</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="../../../external.html?link=https://github.com/ArrayBolt3/user-sysmaint-split/commit/dcaf6b7a924e832e646023fc8f81865389e50764" target="_blank" rel="noopener">Enable usbguard-dbus.service in sysmaint sessions by default</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2026-01-13" data-time="01:21:20" data-timezone="UTC">01:21AM - 13 Jan 26 UTC</span>
      </div>

      <div class="user">
        <a href="../../../external.html?link=https://github.com/ArrayBolt3" target="_blank" rel="noopener">
          <img alt="" src="../../../external.html?link=https://avatars.githubusercontent.com/u/104878738?v=4" class="onebox-avatar-inline" width="20" height="20">
          ArrayBolt3
        </a>
      </div>

      <div class="lines" title="changed 2 files with 3 additions and 0 deletions">
        <a href="../../../external.html?link=https://github.com/ArrayBolt3/user-sysmaint-split/commit/dcaf6b7a924e832e646023fc8f81865389e50764" target="_blank" rel="noopener">
          <span class="added">+3</span>
          <span class="removed">-0</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>

      <div role='navigation' itemscope itemtype='http://schema.org/SiteNavigationElement' class="topic-body crawler-post">
            <span itemprop='name'><a rel="prev" itemprop="url" href="12489ba9.html?page=3">‚Üê previous page</a></span>
      </div>

    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
