<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Dracut compression research - Development - Kicksecure Forums</title>
    <meta name="description" content="Patrick asked me to look into the compression options offered by Dracut for initramfs compression. This is the results of that research, written here since the results are a bit lengthy and require the ability to post im&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.6 - https://github.com/discourse/discourse version 3d149ba8244585f4bcb41db77aa8825e72468bdb">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1131.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c162268923430.css_%3b%20filename_%3dUTF-8%27%27color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c1622689234306?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="../../stylesheets/desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="../../stylesheets/checklist_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27checklist_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="../../stylesheets/discourse-details_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-details_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="../../stylesheets/discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="../../stylesheets/discourse-local-dates_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="../../stylesheets/discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab261cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="../../stylesheets/discourse-presence_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="../../stylesheets/docker_manager_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27docker_manager_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="../../stylesheets/footnote_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27footnote_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="../../stylesheets/poll_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
  <link href="../../stylesheets/poll_desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c8.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c861cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a92.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a9261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="header"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>



<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Dracut compression research&#39;" href="1131.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/e92324d818d85c5e818003116c0999d6539ad7a6.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/e92324d818d85c5e818003116c0999d6539ad7a6.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/dracut-compression-research/1131" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/dracut-compression-research/1131" />
<meta property="og:title" content="Dracut compression research" />
<meta name="twitter:title" content="Dracut compression research" />
<meta property="og:description" content="Patrick asked me to look into the compression options offered by Dracut for initramfs compression. This is the results of that research, written here since the results are a bit lengthy and require the ability to post images for sharing the charts I made.  tl;dr: I think we should use xz compression. It‚Äôs acceptably fast, it compresses way better, and there doesn‚Äôt seem to be any compelling reason to avoid it.  The initramfs has to be decompressed by the kernel on boot, so I only researched comp..." />
<meta name="twitter:description" content="Patrick asked me to look into the compression options offered by Dracut for initramfs compression. This is the results of that research, written here since the results are a bit lengthy and require the ability to post images for sharing the charts I made.  tl;dr: I think we should use xz compression. It‚Äôs acceptably fast, it compresses way better, and there doesn‚Äôt seem to be any compelling reason to avoid it.  The initramfs has to be decompressed by the kernel on boot, so I only researched comp..." />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 ‚ù§" />
<meta property="article:published_time" content="2025-07-08T00:48:15+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>
<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">
    Kicksecure Forums
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1131.html">Dracut compression research</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Dracut compression research'>
      <link itemprop='url' href='1131.html'>
      <meta itemprop='datePublished' content='2025-07-08T00:48:15Z'>
        <meta itemprop='articleSection' content='Development'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="1131.html">

                <link itemprop="image" href="../../uploads/default/original/1X/e92324d818d85c5e818003116c0999d6539ad7a6.png">

              <span class="crawler-post-infos">
                  <time  datetime='2025-07-08T00:48:15Z' class='post-time'>
                    July 8, 2025, 12:48am
                  </time>
                  <meta itemprop='dateModified' content='2025-07-08T00:48:15Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Patrick asked me to look into the compression options offered by Dracut for initramfs compression. This is the results of that research, written here since the results are a bit lengthy and require the ability to post images for sharing the charts I made.</p>
<p><strong>tl;dr: I think we should use xz compression. It‚Äôs acceptably fast, it compresses way better, and there doesn‚Äôt seem to be any compelling reason to avoid it.</strong></p>
<p>The initramfs has to be decompressed by the kernel on boot, so I only researched compression algorithms supported by the kernel in Debian Bookworm. (Trixie supports the exact same compression algorithms, so this research should apply to Trixie as well, assuming the compression utilities perform similarly in Trixie to how they perform in Bookworm, which I find likely given the age of these utilities.)</p>
<p>Bookworm‚Äôs kernel and Dracut both support the following compression algorithms:</p>
<ul>
<li>gzip (this is what we‚Äôre using now)</li>
<li>lz4</li>
<li>lzma</li>
<li>lzo</li>
<li>xz</li>
<li>zstd</li>
<li>cat (uncompressed, taken into consideration to provide a best-case scenario for time and a worst-case scenario for size)</li>
</ul>
<p>Dracut also supports bzip2, but Bookworm‚Äôs and Trixie‚Äôs kernels both did not appear to support that.</p>
<p>To determine which algorithm was most likely desirable, I benchmarked them against each other. The following testing methodology was used:</p>
<ul>
<li>Create a file, <code>/etc/dracut.conf.d/99-compress.conf</code> to set the compression algorithm in.</li>
<li>For each compression algorithm, change <code>99-compress.conf</code> to specify the desired algorithm, then run <code>time sudo dracut --force</code> three times.</li>
<li>Record the output of <code>time</code> after each dracut invocation.</li>
<li>Record the size of the output initramfs after each dracut invocation.</li>
</ul>
<p>In all instances, the file size of the output initramfs was identical (to within a kilobyte at least) across all three runs of Dracut when using a single compression algorithm, so I only recorded file size once per algorithm. All tests were run in a KVM/QEMU virtual machine with 4 virtual CPUs, 4 GB RAM, and all host CPU features passed through to the guest (<code>-cpu host</code>). The host system has an i9-14900HX processor. The raw results of the benchmarks are as follows:</p>
<ul>
<li>gzip
<ul>
<li>run 1: <code>0.06s user 0.10s system 1% cpu 12.240 total</code></li>
<li>run 2: <code>0.01s user 0.02s system 0% cpu 10.907 total</code></li>
<li>run 3: <code>0.01s user 0.02s system 0% cpu 10.912 total</code></li>
<li>file size: <code>39724K</code></li>
</ul>
</li>
<li>lz4
<ul>
<li>run 1: <code>0.02s user 0.01s system 0% cpu 7.476 total</code></li>
<li>run 2: <code>0.02s user 0.01s system 0% cpu 7.408 total</code></li>
<li>run 3: <code>0.01s user 0.02s system 0% cpu 7.541 total</code></li>
<li>file size: <code>48064K</code></li>
</ul>
</li>
<li>lzma
<ul>
<li>run 1: <code>0.09s user 0.07s system 0% cpu 46.595 total</code></li>
<li>run 2: <code>0.01s user 0.02s system 0% cpu 45.677 total</code></li>
<li>run 3: <code>0.02s user 0.01s system 0% cpu 45.339 total</code></li>
<li>file size: <code>26292K</code></li>
</ul>
</li>
<li>lzop
<ul>
<li>run 1: <code>0.09s user 0.08s system 0% cpu 38.810 total</code></li>
<li>run 2: <code>0.02s user 0.01s system 0% cpu 37.862 total</code></li>
<li>run 3: <code>0.01s user 0.02s system 0% cpu 37.837 total</code></li>
<li>file size: <code>44880K</code></li>
</ul>
</li>
<li>xz
<ul>
<li>run 1: <code>0.09s user 0.08s system 1% cpu 11.655 total</code></li>
<li>run 2: <code>0.01s user 0.01s system 0% cpu 10.542 total</code></li>
<li>run 3: <code>0.02s user 0.01s system 0% cpu 10.571 total</code></li>
<li>file size: <code>28288K</code></li>
</ul>
</li>
<li>zstd
<ul>
<li>run 1: <code>0.10s user 0.07s system 1% cpu 8.676 total</code></li>
<li>run 2: <code>0.08s user 0.09s system 2% cpu 7.680 total</code></li>
<li>run 3: <code>0.01s user 0.01s system 0% cpu 7.404 total</code></li>
<li>file size: <code>33248K</code></li>
</ul>
</li>
<li>cat (no compression, baseline)
<ul>
<li>run 1: <code>0.09s user 0.08s system 3% cpu 5.279 total</code></li>
<li>run 2: <code>0.01s user 0.02s system 0% cpu 4.189 total</code></li>
<li>run 3: <code>0.01s user 0.02s system 0% cpu 4.252 total</code></li>
<li>file size: <code>136088K</code></li>
</ul>
</li>
</ul>
<p>I did not benchmark boot speed with each of the different algorithms used, although I did verify that the virtual machine booted with an initramfs made with each algorithm. The boot speed seemed pretty much the same to me with each algorithm, and would have been difficult to measure in an objective, reliable fashion. I will note, I may have noticed a very slight speedup during boot with the zstd algorithm.</p>
<p>The following two graphs are provided to visualize the data above (created using LibreOffice):</p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../uploads/default/original/1X/e92324d818d85c5e818003116c0999d6539ad7a6.png" data-download-href="https://forums.kicksecure.com/uploads/default/e92324d818d85c5e818003116c0999d6539ad7a6" title="initramfs-gen-speed"><img src="../../uploads/default/original/1X/e92324d818d85c5e818003116c0999d6539ad7a6.png" alt="initramfs-gen-speed" data-base62-sha1="xgqxRhWowoHkhwQKDySGIr6PCzI" width="605" height="340"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">initramfs-gen-speed</span><span class="informations">605√ó340 17.8 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p><div class="lightbox-wrapper"><a class="lightbox" href="../../uploads/default/original/1X/2bd2414d9be6f209da5f48a7de40331332b64632.png" data-download-href="https://forums.kicksecure.com/uploads/default/2bd2414d9be6f209da5f48a7de40331332b64632" title="initramfs-gen-efficiency"><img src="../../uploads/default/original/1X/2bd2414d9be6f209da5f48a7de40331332b64632.png" alt="initramfs-gen-efficiency" data-base62-sha1="6fF02CNFpWuQxjjDkTxl0imYZz4" width="605" height="340"><div class="meta"><svg class="fa d-icon d-icon-far-image svg-icon" aria-hidden="true"><use href="#far-image"></use></svg><span class="filename">initramfs-gen-efficiency</span><span class="informations">605√ó340 19.7 KB</span><svg class="fa d-icon d-icon-discourse-expand svg-icon" aria-hidden="true"><use href="#discourse-expand"></use></svg></div></a></div></p>
<p>Takeaways from the above data:</p>
<ul>
<li>From a size standpoint, lzma performed the best, lz4 performed the worst.</li>
<li>From a speed standpoint, zstd and lz4 are about tied for best speed, while lzma is the worst for speed.</li>
<li>lzo/lzop is certainly a bad choice - it approaches lzma in slowness while also making a file larger than gzip and almost as large as lz4. It‚Äôs the worst of all worlds combined.</li>
<li>xz is probably the most compelling as far as a balance between good speed and good compression - it‚Äôs almost as good as lzma as far as size, while being just a hair faster than gzip.</li>
<li>zstd is a bit of an improvement over gzip in size, while also being very very fast.</li>
</ul>
<p>I am of the opinion that xz is the best choice here based on this data, as our existing compression speed has been acceptable and shaving off 2-3 seconds per initramfs generation doesn‚Äôt seem that compelling except perhaps when doing ARM builds of Kicksecure on x86_64 hardware.</p>
<p>It is worth noting, people who know much more about compression tools under the hood than I do have complaints about design flaws in xz, which are documented <a href="../../../external.html?link=https://www.nongnu.org/lzip/xz_inadequate.html" rel="noopener nofollow ugc">here</a>. I do not believe the issues mentioned in this article are of concern for the following reasons:</p>
<ul>
<li>The article primarily relates to xz‚Äôs suitability for long-term archival. Kernel initramfs files aren‚Äôt really something where ‚Äúlong-term archival‚Äù is a concern.</li>
<li>Most of the article focuses on xz‚Äôs lack of resiliency in the face of partial archive corruption. But we don‚Äôt care about this at all, we assume the initramfs is bit-for-bit identical to when it was created, and indeed in the future we will likely be signing the initramfs as part of Verified Boot (which will mandate that the initramfs be bit-for-bit idential to when it was created).</li>
<li>Other parts of the article focus on compatibility issues with different versions of xz. This also is not a concern - as long as dracut produces an initramfs that the Linux kernel can read and boot with, things are compatible enough for us.</li>
<li>The rest of the article appears to focus on various design decisions in xz that could have been made better. None of that is relevant for us though, since whatever feature set Dracut is using in xz is good enough to give it a very acceptable compression speed while also providing the second-smallest file size of any of the compression algorithms documented here. Even if xz could be better than it is, right now it‚Äôs better than everything else except maybe zstd if you really care about speed.</li>
</ul>
<p>Someone else I saw did <a href="../../../external.html?link=https://linuxreviews.org/Comparison_of_Compression_Algorithms" rel="noopener nofollow ugc">similar compression performance benchmarking</a> and concluded that <code>zstd</code> was the best general-purpose algorithm, though the data they present shows that parallel xz actually performed better than zstd‚Äôs best compression in both compression size and speed. One concerning thing this article does point out though is that xz can use a lot of RAM. For this reason, I tried generating a dracut initramfs using xz compression in a Kicksecure-CLI VirtualBox VM with only 512 MB RAM. Memory consumption during the initramfs generation rose to a maximum of 318M according to htop, and went down to 263M once the initramfs was generated, meaning that dracut and whatever tools it ran (including xz) used about 55M of memory during the generation process. Only about 1.97M of swap ended up used. This is much more than both gzip and zstd (which both only require about 5M of memory), but seems acceptable to me. 55M is not that much, especially given that <code>fwupd</code> is just sitting there eating 97M while doing basically nothing.</p>
<p>As a final note, I checked <a href="../../../external.html?link=http://cve.org/" rel="noopener nofollow ugc">cve.org</a> to see if security vulnerabilities were found in either the xz or zstd compressors in the Linux kernel. I found no vulnerabilities for either algorithm (using the search terms ‚Äúlinuz kernel xz‚Äù and ‚Äúlinux kernel zstd‚Äù).</p>
<p>In conclusion, I believe xz is the best compression method for us to use with dracut, due to its slightly better performance and much better compression compared to our current default, gzip. zstd is my second choice, and may be what we want to use if we have problems with xz‚Äôs speed or memory consumption.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/nurmagoz'><span itemprop='name'>nurmagoz</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-11T17:12:13Z' class='post-time'>
                    July 11, 2025,  5:12pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-11T17:12:13Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Fedora were using xz and done the comparison of xz VS zstd, the conclusion reached is that zstd overall will give better performance for the users:</p>
<p><a href="../../../external.html?link=https://fedoraproject.org/wiki/Changes/Switch_RPMs_to_zstd_compression#Use_case:_Firefox_installation" class="onebox" target="_blank" rel="noopener">https://fedoraproject.org/wiki/Changes/Switch_RPMs_to_zstd_compression#Use_case:_Firefox_installation</a></p>
<p>Another comparison by different project (not against xz but useful):</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://peazip.github.io/fast-compression-benchmark-brotli-zstandard.html#brotli_vs_zstd_compressor">
  <header class="source">

      <a href="../../../external.html?link=https://peazip.github.io/fast-compression-benchmark-brotli-zstandard.html#brotli_vs_zstd_compressor" target="_blank" rel="noopener">PeaZip file archiver utility, free RAR ZIP software</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="../../../external.html?link=https://peazip.github.io/fast-compression-benchmark-brotli-zstandard.html#brotli_vs_zstd_compressor" target="_blank" rel="noopener">Fast compression: Brotli Zstandard comparative speed performances test</a></h3>

  <p>Fast compression benchmark. Comparison of Brotli, Zstandard formats performances, br vs zst compression and extraction speed, comparative test with 7Z LZMA2, RAR PPMd, ZIP Deflate algorithms.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Second issue of xz is the Nebraska issue (too much work for very important software for single or very few devs over long time):</p>
<aside class="onebox discoursetopic" data-onebox-src="../../../external.html?link=https://discussion.fedoraproject.org/t/switch-to-zstd-from-xz/110789/16">
  <header class="source">
      <img src="../../../external.html?link=https://us1.discourse-cdn.com/fedoraproject/optimized/2X/4/4a936c14d6cd5d29d6b7baf2511e406eeabed12c_2_32x32.png" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://discussion.fedoraproject.org/t/switch-to-zstd-from-xz/110789/16" target="_blank" rel="noopener" title="04:00AM - 01 April 2024">Fedora Discussion ‚Äì 1 Apr 24</a>
  </header>

  <article class="onebox-body">
    <img src="../../../external.html?link=https://us1.discourse-cdn.com/fedoraproject/original/2X/4/4701afb8ed62770e56cfd748606abe1c0d616b84.png" class="thumbnail onebox-avatar" width="500" height="500">

<div class="title-wrapper">
  <h3><a href="../../../external.html?link=https://discussion.fedoraproject.org/t/switch-to-zstd-from-xz/110789/16" target="_blank" rel="noopener">Switch to zstd from xz</a></h3>
  <div class="topic-category">
      <span class="badge-wrapper bullet">
        <span class="badge-category-bg" style="background-color: #51A2DA;"></span>
        <span class="badge-category clear-badge">
          <span class="category-name">Project Discussion</span>
        </span>
      </span>
    <div class="topic-header-extra">
      <div class="list-tags">
        <div class="discourse-tags">
          <svg class="fa d-icon d-icon-tag svg-icon svg-string"><use href="#tag"></use></svg>
            <span class="discourse-tag simple">silverblue-team</span>
            <span class="discourse-tag simple">workstation-wg</span>
        </div>
      </div>
    </div>
  </div>
</div>

  <p>You won‚Äôt find much disagreement that zstd is a better algorithm, in most cases.  This is pretty well understood by this point.  Again though, it‚Äôs kind of beside the point.  Things that currently use XZ, cannot necessarily just switch out of the...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>The XZ maintainer experienced burnout and consequently scaled back some of the contribution reviews, which led to the XZ issue. GNOME discussed this issue as well:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://gitlab.gnome.org/GNOME/nautilus/-/issues/1936#note_2090670">
  <header class="source">
      <img src="../../../external.html?link=https://gitlab.gnome.org/uploads/-/system/appearance/favicon/1/GnomeLogoVertical.svg.png" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://gitlab.gnome.org/GNOME/nautilus/-/issues/1936#note_2090670" target="_blank" rel="noopener">GitLab</a>
  </header>

  <article class="onebox-body">
    <img width="64" height="64" src="../../../external.html?link=https://gitlab.gnome.org/uploads/-/system/project/avatar/1/bitmap.png" class="thumbnail onebox-avatar">

<h3><a href="../../../external.html?link=https://gitlab.gnome.org/GNOME/nautilus/-/issues/1936#note_2090670" target="_blank" rel="noopener">Use zst compression instead of xz (#1936) ¬∑ Issues ¬∑ GNOME / Files ¬∑ GitLab</a></h3>

  <p>Use cases ZStandard is a new file compression algorithm, the reference implementation of which, zstd, greatly outperforms every other compression method...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Bottom line is that zstd is the way to go.</p>
<p>Good thing that you reached to the conclusion second best choice.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-11T18:10:22Z' class='post-time'>
                    July 11, 2025,  6:10pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-11T18:10:22Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>It‚Äôs worth noting that Fedora switched to zstd specifically for RPM<br>
compression. The initramfs use case is substantially different - size is<br>
more important than speed (to a point) because a too-big initramfs might<br>
fail to boot entirely. This may become a real risk once we start using<br>
Dracut‚Äôs ‚Äúsloppy hostonly‚Äù improvements, which include a lot more kernel<br>
modules and thus increase the size of the initramfs. The performance impact<br>
of zstd is benchmarked for initramfs compression above, and the impact is<br>
arguably negligible.</p>
<p>We shouldn‚Äôt let XZ‚Äôs reputation be tarnished after the xz-utils backdoor,<br>
in my opinion. The attack‚Äôs level of sophistication was high enough that I<br>
doubt most people would have handled things any better than the primary<br>
maintainer did, and after this experience I don‚Äôt believe he‚Äôll make the<br>
same mistakes again. XZ‚Äôs source code is, to the best of our knowledge,<br>
clean currently, so I don‚Äôt believe the attack is a good reason to avoid it.</p>
<p>As for the Nebraska issue, that is a real problem. Zstd has the full force<br>
of Facebook backing it up, so it‚Äôs in a much better position to remain<br>
maintained. (Arguably it‚Äôs in a good position to be backdoored by a<br>
nation-state too, but that depends on how much you trust Meta I guess :P)<br>
That being said, as long as xz works reliably for initramfs compression<br>
when Debian 13 rolls around, I don‚Äôt see an issue - Debian will be<br>
responsible for keeping it safe and maintained at that point, and we can<br>
change our minds for a future release of Kicksecure. If we were using a<br>
rolling form of Debian, I‚Äôd probably pick zstd due to this concern, but<br>
since we‚Äôre using stable releases, I don‚Äôt see any substantial danger in<br>
using xz.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/nurmagoz'><span itemprop='name'>nurmagoz</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-11T23:07:37Z' class='post-time'>
                    July 11, 2025, 11:07pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-11T23:07:37Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="arraybolt3" data-post="3" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>The initramfs use case is substantially different - size is<br>
more important than speed (to a point) because a too-big initramfs might<br>
fail to boot entirely.</p>
</blockquote>
</aside>
<p>It was done as change everything to zstd:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.phoronix.com/news/Fedora-43-Initrd-Zstd-Compress">
  <header class="source">
      <img src="../../../external.html?link=https://www.phoronix.com/favicon.ico" class="site-icon" width="48" height="48">

      <a href="../../../external.html?link=https://www.phoronix.com/news/Fedora-43-Initrd-Zstd-Compress" target="_blank" rel="noopener">phoronix.com</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:554/185;"><img src="../../../external.html?link=https://www.phoronix.net/image.php?id=2025&amp;image=initrd_zstd" class="thumbnail" width="554" height="185"></div>

<h3><a href="../../../external.html?link=https://www.phoronix.com/news/Fedora-43-Initrd-Zstd-Compress" target="_blank" rel="noopener">Fedora 43 Looks To Zstd-Compressed Initrd By Default For Space Savings &amp;...</a></h3>

  <p>A change proposal has been raised to compress the initrd by default using Zstd compression rather than XZ</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="quote no-group" data-username="arraybolt3" data-post="3" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>(Arguably it‚Äôs in a good position to be backdoored by a<br>
nation-state too, but that depends on how much you trust Meta I guess :P)</p>
</blockquote>
</aside>
<p>Lol yeah thought about that from this perspective, but if we come to the linux kernel itself, these companies hands already there anyway (intel,nvidia‚Ä¶etc). So we go with the free software or not (and reliably secure) regardless the source from where, otherwise its a lost case.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="3" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>Debian will be<br>
responsible for keeping it safe and maintained at that point</p>
</blockquote>
</aside>
<p>Yeah guess who discovered xz backdoor? not a debian maintainer or so, but a microsoft engineer‚Ä¶</p>
<p>So if there are no big issues with zstd + debian, i dont see it a bad choice imho.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-11T23:22:07Z' class='post-time'>
                    July 11, 2025, 11:22pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-11T23:22:07Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="nurmagoz" data-post="4" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>It was done as change everything to zstd:</p>
</blockquote>
</aside>
<p>OK, good to know.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="4" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>Lol yeah thought about that from this perspective, but if we come to the linux kernel itself, these companies hands already there anyway (intel,nvidia‚Ä¶etc). So we go with the free software or not (and reliably secure) regardless the source from where, otherwise its a lost case.</p>
</blockquote>
</aside>
<p>Indeed, I made that comment mostly as a joke, thus the ‚Äú:P‚Äù.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="4" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>Yeah guess who discovered xz backdoor? not a debian maintainer or so, but a microsoft engineer‚Ä¶</p>
</blockquote>
</aside>
<p>The XZ backdoor never affected any stable release of Debian, because Debian doesn‚Äôt introduce new versions of software into older releases. So while the backdoor was not discovered by Debian, Debian did a very good job of defending the vast majority of their users from it even before it was known to be a thing.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="4" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>So if there are no big issues with zstd + debian, i dont see it a bad choice imho.</p>
</blockquote>
</aside>
<p>I believe I pointed out a potential issue when mentioning overly large initramfs files causing boot failures on some machines. Is it a <em>big</em> issue? I guess that depends, but I know from experience that there are systems that, when faced with certain kernel drivers, will fail to boot with an initramfs compressed with a less efficient algorithm, and will succeed booting when that same initramfs is compressed with xz.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-13T12:49:26Z' class='post-time'>
                    July 13, 2025, 12:49pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-13T12:49:26Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I am not worried about xz. What happen to xz can happen to any project. After the xz backdoor has been spotted, there have been a lot eyes on xz. Therefore xz is now one of the projects that has received extensive code review.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-13T13:30:52Z' class='post-time'>
                    July 13, 2025,  1:30pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-13T13:30:52Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I was wondering what should be the priority here. These are the choices that I could identify:</p>
<ul>
<li>A) small size: optimize Kicksecure images for the smallest possible size?</li>
<li>B) fastest initrd creation time: The smallest amount of time spent on initrd creat during upgrades?</li>
<li>C) boot speed?</li>
<li>D) best boot compatibility for low RAM systems?</li>
</ul>
<p>The C) and D) seem more important than A) and B).</p>
<p>This probably means, for a brief moment during decompression, both the compressed image and the uncompressed (expanded) contents may reside in RAM at the same time. On systems with very limited memory, one might have a RAM usage spike and need enough RAM to hold both the compressed image and the fully decompressed contents simultaneously, at least during the extraction phase.</p>
<p>But I don‚Äôt know if that is a realistic consideration as user space might need more memory than this spike.</p>
<p>Keeping the default, uncompressed, also remains an option.</p>
<hr>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://cj.rs/blog/should-i-compress-my-initramfs/">
  <header class="source">
      <img src="../../../external.html?link=https://cj.rs/favicon.ico" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://cj.rs/blog/should-i-compress-my-initramfs/" target="_blank" rel="noopener" title="06:47AM - 31 August 2022">Cl√©ment Joly ‚Äì Open-Source, Rust &amp; SQLite ‚Äì 31 Aug 22</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/219;"><img src="../../../external.html?link=https://cj.rs/blog/should-i-compress-my-initramfs/trade-off.png" class="thumbnail" width="690" height="219"></div>

<h3><a href="../../../external.html?link=https://cj.rs/blog/should-i-compress-my-initramfs/" target="_blank" rel="noopener">Should I Compress My Initramfs?</a></h3>

  <p>When decompressing is faster than reading from the disk.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p><a href="../../../external.html?link=https://www.reddit.com/r/archlinux/comments/ytk6t3/blog_should_i_compress_my_initramfs/" class="onebox" target="_blank" rel="noopener">https://www.reddit.com/r/archlinux/comments/ytk6t3/blog_should_i_compress_my_initramfs/</a></p>
<hr>
<p>Debian:<br>
Quote Debian bug report: <a href="../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=976054">initramfs-tools: [RFC] Compress initramfs file with zstd</a></p>
<blockquote>
<ul>
<li>[742c8ee] Use zstd as default compression for initramfs (Closes: #<a href="../../../external.html?link=https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=976054">976054</a>)</li>
</ul>
</blockquote>
<p>But we‚Äôre not getting this change because we‚Äôre using dracut instead of initramfs-tools.<br>
(<a href="../../../external.html?link=https://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487" class="inline-onebox">replacing initramfs-tools with dracut - Development - Whonix Forum</a>)</p>
<p>related:</p><aside class="onebox discoursetopic" data-onebox-src="../../../external.html?link=https://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/32">
  <header class="source">
      <img src="../../../external.html?link=https://forums.whonix.org/uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/32" target="_blank" rel="noopener" title="06:06PM - 04 January 2024">Whonix Forum ‚Äì 4 Jan 24</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/255;"><img src="../../../external.html?link=https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" class="thumbnail" width="690" height="255"></div>

<div class="title-wrapper">
  <h3><a href="../../../external.html?link=https://forums.whonix.org/t/replacing-initramfs-tools-with-dracut/4487/32" target="_blank" rel="noopener">replacing initramfs-tools with dracut</a></h3>
  <div class="topic-category">
      <span class="badge-wrapper bullet">
        <span class="badge-category-bg" style="background-color: #25AAE2;"></span>
        <span class="badge-category clear-badge">
          <span class="category-name">Development</span>
        </span>
      </span>
    <div class="topic-header-extra">
      <div class="list-tags">
        <div class="discourse-tags">
          <svg class="fa d-icon d-icon-tag svg-icon svg-string"><use href="#tag"></use></svg>
            <span class="discourse-tag simple">milestone_whonix_17</span>
            <span class="discourse-tag simple">status_closed_issue_implemented</span>
        </div>
      </div>
    </div>
  </div>
</div>

  <p>Summary why Kicksecure was ported from initramfs-tools to dracut:  From the initrd generators I was aware of at the time, only dracut has an exitrd feature. Which means the system drops back into the initrd at shutdown time. It then (hopefully)...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<hr>
<p>dracut allegedly according to the following configuration file uses zstd by default. I wonder why ours is uncompressed by default.</p>
<aside class="onebox githubblob" data-onebox-src="../../../external.html?link=https://github.com/coreos/fedora-coreos-config/blob/stable/overlay.d/05core/usr/lib/dracut/dracut.conf.d/60-coreos-zstd.conf">
  <header class="source">

      <a href="../../../external.html?link=https://github.com/coreos/fedora-coreos-config/blob/stable/overlay.d/05core/usr/lib/dracut/dracut.conf.d/60-coreos-zstd.conf" target="_blank" rel="noopener">github.com/coreos/fedora-coreos-config</a>
  </header>

  <article class="onebox-body">
    <h4><a href="../../../external.html?link=https://github.com/coreos/fedora-coreos-config/blob/stable/overlay.d/05core/usr/lib/dracut/dracut.conf.d/60-coreos-zstd.conf" target="_blank" rel="noopener">overlay.d/05core/usr/lib/dracut/dracut.conf.d/60-coreos-zstd.conf</a></h4>

<div class="git-blob-info">
  <a href="../../../external.html?link=https://github.com/coreos/fedora-coreos-config/blob/stable/overlay.d/05core/usr/lib/dracut/dracut.conf.d/60-coreos-zstd.conf" rel="noopener"><code>stable</code></a>
</div>


      <pre><code class="lang-conf"># Compress initrd with zstd.  dracut defaults to -15, but we want the
# maximum reasonable compression, so override the command line to use
# dracut's defaults along with -19.
compress="zstd -19 -q -T0"
</code></pre>




  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-13T14:07:57Z' class='post-time'>
                    July 13, 2025,  2:07pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-13T14:07:57Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Keeping the default, uncompressed, also remains an option.</p>
</blockquote>
</aside>
<p>The default is gzip-compressed, not uncompressed. Dracut will indicate that it is using an automatically detected compression method (‚Äúpigz‚Äù, which is parallel gzip as I understand it) when the compression method is not set. So right now we‚Äôre using gzip compression in all instances.</p>
<aside class="quote no-group" data-username="Patrick" data-post="7" data-topic="1131">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar"> Patrick:</div>
<blockquote>
<p>D) best boot compatibility for low RAM systems?</p>
</blockquote>
</aside>
<p>Systems with multiple tens of gigabytes of RAM can error out with ‚Äúno available memory‚Äù if trying to boot with an initramfs that is too large. The issue is not ‚Äútotal amount of memory‚Äù, the issue is ‚Äútotal amount of contiguous memory that GRUB can see‚Äù (if I‚Äôm understanding correctly), and on some hardware, GRUB can‚Äôt find a very large contiguous block.</p>
<p>xz isn‚Äôt the fastest, but it‚Äôs faster than gzip, and much more efficient size-wise. I didn‚Äôt notice any impact on boot speed, and smaller size provides better compatibility, so that‚Äôs why I think xz strikes a good balance between all four points above. zstd sacrifices size (and therefore possibly compatibility) in favor of speed.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-07-13T16:02:56Z' class='post-time'>
                    July 13, 2025,  4:02pm
                  </time>
                  <meta itemprop='dateModified' content='2025-07-13T16:02:56Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Testing the settings from Fedora CoreOS:</p>
<ul>
<li>zstd with max compression:
<ul>
<li>run 1: <code>0.01s user 0.03s system 0% cpu 18.719 total</code></li>
<li>run 2: <code>0.02s user 0.02s system 0% cpu 17.553 total</code></li>
<li>run 3: <code>0.01s user 0.03s system 0% cpu 17.478 total</code></li>
<li>file size: <code>29628K</code></li>
</ul>
</li>
</ul>
<p>We get a slightly (though only very slightly) larger file than <code>xz</code> would produce, and it takes about 7 seconds longer to produce it than <code>xz</code> or <code>gzip</code> would have taken. <code>xz</code> wins for both size and performance.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
