<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</title>
    <link>https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480</link>
    <description>[details=&quot;Original post&quot;]
I have a Kicksecure 17 VPS initially setup via distromorphing. I just did a test run with this to update other VPS and slowly update all systems to Qubes 4.3, the new Kicksecure and Whonix versions.

The VPS is barely modified whatsoever.

The system is fully up to date according to `sudo apt update`, `systemcheck` doesn’t report anything major, `release-upgrade` is version `3.3` but running `sudo release-upgrade` results in this error:

```
+ old_meta_package=
+ new_meta_package=
+ &#39;[&#39; &#39;&#39; = &#39;&#39; &#39;]&#39;
+ true &#39;ERROR: no installed meta package detected!&#39;

```

However, I do have the old meta package installed and the upgrade guide does not mention installing a different one manually:

```
ii  kicksecure-cli-host                      3:32.3-1                       all          Kicksecure Host command line interface CLI
```

(Shouldn’t have been host probably, but that’s besides the point).

Assuming it was missing in the docs, I just tried installing one of the new meta packages, which says that it’s not found:

```
sudo apt install kicksecure-vm-server
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
E: Unable to locate package kicksecure-vm-server
zsh: exit 100   sudo apt install kicksecure-vm-server
```

Docs: `https://www.kicksecure.com/wiki/Release_Upgrade_17_to_18`

Where is my mistake?
[/details]


Edit: Looking at the full log, it never checks for the old meta package I installed because it detects a VM and I installed the baremetal package back then. What would my options be? Execute the steps the tool does manually? Reinstalling is not an option because of the amount of data on it.

Can I download this file, update the VM check variable and then just run it with sudo and achieve the same result?

`https://raw.githubusercontent.com/Kicksecure/legacy-dist/refs/heads/master/usr/sbin/release-upgrade`

```
+ meta_package_detect
+ &#39;[&#39; &#39;!&#39; &#39;&#39; = &#39;&#39; &#39;]&#39;
+ test -e /usr/share/qubes/marker-vm
+ test -e /usr/share/whonix/marker
+ test -e /usr/share/kicksecure/marker
+ &#39;[&#39; kvm = none &#39;]&#39;
+ old_meta_package=kicksecure-xfce-vm
+ new_meta_package=kicksecure-vm-gui-lxqt
+ meta_package_installed_check
+ pkg_installed kicksecure-xfce-vm
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-xfce-vm
++ dpkg-query --show &#39;--showformat=${Status}&#39; kicksecure-xfce-vm
+ dpkg_query_output=
+ true
++ printf %s &#39;&#39;
++ awk &#39;{print $1}&#39;
+ requested_action=
++ printf %s &#39;&#39;
++ awk &#39;{print $2}&#39;
+ status=
++ printf %s &#39;&#39;
++ awk &#39;{print $3}&#39;
+ error_state=
+ &#39;[&#39; &#39;&#39; = install &#39;]&#39;
+ true &#39;/usr/sbin/release-upgrade: INFO: kicksecure-xfce-vm is not installed, ok.&#39;
+ return 1
+ pkg_installed kicksecure-vm-gui-lxqt
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-vm-gui-lxqt
++ dpkg-query --show &#39;--showformat=${Status}&#39; kicksecure-vm-gui-lxqt
+ dpkg_query_output=
+ true
++ printf %s &#39;&#39;
++ awk &#39;{print $1}&#39;
+ requested_action=
++ printf %s &#39;&#39;
++ awk &#39;{print $2}&#39;
+ status=
++ printf %s &#39;&#39;
++ awk &#39;{print $3}&#39;
+ error_state=
+ &#39;[&#39; &#39;&#39; = install &#39;]&#39;
+ true &#39;/usr/sbin/release-upgrade: INFO: kicksecure-vm-gui-lxqt is not installed, ok.&#39;
+ return 1
+ return 1
+ old_meta_package=kicksecure-cli-vm
+ new_meta_package=kicksecure-vm-cli
+ meta_package_installed_check
+ pkg_installed kicksecure-cli-vm
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-cli-vm
++ dpkg-query --show &#39;--showformat=${Status}&#39; kicksecure-cli-vm
+ dpkg_query_output=
+ true
++ printf %s &#39;&#39;
++ awk &#39;{print $1}&#39;
+ requested_action=
++ printf %s &#39;&#39;
++ awk &#39;{print $2}&#39;
+ status=
++ printf %s &#39;&#39;
++ awk &#39;{print $3}&#39;
+ error_state=
+ &#39;[&#39; &#39;&#39; = install &#39;]&#39;
+ true &#39;/usr/sbin/release-upgrade: INFO: kicksecure-cli-vm is not installed, ok.&#39;
+ return 1
+ pkg_installed kicksecure-vm-cli
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-vm-cli
++ dpkg-query --show &#39;--showformat=${Status}&#39; kicksecure-vm-cli
+ dpkg_query_output=
+ true
++ printf %s &#39;&#39;
++ awk &#39;{print $1}&#39;
+ requested_action=
++ printf %s &#39;&#39;
++ awk &#39;{print $2}&#39;
+ status=
++ printf %s &#39;&#39;
++ awk &#39;{print $3}&#39;
+ error_state=
+ &#39;[&#39; &#39;&#39; = install &#39;]&#39;
+ true &#39;/usr/sbin/release-upgrade: INFO: kicksecure-vm-cli is not installed, ok.&#39;
+ return 1
+ return 1
+ old_meta_package=
+ new_meta_package=
+ &#39;[&#39; &#39;&#39; = &#39;&#39; &#39;]&#39;
+ true &#39;ERROR: no installed meta package detected!&#39;
+ exit 1
zsh: exit 1     sudo release-upgrade
```</description>
    
    <lastBuildDate>Thu, 08 Jan 2026 09:04:50 +0000</lastBuildDate>
    <category>Support</category>
    <atom:link href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480.rss" rel="self" type="application/rss+xml" />
      <item>
        <title>In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="riffi12" data-post="1" data-topic="1480">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/r/e9a140/48.png" class="avatar"> riffi12:</div>
<blockquote>
<p>Can I download this file, update the VM check variable and then just run it with sudo and achieve the same result?</p>
</blockquote>
</aside>
<p>You could probably edit the file on the disk. All that the function call to <code>meta_package_detect</code> does is set two variables:</p>
<ul>
<li><code>old_meta_package</code></li>
<li><code>new_meta_package</code></li>
</ul>
<p>So if you know what you’re doing you could out comment the <code>meta_package_detect</code> function and instead set the values of these variables manually in place where <code>meta_package_detect</code> is now.</p>
<p>You could modify the script or do the same things manually indeed. I would recommend the script has doing that by hand could be more cumbersome and error-prone.</p>
          <p><a href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/4">Read full topic</a></p>
        ]]></description>
        <link>https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/4</link>
        <pubDate>Thu, 08 Jan 2026 09:04:50 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-1480-4</guid>
        <source url="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480.rss">In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</source>
      </item>
      <item>
        <title>In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</title>
        <dc:creator><![CDATA[riffi12]]></dc:creator>
        <description><![CDATA[
            <p>Thanks for the fast reply. I had debugged this and updated the original post with a question on how to proceed if you could give it a quick look <img src="https://forums.kicksecure.com/images/emoji/twitter/slight_smile.png?v=14" title=":slight_smile:" class="emoji" alt=":slight_smile:" loading="lazy" width="20" height="20"></p>
<p>tl;dr: Can I download <code>https://raw.githubusercontent.com/Kicksecure/legacy-dist/refs/heads/master/usr/sbin/release-upgrade</code>, change the check and just run the file?</p>
          <p><a href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/3">Read full topic</a></p>
        ]]></description>
        <link>https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/3</link>
        <pubDate>Thu, 08 Jan 2026 09:03:59 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-1480-3</guid>
        <source url="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480.rss">In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</source>
      </item>
      <item>
        <title>In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</title>
        <dc:creator><![CDATA[Patrick]]></dc:creator>
        <description><![CDATA[
            <aside class="quote no-group" data-username="riffi12" data-post="1" data-topic="1480">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/r/e9a140/48.png" class="avatar"> riffi12:</div>
<blockquote>
<pre><code class="lang-auto">+ '[' kvm = none ']'
</code></pre>
</blockquote>
</aside>
<p>The VPS is KVM based. We don’t consider this a “<code>host</code>”.</p>
<p>This results in condition <code>if [ "${virt_mode}" = 'none' ]; then</code> to evaluate as <code>false</code>. Hence only this code block is applicable:</p>
<pre><code class="lang-auto">         else
            old_meta_package=kicksecure-xfce-vm
            new_meta_package=kicksecure-vm-gui-lxqt
            if meta_package_installed_check ; then return 0 ; fi
            old_meta_package=kicksecure-cli-vm
            new_meta_package=kicksecure-vm-cli
            if meta_package_installed_check ; then return 0 ; fi
         fi
</code></pre>
<p>In plain English, only old meta package <code>kicksecure-xfce-vm</code> or <code>kicksecure-cli-vm</code> would be acceptable.</p>
          <p><a href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/2">Read full topic</a></p>
        ]]></description>
        <link>https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/2</link>
        <pubDate>Thu, 08 Jan 2026 09:01:00 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-1480-2</guid>
        <source url="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480.rss">In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</source>
      </item>
      <item>
        <title>In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</title>
        <dc:creator><![CDATA[riffi12]]></dc:creator>
        <description><![CDATA[
            
Original post <a href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/1">(click for more details)</a>
<p>Edit: Looking at the full log, it never checks for the old meta package I installed because it detects a VM and I installed the baremetal package back then. What would my options be? Execute the steps the tool does manually? Reinstalling is not an option because of the amount of data on it.</p>
<p>Can I download this file, update the VM check variable and then just run it with sudo and achieve the same result?</p>
<p><code>https://raw.githubusercontent.com/Kicksecure/legacy-dist/refs/heads/master/usr/sbin/release-upgrade</code></p>
<pre><code class="lang-auto">+ meta_package_detect
+ '[' '!' '' = '' ']'
+ test -e /usr/share/qubes/marker-vm
+ test -e /usr/share/whonix/marker
+ test -e /usr/share/kicksecure/marker
+ '[' kvm = none ']'
+ old_meta_package=kicksecure-xfce-vm
+ new_meta_package=kicksecure-vm-gui-lxqt
+ meta_package_installed_check
+ pkg_installed kicksecure-xfce-vm
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-xfce-vm
++ dpkg-query --show '--showformat=${Status}' kicksecure-xfce-vm
+ dpkg_query_output=
+ true
++ printf %s ''
++ awk '{print $1}'
+ requested_action=
++ printf %s ''
++ awk '{print $2}'
+ status=
++ printf %s ''
++ awk '{print $3}'
+ error_state=
+ '[' '' = install ']'
+ true '/usr/sbin/release-upgrade: INFO: kicksecure-xfce-vm is not installed, ok.'
+ return 1
+ pkg_installed kicksecure-vm-gui-lxqt
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-vm-gui-lxqt
++ dpkg-query --show '--showformat=${Status}' kicksecure-vm-gui-lxqt
+ dpkg_query_output=
+ true
++ printf %s ''
++ awk '{print $1}'
+ requested_action=
++ printf %s ''
++ awk '{print $2}'
+ status=
++ printf %s ''
++ awk '{print $3}'
+ error_state=
+ '[' '' = install ']'
+ true '/usr/sbin/release-upgrade: INFO: kicksecure-vm-gui-lxqt is not installed, ok.'
+ return 1
+ return 1
+ old_meta_package=kicksecure-cli-vm
+ new_meta_package=kicksecure-vm-cli
+ meta_package_installed_check
+ pkg_installed kicksecure-cli-vm
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-cli-vm
++ dpkg-query --show '--showformat=${Status}' kicksecure-cli-vm
+ dpkg_query_output=
+ true
++ printf %s ''
++ awk '{print $1}'
+ requested_action=
++ printf %s ''
++ awk '{print $2}'
+ status=
++ printf %s ''
++ awk '{print $3}'
+ error_state=
+ '[' '' = install ']'
+ true '/usr/sbin/release-upgrade: INFO: kicksecure-cli-vm is not installed, ok.'
+ return 1
+ pkg_installed kicksecure-vm-cli
+ local package_name dpkg_query_output
+ local requested_action status error_state
+ package_name=kicksecure-vm-cli
++ dpkg-query --show '--showformat=${Status}' kicksecure-vm-cli
+ dpkg_query_output=
+ true
++ printf %s ''
++ awk '{print $1}'
+ requested_action=
++ printf %s ''
++ awk '{print $2}'
+ status=
++ printf %s ''
++ awk '{print $3}'
+ error_state=
+ '[' '' = install ']'
+ true '/usr/sbin/release-upgrade: INFO: kicksecure-vm-cli is not installed, ok.'
+ return 1
+ return 1
+ old_meta_package=
+ new_meta_package=
+ '[' '' = '' ']'
+ true 'ERROR: no installed meta package detected!'
+ exit 1
zsh: exit 1     sudo release-upgrade
</code></pre>
          <p><a href="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/1">Read full topic</a></p>
        ]]></description>
        <link>https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480/1</link>
        <pubDate>Thu, 08 Jan 2026 08:48:59 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-1480-1</guid>
        <source url="https://forums.kicksecure.com/t/in-place-upgrade-of-distromorphed-kicksecure-17-with-wrong-meta-package/1480.rss">In-place upgrade of distromorphed Kicksecure 17 with wrong meta package</source>
      </item>
  </channel>
</rss>
