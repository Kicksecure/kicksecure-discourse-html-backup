<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Ctrl+Alt+Del (three-finger salute) action - Development - Kicksecure Forums</title>
    <meta name="description" content="Ctrl+Alt+Del (sometimes called the “three-finger salute”): 
On Windows, the three-finger does something useful. Noways, shows a menu: 

Lock
Switch user
Sign out
Change a password
Task manager
Cancel

On Qubes, simply ac&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.7 - https://github.com/discourse/discourse version 3baf4000904c0d11731b97364df756b00d3457ee">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1197.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c162268923430.css_%3b%20filename_%3dUTF-8%27%27color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c1622689234306?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="../../stylesheets/desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="../../stylesheets/checklist_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27checklist_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="../../stylesheets/discourse-details_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-details_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="../../stylesheets/discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="../../stylesheets/discourse-local-dates_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="../../stylesheets/discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab261cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="../../stylesheets/discourse-presence_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="../../stylesheets/docker_manager_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27docker_manager_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="../../stylesheets/footnote_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27footnote_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="../../stylesheets/poll_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
  <link href="../../stylesheets/poll_desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c8.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c861cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a92.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a9261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="header"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>



<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Ctrl+Alt+Del (three-finger salute) action&#39;" href="1197.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/ctrl-alt-del-three-finger-salute-action/1197" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/ctrl-alt-del-three-finger-salute-action/1197" />
<meta property="og:title" content="Ctrl+Alt+Del (three-finger salute) action" />
<meta name="twitter:title" content="Ctrl+Alt+Del (three-finger salute) action" />
<meta property="og:description" content="Ctrl+Alt+Del (sometimes called the “three-finger salute”):  On Windows, the three-finger does something useful. Noways, shows a menu:   Lock Switch user Sign out Change a password Task manager Cancel  On Qubes, simply activates the screen lock.  On Kicksecure, we could also provide similar options such as:   Task manager Lock Regular shutdown Emergency shutdown" />
<meta name="twitter:description" content="Ctrl+Alt+Del (sometimes called the “three-finger salute”):  On Windows, the three-finger does something useful. Noways, shows a menu:   Lock Switch user Sign out Change a password Task manager Cancel  On Qubes, simply activates the screen lock.  On Kicksecure, we could also provide similar options such as:   Task manager Lock Regular shutdown Emergency shutdown" />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:tag" content="status_open_issue_todo" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins 🕑" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="6 ❤" />
<meta property="article:published_time" content="2025-08-05T08:57:51+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>
<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">
    Kicksecure Forums
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1197.html">Ctrl+Alt+Del (three-finger salute) action</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Ctrl+Alt+Del (three-finger salute) action'>
      <link itemprop='url' href='1197.html'>
      <meta itemprop='datePublished' content='2025-08-05T08:57:51Z'>
        <meta itemprop='articleSection' content='Development'>
      <meta itemprop='keywords' content='status_open_issue_todo'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="1197.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-08-05T08:57:51Z' class='post-time'>
                    August 5, 2025,  8:57am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-05T08:57:51Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><strong>Ctrl+Alt+Del</strong> (sometimes called the “<a href="../../../external.html?link=https://en.wikipedia.org/wiki/Control-Alt-Delete">three-finger salute</a>”):</p>
<p>On Windows, the three-finger does something useful. Noways, shows a menu:</p>
<ul>
<li>Lock</li>
<li>Switch user</li>
<li>Sign out</li>
<li>Change a password</li>
<li>Task manager</li>
<li>Cancel</li>
</ul>
<p>On Qubes, simply activates the screen lock.</p>
<p>On Kicksecure, we could also provide similar options such as:</p>
<ul>
<li>Task manager</li>
<li>Lock</li>
<li>Regular shutdown</li>
<li>Emergency shutdown</li>
</ul>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

                <div class='crawler-linkback-list' itemscope itemtype='../../../external.html?link=http://schema.org/ItemList'>
                      <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                        <a itemprop='url' href="../unplugging-external-drive-should-trigger-a-shutdown/994/21.html">Unplugging external drive should trigger a shutdown</a>
                        <meta itemprop='position' content='2'>
                      </div>
                      <div itemprop='itemListElement' itemscope itemtype='../../../external.html?link=http://schema.org/ListItem'>
                        <a itemprop='url' href="../emergency-key-press-shutdown-sequence/1199.html">Emergency key press shutdown sequence</a>
                        <meta itemprop='position' content='3'>
                      </div>
                </div>
          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/init38'><span itemprop='name'>init38</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-05T16:23:28Z' class='post-time'>
                    August 5, 2025,  4:23pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-05T16:23:28Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Please see my thread 1147 about this.</p>
<p>My question is what route should be the go to?</p>
<p>Set a local shortcuts config for user and sysmaint? Downside would be these keyboard shortcuts would not populate if user uses sysmaint to create more users. Unless there is something specific to xfce4’s xconf for globally setting shortcuts it seems like the only route is dconf?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-05T16:36:14Z' class='post-time'>
                    August 5, 2025,  4:36pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-05T16:36:14Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>My idea was to use the existing emerg-shutdown framework (which monitors for a “panic” key combo already) to also act as the Ctrl+Alt+Delete handler. That would make it work anywhere in the system, and could also (if handled carefully) prevent malware running as a local user from being able to interfere with the key handler and associated features.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/init38'><span itemprop='name'>init38</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-05T16:39:55Z' class='post-time'>
                    August 5, 2025,  4:39pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-05T16:39:55Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>What about other default shortcuts like <em>super key</em> for whisker menu for easy searching for applications like “windows task bar”. Many distros already set super key for application menu like Ubuntu and Mint.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-06T07:27:44Z' class='post-time'>
                    August 6, 2025,  7:27am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-06T07:27:44Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="init38" data-post="2" data-topic="1197">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/i/c6cbf5/48.png" class="avatar"> init38:</div>
<blockquote>
<p>Please see my thread 1147 about this.</p>
</blockquote>
</aside>
<p>These cannot be referenced by number. Difficult to find. I had to click on your profile and check all created forum threads.</p>
<p>This:<br>
<a href="../kicksecure-distro-specific-keyboard-shortcuts/1147.html" class="inline-onebox">Kicksecure distro specific keyboard shortcuts</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-07T02:48:00Z' class='post-time'>
                    August 7, 2025,  2:48am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-07T04:04:04Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Had a conversation about how this could work with Patrick, this is my current set of ideas/plans after that conversation.</p>
<p>We have the <code>emerg-shutdown</code> background process now, which among other things monitors all keystrokes on the system by grabbing the /dev/input/event* devices on startup. This is done so that if the user presses a panic key combination (user configurable, the default is yet to be determined, see <a href="../emergency-key-press-shutdown-sequence/1199.html" class="inline-onebox">Emergency key press shutdown sequence</a>), the system can be immediately and forcibly shut down, without any possibility of malicious interference or accidental overriding. That same mechanism could be used in theory to listen for any key combination though, allowing us to define keyboard shortcuts that talk to a privileged component of the system (similar to the Secure Attention Key in other operating systems). Another advantage of this is that it’s not possible for malware to access this interface unless it is running as root, because emulated input mechanisms allow communicating with the display server, not the kernel’s evdev driver. Injecting key events into the kernel’s evdev subsystem requires using uinput, which requires root privileges to access, thus unprivileged malware can’t send keystroke combinations in order to trigger whatever privileged actions are configured here.</p>
<p>Since shortcuts configured in emerg-shutdown require either root privileges or physical access to the machine to trigger, this makes it seem like the perfect place to implement a Ctrl+Alt+Delete handler. The question then becomes, what should this handler do?</p>
<p>There are two possible directions we could take this. One is the simple route - register the salute in emerg-shutdown, and send a DBus message to whatever user session is on an active TTY in response. Those messages would then instruct an agent running as the user to do something like start a task manager or lock the screen. This would be useful, but it would only be marginally better than just defining a keyboard shortcut in the user session. It wouldn’t allow the user to kill applications that are running as root or as a different user (something they may have a legitimate reason to do even in a user session), and it wouldn’t prevent anything “going wrong” in the user session (a malicious or runaway process, for instance) from being able to interfere with the salute’s functionality in some way.</p>
<p>The other, more complex route, would be to switch to an “emergency session” of sorts, moving the user to an unused TTY and launching a graphical session in that TTY where they can do things as root or another privileged user. This is far more powerful, <em>and</em> possibly far more secure if done right.</p>
<p>The more complex solution is unsafe under X11 because of the world-writable UNIX sockets created by X11, exposing attack surface that could result in exploitable escalation of privilege vulnerabilities. Under Wayland however, the display server’s socket is generally under /run/user/UID, which has strict permissions to prevent access by other users, so as long as the kernel’s permission subsystem holds up, this shouldn’t be an issue. We can thus run a separate Wayland server as a privileged user (such as <code>sysmaint</code>) alongside an unprivileged and untrusted user session, without as much fear of vulnerabilities. (If running a full Wayland server sounds like too much risk, we could also use a raw framebuffer. Qt supports rendering directly to a framebuffer, it’s very slow at least under a virtual machine, but it works. I think this is overkill though, and it will also make it hard to work with multiple programs at once, which would almost certainly be desirable.)</p>
<p>One danger of an emergency UI such as this is that it’s not impossible for a malicious application to prevent the user from escaping to the emergency session. The emergency session would simply run in a TTY (since that’s the only feature Linux has for this sort of thing), and it would be fairly trivial for malware running as a user in a graphical session to simply force the user back to the original TTY, using a console file descriptor. (One can switch the active TTY to any other TTY if they have write access to any one TTY. In other words, if the user is logged in graphically and thus /dev/tty7 is writable by them, malware running as that user can open /dev/tty7 and then switch the user to any desired TTY.) To prevent this, one solution would be to SIGSTOP potentially malicious processes, specifically those which run as a logged-in user. This cannot be done to every process in the system though, since:</p>
<ul>
<li>PID 1 cannot be SIGSTOP’d (I tried, the signal was silently ignored)</li>
<li>A SIGSTOP’d program can be SIGKILL’d without receiving a SIGCONT first</li>
<li>systemd’s watchdog mechanism can and probably will restart a service that is SIGSTOP’d as a result</li>
</ul>
<p>However, “freezing” all logged-in user accounts should still be feasible in theory. This would prevent any running malware from doing anything while the user is in the emergency session, thus it would be unable to force the user to a different TTY. Any malware on the system that wasn’t running as a logged-in user would have to be running as root or be able to elevate its privileges to that of a logged-in user in order to gain access to a console and thus change TTYs.</p>
<p>One thing that is still uncertain about SIGSTOP is how it behaves when dealing with stuck kernel threads. If a thread calls into the kernel and then gets stuck there (such as can happen when dealing with flaky I/O devices), it cannot be SIGKILL’d or SIGSTOP’d. What’s unclear is whether the process’s <em>other</em> threads can be SIGKILL’d or SIGSTOP’d in this situation. If the answer is “yes”, then using SIGSTOP should be an effective freezing mechanism, but if the answer is “no”, then malware may be able to circumvent a SIGSTOP by launching a thread that then does something to get stuck in the kernel. Getting a thread stuck in kernel mode is hard though (I believe it should be impossible without either buggy hardware, a buggy kernel, or root access, <s>and even with root access you’d have to do something convoluted like set up a VM with an NFS share, mount the NFS share on the host, kill the VM abruptly, and then attempt I/O on the mounted share</s> edit: just tried something like this, even this doesn’t result in a stuck kernel thread, <a href="../../../external.html?link=https://chrisdown.name/2024/02/05/reliably-creating-d-state-processes-on-demand.html" class="inline-onebox" rel="noopener nofollow ugc">Creating controllable D state (uninterruptible sleep) processes</a> has better instructions for getting a process stuck in a kernel thread), so this might not be an issue.</p>
<p>Another difficulty is that we most likely are not going to go through a display manager., As a result, the “session” we will end up in will be rather limited and things that one might expect to work (like systemd user units, DBus, some xdg-related things, etc.) probably won’t work. Thus the functionality within the emergency session will need to be limited to cope with this. (This will also prevent us from simply switching to a sysmaint session when the salute is registered - the sysmaint session has features that depend on a full login session running. It most likely will not behave itself well if it doesn’t have all of the infrastructure usually set up by a display manager working right. We also can’t just switch to the sysmaint session because some of the features of the sysmaint session, like software updates, are not things that can be safely done when booted into a user session. Even if they work now, they won’t work once we implement Verified Boot.)</p>
<p>Obviously, some form of authorization will be needed in order to access the features of this emergency session. Otherwise any attacker with physical access to the system could use this to take the system over entirely. It shouldn’t be too difficult to implement an authorization prompt of some sort to make this work. Because of the need for authorization, the graphical session MUST NOT run as root, since then any arbitrary code execution vulnerability in a used graphical toolkit or Wayland compositor could allow an attacker with physical access to gain unauthorized root access. The sysmaint account would be ideal to use instead, since then if the user has set a password, they will have to provide it in order to run any privileged operations.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-07T03:31:30Z' class='post-time'>
                    August 7, 2025,  3:31am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-07T03:31:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>On the topic of a secure attention key, someone in 2016 posted a really nice overview of attack scenarios where a SAK is very useful: <a href="../../../external.html?link=https://arstechnica.com/civis/threads/sak-sas-secure-attention-key-sequence-on-linux.1325235/#post-31739583" class="inline-onebox" rel="noopener nofollow ugc">SAK/SAS - Secure attention key sequence on Linux | Ars OpenForum</a> Quoting the post:</p>
<blockquote>
<p>It’s not about a machine we don’t trust; that’s a separate but valid concern. It’s about a computer that multiple people have access to, e.g. libraries, computer labs, workplaces. Many people may be allowed on that machine, but each having their own accounts and passwords.</p>
<p>Attack type number 1:<br>
Attacker logs into his account and starts up a full-screen program that looks and acts identical to the login screen. (Program designed to collect the username/password data and store it or send it somewhere, then shows a fictitious error screen or simply logs out or reboots or hangs so that someone forces a restart.)<br>
Victim finds an apparently unused workstation. Logs in. Game over.</p>
<p>Attack type number 2:<br>
Victim logs in, starts up some programs, opens some files, then locks the screen and goes for a coffee break.<br>
Attacker hard-resets the machine, logs in and runs a similar program that looks/behaves like the screenlocker instead.<br>
Victim returns and attempts to unlock the screen. Game over.</p>
<p>Attack type number 3:<br>
Victim forgets to lock screen on going to the john. (When you gotta go…)<br>
Attacker runs fake screenlocker on the Victim’s own acct.<br>
Victim returns and either forgot that he didn’t lock it or figures it timed out from inactivity. Unlocks screen. Game over. (program simply terminates itself putting him back at his desktop after having sent the password over the internet and deleting its tracks)<br>
Some compromise existed already, since Victim failed to lock, but this attack provides stealthy expansion of that gap, allowing future log on, not just a one time access, and also gives you any sudo privileges the account has.</p>
<p>Having a SAK that users are trained to ALWAYS enter before passwords eliminates the risk.</p>
</blockquote>
<p>One of the features Windows has bound to the three finger salute is triggering the lock screen or login screen to function (the screen displays even before that, but the SAK signals it to prompt for the password), which conveniently solves all of these issues. To implement something like this on Linux, we could probably do something like this:</p>
<ul>
<li>The screen locker itself doesn’t accept a password, it simply listens for a privileged process to give it an “unlock the screen” signal and unlocks the screen upon receipt of that signal.</li>
<li>Pressing Ctrl+Alt+Del causes emerg-shutdown (which probably needs renamed at this point) to freeze all user accounts on the system, send the user to an unused TTY, and display a greetd+wlgreet window. The user can then log in with their user name and password.</li>
<li>The script that runs on login signals emerg-shutdown to unfreeze the system, then looks to see if the user is already logged in (and if so, on which TTY). If the user is already logged in, the script instructs emerg-shutdown to unlock that user’s TTY, then it switches to that user’s TTY and is done. If the user is not already logged in, a new login is created.</li>
</ul>
<p>This mitigates all three attack scenarios. As for how to implement this and the emergency session at the same time, we just need emerg-shutdown to be able to tell whether or not the active TTY is locked (this can be done most likely with the help of the custom screen locker). If the TTY is locked, the salute will trigger a login/unlock action like described above, otherwise it will trigger an emergency session like described earlier.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-07T04:26:31Z' class='post-time'>
                    August 7, 2025,  4:26am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-07T04:26:31Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Based on some quick testing using the fsfreeze technique described in an earlier shared link, it looks like it is <em>not</em> possible to immunize a process to SIGKILL or SIGSTOP by using a stuck thread.</p>
<pre><code class="lang-auto"># Set up
mkdir stickyfs
fallocate -l 8M sticky.img
mkfs.ext4 sticky.img
sudo mount sticky.img stickyfs
sudo chmod 777 stickyfs

# Write a simple multithreaded C program that will get one thread stuck
cat &lt;&lt;EOF &gt; test.c
#include &lt;pthread.h&gt;
#include &lt;stdio.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;unistd.h&gt;
#include &lt;string.h&gt;
#include &lt;errno.h&gt;

void *sticky_func(void *arg) {
  const char *stuckstr = "I'm stuck, help!\n";
  int stuckfd = open("stickyfs/sticky.txt", O_RDWR | O_CREAT);
  write(stuckfd, stuckstr, strlen(stuckstr));
}

int main() {
  pthread_t sticky;
  pthread_create(&amp;sticky, NULL, sticky_func, NULL);
  int i = 0;
  while (1) {
    printf("%d\n", i++);
  }
}
EOF

gcc test.c

# Lock the stickyfs filesystem
sudo fsfreeze -f stickyfs

# Run the newly created application
./a.out

# Numbers will scroll down the screen indicating that the process is doing something. Open another terminal to do other work in.

# Look at the contents of stickyfs, verify sticky.txt does not exist there
ls stickyfs

# Find the PID of the sticky process
pgrep a.out

# SIGSTOP it
kill -s SIGSTOP PID

# Observe the numbers stop scrolling down the screen
# Resume the process
kill -s SIGCONT PID

# Observe the numbers start scrolling again
# Kill the process with SIGKILL
kill -s SIGKILL PID

# Observe the numbers stop scroling, but the process does not fully exit, confirming that it is stuck in a kernel thread
# Unfreeze the stickyfs dir
sudo fsfreeze -u stickyfs

# Observe the process exits now
</code></pre>
<p>So it looks like SIGSTOP is usable here. Even though the stuck thread isn’t responding to the signals, the unstuck threads that could actually be dangerous are still affected by those signals.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-07T09:13:27Z' class='post-time'>
                    August 7, 2025,  9:13am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-07T09:13:27Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="arraybolt3" data-post="6" data-topic="1197">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>it would be fairly trivial for malware running as a user in a graphical session to simply force the user back to the original TTY, using a console file descriptor.</p>
</blockquote>
</aside>
<p>Sure? This contradicts what we’re currently writing in chapter <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/Strong_Linux_User_Account_Isolation#Console_Login_Attacks">Console Login Attacks</a>.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="6" data-topic="1197">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>SIGSTOP</p>
</blockquote>
</aside>
<p>Another advantage of this might be that misbehaving processes (such as clogging up all CPU due to a bug) would stop doing that so the user has system resources available to investigate this and to terminate misbehaving processes.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-08T00:13:36Z' class='post-time'>
                    August 8, 2025, 12:13am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-08T00:13:36Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Patrick" data-post="9" data-topic="1197">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar"> Patrick:</div>
<blockquote>
<p>Sure? This contradicts what we’re currently writing in chapter <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/Strong_Linux_User_Account_Isolation#Console_Login_Attacks" rel="noopener nofollow ugc">Console Login Attacks</a>.</p>
</blockquote>
</aside>
<p>I don’t believe so. That documentation explicitly warns that one way to be able to switch virtual terminals is to:</p>
<blockquote>
<p>…be running under a user account that has logged in at a virtual terminal already. In this … instance, software running as the logged-in user could <em>switch</em> to a different virtual terminal, but it would not be able to attempt to login at that terminal. That would require read/write access to the virtual terminal that was switched to. Virtual terminals that have a login prompt are only able to be read from and written to by root or a person with physical access to the machine.</p>
</blockquote>
<p>The reason this is a problem in the context of a SAK is that even if we switch to a TTY presenting an authentic login screen, malware could immediately switch us back to the TTY it was on a second ago and display a fake login screen. It’s not a danger when it comes to logging into other accounts, it is a problem when it comes to stealing user data.</p>
<p>(Worthy of note, once we switch to Wayland, the compositor will almost certainly run as a user other than root, and thus the TTY it runs on will have its permissions set to a non-root user. Thus this issue will start affecting graphical sessions as well, not just text-only VT logins. I think though that’s a small price to pay, especially since there’s a mitigation.)</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
