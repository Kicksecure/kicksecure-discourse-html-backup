<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Systemd Service Hardening? - Support - Kicksecure Forums</title>
    <meta name="description" content="So I was learning about the options for Systemd services for restricting or in another word ‚Äúhardening‚Äù services. 
This made me question does Kicksecure deploy certain hardening for it‚Äôs services or certain Kicksecure sp&amp;hellip;">
    <meta name="generator" content="Discourse 3.5.0 - https://github.com/discourse/discourse version 333e8d4ba24f41e936bdd269db0de9f3d97f2a1a">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1258.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_light-default__3_fb854acdcf477923a12fdb1f601030cfa9e5da09.css_%3b%20filename_%3dUTF-8%27%27color_definitions_light-default__3_fb854acdcf477923a12fdb1?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

<link href="../../stylesheets/common_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27common_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common"  />

  <link href="../../stylesheets/desktop_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27desktop_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



    <link href="../../stylesheets/checklist_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27checklist_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
    <link href="../../stylesheets/discourse-details_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-details_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
    <link href="../../stylesheets/discourse-lazy-videos_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
    <link href="../../stylesheets/discourse-local-dates_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
    <link href="../../stylesheets/discourse-narrative-bot_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
    <link href="../../stylesheets/discourse-presence_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
    <link href="../../stylesheets/discourse-solved_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-solved_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-solved"  />
    <link href="../../stylesheets/discourse-templates_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-templates_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-templates"  />
    <link href="../../stylesheets/discourse-topic-voting_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.cs?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-topic-voting"  />
    <link href="../../stylesheets/docker_manager_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27docker_manager_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
    <link href="../../stylesheets/footnote_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27footnote_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
    <link href="../../stylesheets/poll_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27poll_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
    <link href="../../stylesheets/discourse-topic-voting_desktop_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27discourse-topic-voting_desktop_ce524da57f53d0309efd2c1e19ae7b6?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-topic-voting_desktop"  />
    <link href="../../stylesheets/poll_desktop_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_ce524da57f53d0309efd2c1e19ae7b611c3f0e1b61cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/common_theme_3_b2a4a680f0a907ef65266f946123147e6cbac974.css_%3b%20filename_%3dUTF-8%27%27common_theme_3_b2a4a680f0a907ef65266f946123147e6cbac97461cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/common_theme_2_75895eee7907b4b657e41425ff53fcebf292fbc9.css_%3b%20filename_%3dUTF-8%27%27common_theme_2_75895eee7907b4b657e41425ff53fcebf292fbc961cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="common_theme" data-theme-id="2" data-theme-name="header"/>
    <link href="../../stylesheets/desktop_theme_3_2a5300d65f708f9eff8114c0a8acb8681a6bbf03.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_2a5300d65f708f9eff8114c0a8acb8681a6bbf0361cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>

<script defer="" src="../../theme-javascripts/6bb970c15b81e0b2379f3512812ba45e05a9b972.js_%3b%20filename_%3dUTF-8%27%276bb970c15b81e0b2379f3512812ba45e05a9b97261cf.js?__ws=forums.kicksecure.com" data-theme-id="2" nonce="tbfEL2mn38ogIEUYX1FKtblJM"></script>

<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Systemd Service Hardening?&#39;" href="1258.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/systemd-service-hardening/1258" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/systemd-service-hardening/1258" />
<meta property="og:title" content="Systemd Service Hardening?" />
<meta name="twitter:title" content="Systemd Service Hardening?" />
<meta property="og:description" content="So I was learning about the options for Systemd services for restricting or in another word ‚Äúhardening‚Äù services.  This made me question does Kicksecure deploy certain hardening for it‚Äôs services or certain Kicksecure specific services?  These are some interesting options I will note here:  PrivateNetwork=yes/no  Gives the service its own network namespace. It can‚Äôt see or use the host‚Äôs network interfaces unless you explicitly bind sockets. Seems useful to prevent leaks or prevent services from..." />
<meta name="twitter:description" content="So I was learning about the options for Systemd services for restricting or in another word ‚Äúhardening‚Äù services.  This made me question does Kicksecure deploy certain hardening for it‚Äôs services or certain Kicksecure specific services?  These are some interesting options I will note here:  PrivateNetwork=yes/no  Gives the service its own network namespace. It can‚Äôt see or use the host‚Äôs network interfaces unless you explicitly bind sockets. Seems useful to prevent leaks or prevent services from..." />
<meta property="og:article:section" content="Support" />
<meta property="og:article:section:color" content="0088CC" />
<meta property="og:article:tag" content="status_open_issue_todo" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="2 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="11 ‚ù§" />
<meta property="article:published_time" content="2025-08-26T01:47:58+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>

<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">Kicksecure Forums</a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1258.html">Systemd Service Hardening?</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/support/6.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0088CC'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Systemd Service Hardening?'>
      <link itemprop='url' href='1258.html'>
      <meta itemprop='datePublished' content='2025-08-26T01:47:58Z'>
        <meta itemprop='articleSection' content='Support'>
      <meta itemprop='keywords' content='status_open_issue_todo'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/goose4'><span itemprop='name'>goose4</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="1258.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-08-26T01:47:58Z' class='post-time'>
                    August 26, 2025,  1:47am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T18:49:09Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>So I was learning about the options for Systemd services for restricting or in another word ‚Äúhardening‚Äù services.</p>
<p>This made me question does Kicksecure deploy certain hardening for it‚Äôs services or certain Kicksecure specific services?</p>
<p>These are some interesting options I will note here:</p>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivateNetwork=" rel="noopener nofollow ugc"><code>PrivateNetwork=yes/no</code></a><br>
Gives the service its own network namespace. It can‚Äôt see or use the host‚Äôs network interfaces unless you explicitly bind sockets. Seems useful to prevent leaks or prevent services from being ran without networking?</p>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivatePIDs=" rel="noopener nofollow ugc"><code>PrivatePIDs=yes/no</code></a><br>
Gives a service an isolated view of the process table, which is a useful ‚Äúdefense in depth‚Äù measure, especially for daemons that don‚Äôt need to inspect or manage other system processes.</p>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivateTmp=" rel="noopener nofollow ugc"><code>PrivateTmp=yes/no</code></a><br>
Provides a private /tmp and /var/tmp for the service, isolating it from the host‚Äôs temporary directories. One service can‚Äôt read temporary files left by another service, which mitigates attacks that rely on guessing or stealing temp‚Äëfile names.</p>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#MemoryDenyWriteExecute=" rel="noopener nofollow ugc"><code>MemoryDenyWriteExecute=yes/no</code></a><br>
Remounts parts of the filesystem read‚Äëonly (or makes the whole tree read‚Äëonly) for the service. (helps mitigate code‚Äëinjection attacks).</p>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#ProtectSystem=" rel="noopener nofollow ugc"><code>ProtectSystem=full/strict/yes</code></a><br>
Remounts parts of the filesystem read‚Äëonly (or makes the whole tree read‚Äëonly) for the service.</p>
<p>There is many others but these few caught my eye.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-26T02:21:16Z' class='post-time'>
                    August 26, 2025,  2:21am
                  </time>
                  <meta itemprop='dateModified' content='2025-08-26T02:21:16Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I don‚Äôt think we harden specific ‚Äúthird-party‚Äù services yet, but we definitely use these kinds of things for applicable services in Kicksecure and Whonix. See <a href="../../../external.html?link=https://github.com/Kicksecure/sdwdate/blob/master/usr/lib/systemd/system/sdwdate.service" class="inline-onebox" rel="noopener nofollow ugc">sdwdate/usr/lib/systemd/system/sdwdate.service at master ¬∑ Kicksecure/sdwdate ¬∑ GitHub</a> for instance, there‚Äôs a whole battery of hardening options enabled here, including a syscall filter.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="4" />
              <span class='post-likes'>4 Likes</span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Quiksilver'><span itemprop='name'>Quiksilver</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-27T18:12:18Z' class='post-time'>
                    August 27, 2025,  6:12pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T18:12:18Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3">@arraybolt3</a><br>
On the USBGuard thread you mentioned CUPS, does systemd support a drop in file? it looks like documentation states it does?</p>
<blockquote>
<p>Along with a unit file foo.service, a ‚Äúdrop-in‚Äù directory foo.service.d/ may exist. All files with the suffix ‚Äú.conf‚Äù from this directory will be merged in the alphanumeric order and parsed after the main unit file itself has been parsed. This is useful to alter or add configuration settings for a unit, without having to modify unit files. Each drop-in file must contain appropriate section headers. For instantiated units, this logic will first look for the instance ‚Äú.d/‚Äù subdirectory (e.g. ‚Äúfoo@bar.service.d/‚Äù) and read its ‚Äú.conf‚Äù files, followed by the template ‚Äú.d/‚Äù subdirectory (e.g. ‚Äúfoo@.service.d/‚Äù) and the ‚Äú.conf‚Äù files there. Moreover, for unit names containing dashes (‚Äú-‚Äù), the set of directories generated by repeatedly truncating the unit name after all dashes is searched too. Specifically, for a unit name foo-bar-baz.service not only the regular drop-in directory foo-bar-baz.service.d/ is searched but also both foo-bar-.service.d/ and foo-.service.d/. This is useful for defining common drop-ins for a set of related units, whose names begin with a common prefix. This scheme is particularly useful for mount, automount and slice units, whose systematic naming structure is built around dashes as component separators. Note that equally named drop-in files further down the prefix hierarchy override those further up, i.e. foo-bar-.service.d/10-override.conf overrides foo-.service.d/10-override.conf.</p>
</blockquote>
<blockquote>
<p><a href="../../../external.html?link=https://www.freedesktop.org/software/systemd/man/latest/systemd.unit.html" class="inline-onebox" rel="noopener nofollow ugc">systemd.unit</a></p>
</blockquote>
<p>Couldn‚Äôt we create a CUPS drop in <code>/etc/systemd/system/cups.service.d/hardening.conf</code> that would apply some hardened options that would essentially mitigate:</p>
<blockquote>
<p>WAN / public internet: a remote attacker sends an UDP packet to port 631. No authentication whatsoever.<br>
LAN: a local attacker can spoof zeroconf / mDNS / DNS-SD advertisements (we will talk more about this in the next writeup Ô£ø) and achieve the same code path leading to RCE.</p>
</blockquote>
<p>I don‚Äôt think the package manager would ever touch it either with upgrades to CUPS?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Quiksilver'><span itemprop='name'>Quiksilver</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-27T18:13:47Z' class='post-time'>
                    August 27, 2025,  6:13pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T18:13:47Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks for sharing this info I was not aware of this. <code>PrivateNetwork=yes/no</code> looks like a good option for CUPS and others we don‚Äôt need network access.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-27T18:46:01Z' class='post-time'>
                    August 27, 2025,  6:46pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T18:46:01Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Yes, systemd configuration snippet drop-in support is amazing.</p>
<p>(As a distribution we should use folder <code>/usr/lib/systemd/system</code> rather than <code>/etc</code>.)</p>
<p>Any systemd hardening options:</p>
<ol>
<li>Please try to submit them upstream. (Such as to cups.) If that does not work,</li>
<li>Submit them to Debian.</li>
<li>Only then consider submitting these to Kicksecure.</li>
</ol>
<p>This is for the purpose of maintainability.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/maintainability">
  <header class="source">
      <img src="../../../external.html?link=https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1756287028" class="site-icon" alt="" width="151" height="151">

      <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/maintainability" target="_blank" rel="noopener" title="01:34PM - 25 August 2025">Kicksecure ‚Äì 25 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/387;"><img src="../../../external.html?link=https://www.kicksecure.com/w/images/5/51/Kicksecure-image-twitter-post.jpg?version=30a0ad75271a4836786771c345c960b8" class="thumbnail" alt="" width="690" height="388"></div>

<h3><a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/maintainability" target="_blank" rel="noopener">Maintainability</a></h3>

  <p>Exploring the challenges of maintainability in the Kicksecure project and Open Source development.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>See also:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream">
  <header class="source">
      <img src="../../../external.html?link=https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1756287028" class="site-icon" alt="" width="151" height="151">

      <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream" target="_blank" rel="noopener" title="02:18PM - 07 August 2025">Kicksecure ‚Äì 7 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/387;"><img src="../../../external.html?link=https://www.kicksecure.com/w/images/5/51/Kicksecure-image-twitter-post.jpg?version=30a0ad75271a4836786771c345c960b8" class="thumbnail" alt="" width="690" height="388"></div>

<h3><a href="../../../external.html?link=https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream" target="_blank" rel="noopener">Relationship With Upstream</a></h3>

  <p>Kicksecure Relationship with Upstream Projects.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>This is not on our immediate roadmap: <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Security_Roadmap" class="inline-onebox">Kicksecure Security Roadmap</a></p>
<p>But anyone feel free to work on this.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Quiksilver'><span itemprop='name'>Quiksilver</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-27T20:34:37Z' class='post-time'>
                    August 27, 2025,  8:34pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T20:34:37Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Honestly I really doubt upstream or Debian would add anything that disables network and LAN printing such as:</p>
<pre><code class="lang-auto">CapabilityBoundingSet=CAP_NET_BIND_SERVICE
PrivateNetwork=yes
</code></pre>
<p>However they might be accepting to <code>NoNewPrivileges=yes</code> and others.</p>
<p>People do indeed use network printing or LAN printing (I don‚Äôt do either personally) but maybe a new thread regarding CUPS should be made like ‚Äúshould CUPS even come disabled by default‚Äù or the ideas mentioned here.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-08-27T20:47:30Z' class='post-time'>
                    August 27, 2025,  8:47pm
                  </time>
                  <meta itemprop='dateModified' content='2025-08-27T20:47:30Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>FWIW, CUPS doesn‚Äôt even appear to be installed on Kicksecure 17 by default, unless I accidentally uninstalled it in my development VM during other work:</p>
<pre><code class="lang-auto">[sysmaint ~]% apt list --installed | grep cups

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

libcups2/oldstable,oldstable-security,now 2.4.2-3+deb12u8 amd64 [installed,automatic]
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/goose4'><span itemprop='name'>goose4</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-09-15T20:21:01Z' class='post-time'>
                    September 15, 2025,  8:21pm
                  </time>
                  <meta itemprop='dateModified' content='2025-09-15T20:21:01Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Thanks for pointing that out</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/goose4'><span itemprop='name'>goose4</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-09-15T20:27:19Z' class='post-time'>
                    September 15, 2025,  8:27pm
                  </time>
                  <meta itemprop='dateModified' content='2025-09-15T20:27:19Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Patrick" data-post="5" data-topic="1258">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar"> Patrick:</div>
<blockquote>
<p>/usr/lib/systemd/system</p>
</blockquote>
</aside>
<p>I was not even thinking about CUPS cause I even have a printer nor print anything. Might be something to look into <img src="../../images/emoji/twitter/%2b1ae24.png?v=14" title=":+1:" class="emoji" alt=":+1:" loading="lazy" width="20" height="20"></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/goose4'><span itemprop='name'>goose4</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-09-15T20:34:05Z' class='post-time'>
                    September 15, 2025,  8:34pm
                  </time>
                  <meta itemprop='dateModified' content='2025-09-15T20:34:05Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Quiksilver" data-post="3" data-topic="1258">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Couldn‚Äôt we create a CUPS drop in <code>/etc/systemd/system/cups.service.d/hardening.conf</code> that would apply some hardened options that would essentially mitigate:</p>
</blockquote>
</aside>
<p>As Patrick mentioned <code>/usr/lib/systemd/system</code> is better for distribution to ship.</p>
<p>Heres an idea here that looks like it would mitigate that</p>
<blockquote>
<p>By default, it is listed on UDP port 631 and is open to the world</p>
</blockquote>
<ul>
<li>Example service conf</li>
</ul>
<p><code>/usr/lib/systemd/system/cups.service.d/99-cups-harden.conf</code></p>
<pre><code class="lang-auto">[Service]
# Minimal capabilities ‚Äì only needed to bind to privileged ports (631)
CapabilityBoundingSet=CAP_NET_BIND_SERVICE

# Give CUPS its own network namespace ‚Äì no external network access
PrivateNetwork=yes

# Prevent the service from gaining new privileges (setuid, etc.)
NoNewPrivileges=yes

# Restrict network families ‚Äì only IPv4/IPv6 TCP, no UDP
RestrictAddressFamilies=AF_INET AF_INET6

# Bind only to the loopback interface (change to a specific IP if you need LAN access)
# The ExecStart line in the original unit already runs /usr/sbin/cupsd
# If you want to force a bind address at the service level uncomment
# ExecStart=
# ExecStart=/usr/sbin/cupsd -o Listen=127.0.0.1:631

# Filesystem protection ‚Äì keep CUPS from touching the rest of the system
ProtectSystem=full
PrivateTmp=yes
ReadOnlyPaths=/etc/cups
ReadWritePaths=/var/spool/cups /var/log/cups

# Drop any unnecessary privileges
ProtectKernelTunables=yes
ProtectKernelModules=yes
ProtectControlGroups=yes
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
