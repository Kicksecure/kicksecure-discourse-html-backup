<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Unplugging external drive doesn&#39;t trigger a shutdown - Support - Kicksecure Forums</title>
    <meta name="description" content="Hello Kicksecure folks, 
I installed Debian on my brand new Western Digital external SSD drive. Then I proceeded to distro morph it following the guide (prob should have went with the ISO route) and everything works as i&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.5 - https://github.com/discourse/discourse version 1a1314f41d82402ff28164f94174d82f7bff8d7d">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="994.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c162268923430.css_%3b%20filename_%3dUTF-8%27%27color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c1622689234306?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="../../stylesheets/desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="../../stylesheets/checklist_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27checklist_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="../../stylesheets/discourse-details_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-details_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="../../stylesheets/discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="../../stylesheets/discourse-local-dates_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="../../stylesheets/discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab261cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="../../stylesheets/discourse-presence_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="../../stylesheets/docker_manager_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27docker_manager_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="../../stylesheets/footnote_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27footnote_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="../../stylesheets/poll_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
  <link href="../../stylesheets/poll_desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c8.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c861cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a92.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a9261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="header"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>



<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Unplugging external drive doesn&#39;t trigger a shutdown&#39;" href="994.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/unplugging-external-drive-doesnt-trigger-a-shutdown/994" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/unplugging-external-drive-doesnt-trigger-a-shutdown/994" />
<meta property="og:title" content="Unplugging external drive doesn&#39;t trigger a shutdown" />
<meta name="twitter:title" content="Unplugging external drive doesn&#39;t trigger a shutdown" />
<meta property="og:description" content="Hello Kicksecure folks,  I installed Debian on my brand new Western Digital external SSD drive. Then I proceeded to distro morph it following the guide (prob should have went with the ISO route) and everything works as intended.  However when I unplug my SSD or it comes unplugged somehow (has happened before) it doesn‚Äôt trigger a full shutdown?  Why doesn‚Äôt it fully shutdown when unplugged?  I do want to add that also set up LUKS when I installed Debian.  Do I need to create a udev rule that run..." />
<meta name="twitter:description" content="Hello Kicksecure folks,  I installed Debian on my brand new Western Digital external SSD drive. Then I proceeded to distro morph it following the guide (prob should have went with the ISO route) and everything works as intended.  However when I unplug my SSD or it comes unplugged somehow (has happened before) it doesn‚Äôt trigger a full shutdown?  Why doesn‚Äôt it fully shutdown when unplugged?  I do want to add that also set up LUKS when I installed Debian.  Do I need to create a udev rule that run..." />
<meta property="og:article:section" content="Support" />
<meta property="og:article:section:color" content="0088CC" />
<meta name="twitter:label1" value="Reading time" />
<meta name="twitter:data1" value="6 mins üïë" />
<meta name="twitter:label2" value="Likes" />
<meta name="twitter:data2" value="15 ‚ù§" />
<meta property="article:published_time" content="2025-04-09T10:04:29+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>
<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">
    Kicksecure Forums
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="994.html">Unplugging external drive doesn&#39;t trigger a shutdown</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/support/6.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #0088CC'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Support</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Unplugging external drive doesn&#39;t trigger a shutdown'>
      <link itemprop='url' href='994.html'>
      <meta itemprop='datePublished' content='2025-04-09T10:04:28Z'>
        <meta itemprop='articleSection' content='Support'>
      <meta itemprop='keywords' content=''>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/NTH9R6'><span itemprop='name'>NTH9R6</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="994.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-04-09T10:04:29Z' class='post-time'>
                    April 9, 2025, 10:04am
                  </time>
                  <meta itemprop='dateModified' content='2025-04-09T10:04:29Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Hello Kicksecure folks,</p>
<p>I installed Debian on my brand new Western Digital external SSD drive. Then I proceeded to distro morph it following the guide (prob should have went with the ISO route) and everything works as intended.</p>
<p>However when I unplug my SSD or it comes unplugged somehow (has happened before) it doesn‚Äôt trigger a full shutdown?</p>
<p>Why doesn‚Äôt it fully shutdown when unplugged?<br>
I do want to add that also set up LUKS when I installed Debian.</p>
<p>Do I need to create a udev rule that runs a shutdown script (unmount, cryptsetup luksClose, and sync)?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-09T10:06:45Z' class='post-time'>
                    April 9, 2025, 10:06am
                  </time>
                  <meta itemprop='dateModified' content='2025-04-09T10:06:45Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a href="../../../external.html?link=https://forums.whonix.org/t/panic-button-panic-shutdown-buskill-the-usb-kill-cord-for-your-laptop/13755" class="inline-onebox">panic button / panic shutdown / BusKill - The USB kill cord for your laptop - Development - Whonix Forum</a> alike functionality is not a standard, default functionality of Debian (or any operating system that I am aware of).</p>
<p>Adding such a feature is planned but will take time.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="2" />
              <span class='post-likes'>2 Likes</span>
            </div>

          </div>
          <div id='post_3' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/NTH9R6'><span itemprop='name'>NTH9R6</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-11T18:32:54Z' class='post-time'>
                    April 11, 2025,  6:32pm
                  </time>
                  <meta itemprop='dateModified' content='2025-04-11T18:32:54Z'>
              <span itemprop='position'>3</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Ok, in the meantime though is there a udev starting point I could try to test?</p>
<p>I‚Äôd be willing to test anything related to implementation of such a feature.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_4' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/maltfield'><span itemprop='name'>maltfield</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-13T18:02:08Z' class='post-time'>
                    April 13, 2025,  6:02pm
                  </time>
                  <meta itemprop='dateModified' content='2025-04-13T18:18:05Z'>
              <span itemprop='position'>4</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p><a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/nth9r6">@NTH9R6</a> I think you might be confusing TAILS and kicksecure. TAILS is the only OS that I know-of that is designed to trigger an emergency shutdown when the USB stick that it‚Äôs installed-on is removed:</p>
<ul>
<li><a href="../../../external.html?link=https://tails.boum.org/doc/first_steps/shutdown/index.en.html" class="inline-onebox" rel="noopener nofollow ugc">Tails - Shutting down Tails</a></li>
</ul>
<p>But, as Patrick pointed-out, probably the easiest way to get your system to shutdown when a USB device ejects is BusKill, which can be installed on debian-based systems:</p>
<pre><code class="lang-auto">sudo apt-get install buskill
buskill
</code></pre>
<p>But if you prefer to do this with udev, we have a guide on that too:</p>
<ul>
<li><a href="../../../external.html?link=https://www.buskill.in/buskill-laptop-kill-cord-dead-man-switch/" class="inline-onebox" rel="noopener nofollow ugc">Introducing BusKill: A Kill Cord for your Laptop - BusKill</a></li>
</ul>
<p>Update: it actually looks like <a href="../../../external.html?link=https://tube.tchncs.de/c/privacy__tech_tips/videos" rel="noopener nofollow ugc">privacy__tech_tips@tube.tchncs.de</a> just published a <a href="../../../external.html?link=https://tube.tchncs.de/w/q8X2JyxYH26tqYi2VisTHb" rel="noopener nofollow ugc">video showing how to do this on kicksecure</a> today</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="../../../external.html?link=https://tube.tchncs.de/w/q8X2JyxYH26tqYi2VisTHb">
  <header class="source">
      <img src="../../../external.html?link=https://tube.tchncs.de/client/assets/images/favicon.png?234ac86bda73f12b2779a87d0c96b326b5fc05ca" class="site-icon" width="32" height="32">

      <a href="../../../external.html?link=https://tube.tchncs.de/w/q8X2JyxYH26tqYi2VisTHb" target="_blank" rel="noopener nofollow ugc">tchncs</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/389;"><img src="../../../external.html?link=https://tube.tchncs.de/lazy-static/previews/f701559c-14ee-4bb5-9c11-46263aae2253.jpg" class="thumbnail" width="690" height="389"></div>

<h3><a href="../../../external.html?link=https://tube.tchncs.de/w/q8X2JyxYH26tqYi2VisTHb" target="_blank" rel="noopener nofollow ugc">BusKill: Self Destructing Laptop Storage</a></h3>

  <p>Let's configure BusKill (laptop kill cord) to destroy our encrypted storage (preventing access to sensitive accounts / files) ! This set up will shred our LUKS (Linux encryption) header anytime som...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>They show how to do the self-destruct trigger, but you can trivially change that to lock the screen instead, if you prefer.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_5' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-14T10:14:15Z' class='post-time'>
                    April 14, 2025, 10:14am
                  </time>
                  <meta itemprop='dateModified' content='2025-04-14T10:14:15Z'>
              <span itemprop='position'>5</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="NTH9R6" data-post="3" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>Ok, in the meantime though is there a udev starting point I could try to test?</p>
</blockquote>
</aside>
<p>Feel free to experiment with this.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_6' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/NTH9R6'><span itemprop='name'>NTH9R6</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-21T19:49:58Z' class='post-time'>
                    April 21, 2025,  7:49pm
                  </time>
                  <meta itemprop='dateModified' content='2025-04-21T19:49:58Z'>
              <span itemprop='position'>6</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <blockquote>
<p>TAILS is the only OS that I know-of that is designed to trigger an emergency shutdown when the USB stick that it‚Äôs installed-on is removed</p>
</blockquote>
<blockquote>
<p>but you can trivially change that to lock the screen instead, if you prefer.</p>
</blockquote>
<p>Yeah to be clear I‚Äôm not looking to shred the LUKS Header I don‚Äôt want to destroy my data. While I do understand that such an emergency shutdown might loose some data (like that of the given booted session) I‚Äôm okay with that.</p>
<p>What I‚Äôm trying to achieve is that in the case of an emergency or that my SSD gets unplugged that it triggers a full shutdown meaning that the LUKS volume is in a closed state. Ideally would like to go further with something similar to Tails that clears wipes RAM also so that things like mentioned by <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/penthouse">@Penthouse</a> would clear the LUKS password from system memory.</p>
<p>I need to look more into all this and report back. The emergency shutdown seems like it could be implemented but the clearing of RAM due the different design (Tails vs dracut) would need to be figured out more. BTW I was not aware of the <code>ram-wipe</code> package until I made this reply.</p>
<p>www .kicksecure.com/wiki/Dev/RAM_Wipe#Differences_of_ram-wipe_versus_Tails_Memory_Erasure</p>
<p><a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/maltfield">@maltfield</a><br>
Does the <code>shutdown -h now</code> command close the LUKS volume or should <code>unmount</code> and <code>cryptsetup luksClose</code> used before that command?<br>
If so I wonder if replacing the <code>RUN+="shutdown -h now"</code> with one of the dracut ram-wipe module hooks would be efficient enough for me to test in non live mode?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_7' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/maltfield'><span itemprop='name'>maltfield</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-04-21T21:38:29Z' class='post-time'>
                    April 21, 2025,  9:38pm
                  </time>
                  <meta itemprop='dateModified' content='2025-04-21T21:38:58Z'>
              <span itemprop='position'>7</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="NTH9R6" data-post="6" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>would clear the LUKS password from system memory.</p>
</blockquote>
</aside>
<p>Take a look at <a href="../../../external.html?link=https://www.man7.org/linux/man-pages/man8/cryptsetup-luksSuspend.8.html" rel="noopener nofollow ugc">luksSuspend</a></p>
<aside class="quote no-group" data-username="NTH9R6" data-post="6" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>Does the <code>shutdown -h now</code> command close the LUKS volume or should <code>unmount</code> and <code>cryptsetup luksClose</code> used before that command?<br>
If so I wonder if replacing the <code>RUN+="shutdown -h now"</code> with one of the dracut ram-wipe module hooks would be efficient enough for me to test in non live mode?</p>
</blockquote>
</aside>
<p>I would execute a <code>luksSuspend</code> followed by shutdown. If you want a faster shutdown, try <code>echo o &gt; /proc/sysrq-trigger &amp;</code>. See how we do this at the end of the BusKill self-destruct script:</p>
<ul>
<li><a href="../../../external.html?link=https://github.com/BusKill/buskill-linux/blob/c3e056251377a25e504f5bdc41b2fc17c49f8d2e/triggers/buskill-selfdestruct.sh#L154-L179" class="inline-onebox" rel="noopener nofollow ugc">buskill-linux/triggers/buskill-selfdestruct.sh at c3e056251377a25e504f5bdc41b2fc17c49f8d2e ¬∑ BusKill/buskill-linux ¬∑ GitHub</a></li>
</ul>
<pre><code class="lang-auto">#################################
# WIPE DECRYPTION KEYS FROM RAM #
#################################

# suspend each currently-decrypted LUKS volume
${ECHO} "INFO: removing decryption keys from memory"
for device in $( ${LS} -1 "/dev/mapper" ); do

	${ECHO} -e "\t${device}";
	${CRYPTSETUP} luksSuspend "${device}" &amp;

	# clear page caches in memory (again)
	sync; echo 3 &gt; /proc/sys/vm/drop_caches

done

#############################
# (IMMEDIATE) HARD SHUTDOWN #
#############################

# do whatever works; this is important.
echo o &gt; /proc/sysrq-trigger &amp;
sleep 1
shutdown -h now &amp;
sleep 1
poweroff --force --no-sync &amp;
</code></pre>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_8' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-07T03:23:46Z' class='post-time'>
                    May 7, 2025,  3:23am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-07T03:23:46Z'>
              <span itemprop='position'>8</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>This is definitely a good idea. I took a look at the linked video about BusKill, the idea seems good but I don‚Äôt think that‚Äôs the method we should use for Kicksecure, because it‚Äôs bound to the USB product ID. You have to custom-write the udev rule for the specific USB drive in use. We could in theory detect this on boot I guess, but that seems a bit clunky. I also don‚Äôt trust USB drive manufacturers to choose truly unique IDs, as opposed to just putting in some example ID they found in documentation somewhere. (If even AMD can make this mistake with encryption keys related to microcode security, I have no reason to trust off-brand USB drive makers to do any better.) The last thing a user needs is to have their system suddenly shut down because they removed a drive that happened to look suspiciously similar to the main drive.</p>
<p>I looked at how Tails has this implemented, and basically:</p>
<ul>
<li>They have a custom C executable, <a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/blob/master/config/chroot_local-includes/usr/src/udev-watchdog.c" rel="noopener nofollow ugc">udev-watchdog</a>, which appears to watch for a specified device to be removed and send some sort of signal to whatever called it when that happens.</li>
<li>There‚Äôs then a wrapper around it that figures out which device is the boot drive, uses udev-watchdog to watch for when it gets removed, and then triggers a hard shutdown when that happens.</li>
</ul>
<p>This is a somewhat better solution IMO, and the code behind it is open-source so in theory we could just integrate it directly into Kicksecure. It does have some possible downsides though, most notably I found some <a href="../../../external.html?link=https://www.reddit.com/r/tails/comments/xh8njn/tails_wont_shutdown_when_i_pull_usb_stick/" rel="noopener nofollow ugc">reports that the feature didn‚Äôt always work three years ago</a>, when the last code change <a href="../../../external.html?link=https://gitlab.tails.boum.org/tails/tails/-/blob/master/config/chroot_local-includes/usr/local/lib/udev-watchdog-wrapper" rel="noopener nofollow ugc">was four years ago</a>. Maybe that was just user error though.</p>
<p>For Kicksecure‚Äôs implementation, I‚Äôd like to avoid custom C code since Kicksecure tries to use architecture-independent code wherever possible. We can use a udev-based approach similar to Tails, but written using Python and pyudev instead. I‚Äôll try to implement this probably tonight and see what happens.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

          </div>
          <div id='post_9' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-07T05:41:14Z' class='post-time'>
                    May 7, 2025,  5:41am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-07T05:41:14Z'>
              <span itemprop='position'>9</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Won‚Äôt be able to finish this tonight, determining the block device that‚Äôs <em>actually</em> underneath the filesystem is a bit of a challenge. One of the comments I wrote in my current code reads:</p>
<pre><code class="lang-auto">    # ... the real underlying device may be many
    # layers deep. For instance, with the Kicksecure ISO, the root filesystem
    # is mounted from an overlayfs which uses a lower directory mounted from a
    # loop device backed by a squashfs located in a directory under a
    # mountpoint backed by /dev/sr0 (when booting from a CD-ROM drive that
    # is).
</code></pre>
<p>There‚Äôs also some higher-priority work for me to tackle before I finish this. I have most of the research done though, including how to find underlying devices or mountpoints in a wide variety of situations, and how to monitor the real device once you find it. Also wrote a rather thorough ‚Äúforce shutdown‚Äù script based partially on <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/maltfield">@maltfield</a>‚Äôs suggestions above.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="3" />
              <span class='post-likes'>3 Likes</span>
            </div>

          </div>
          <div id='post_10' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-09T05:15:56Z' class='post-time'>
                    May 9, 2025,  5:15am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-09T05:15:56Z'>
              <span itemprop='position'>10</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Did a lot of research into this, the approach I was taking technically worked but was not at all guaranteed to work. The issues (and how to work around them) I documented pretty well in a code comment in the program I‚Äôm currently writing to implement this:</p>
<pre data-code-wrap="c"><code class="lang-c">/*
 * This program is designed specifically to immediately and forcibly power off
 * the system in the event the device providing the root filesystem is
 * abruptly removed from the system. The idea is that a user can shut down
 * a portable installation of Kicksecure by simply yanking the USB drive
 * containing the installation from the computer. Tails provides essentially
 * the same feature, however it is known for occasionally failing to do its
 * job properly.
 *
 * The fact that we're triggering a shutdown when the device containing the
 * root filesystem vanishes presents a number of significant challenges:
 *
 * - The device providing the entire operating system is gone. The only things
 *   we will still have left are the kernel, files loaded into RAM (for
 *   instance under /run), and anything that happens to still be in the
 *   system's disk cache.
 * - Virtually any process on the system may abruptly crash at any time. This
 *   isn't just because applications may be unable to access files. The Linux
 *   kernel's virtual memory subsystem doesn't just page out RAM contents to a
 *   swap file, it will sometimes simply erase pages containing executable
 *   code from memory if it can reload that code from disk later when needed.
 *   If part of a program isn't present in memory, and then the root device
 *   vanishes, any attempt to use code in the absent part of the application
 *   will result in the application crashing. (Attempts to access data in RAM
 *   that happened to be paged out will result in a similar crash.)
 * - We have no control over what is and isn't in the disk cache, which makes
 *   it unsafe to launch any dynamically linked executable. What happens if we
 *   need to load a missing part of libc? What if the dynamic linker itself
 *   needs loaded from disk?
 * - Systemd could lock up at any time, since the init process isn't immune to
 *   having bits of it erased from RAM to free up memory. If systemd receives
 *   a SIGSEGV, rather than crashing (which would panic the kernel), it goes
 *   into an "emergency mode" that tries to keep the system as operational as
 *   possible even though PID 1 is now out of service.
 *
 * Circumventing this set of difficulties is not easy, and it might not even
 * be entirely possible. To give our feature the highest chance of success:
 *
 * - We use memlockd to lock systemd into memory. It can holds its own pretty
 *   well in the event of a segfault, but if its crash handler ends up
 *   re-segfaulting, that could get ugly. For good measure, we lock libc,
 *   libsystemd-core, and libsystemd-shared into memory too so that the crash
 *   handler has the highest possible chance of not re-crashing.
 * - We compile the utility at boot time, statically link it against all of
 *   its dependencies (really only one, glibc), and load it into /run. This
 *   allows for decent architecture independence while removing any dependency
 *   on anything that isn't in RAM, thus (hopefully!) making the process
 *   crash-immune.
 * - Because we're static-linking against glibc, we cannot call anything
 *   defined in stdio.h. This is because glibc uses dlopen() to load iconv
 *   modules, which are used internally by glibc for locale support. Things
 *   defined in stdio.h may use iconv, so calling anything there will
 *   basically make our static-linked executable become dynamically linked,
 *   which could segfault it since the root filesystem is gone. We can't call
 *   anything that could touch Name Service Switch (NSS) either, but we have
 *   no need to do so, so we should be safe there. See
 *   https://stackoverflow.com/questions/57476533/why-is-statically-linking-glibc-discouraged
 * - We can't use udev either because libudev is only available as a dynamic
 *   library. That means we have to listen to kernel uevents directly to
 *   determine when the root device vanishes. Thankfully this isn't as much of
 *   a pain as it might sound like.
 * - We don't call out to any external process, since those external processes
 *   could segfault.
 *
 * This is likely superior to Tails' implementation, which uses udev (and thus
 * dynamic linking), uses an interpreter-driven script to shut down the system
 * when the root device vanishes, and calls out to external executables to
 * actually shut the system down. These issues are likely why Tails'
 * implementation of emergency shutdown occasionally fails. See
 * https://www.reddit.com/r/tails/comments/xh8njn/tails_wont_shutdown_when_i_pull_usb_stick/
 * (there are other similar posts as well).
 */
</code></pre>
<p>The rest of my research was focused mainly on figuring out how to read kernel uevents without involving libudev. This took a while, partially because libudev itself was sticking its head in the way and confusing my program‚Äôs output, and partially because <code>man 7 netlink</code> was extraordinarily misleading (it told me the data from the kernel I was reading was going to be in one format, it turned out to be in a completely different format). However, I‚Äôve gotten to the point where I <em>can</em> read kernel uevents, which will let me detect when the root filesystem drive is removed without needing any other libraries or executables (which is important for the reasons described above).</p>
<p>Once this is done and working, it might be worth trying to contribute it back to Tails (or at least let them know about our work) so they can improve their implementation as well.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="4" />
              <span class='post-likes'>4 Likes</span>
            </div>

          </div>
          <div id='post_11' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Quiksilver'><span itemprop='name'>Quiksilver</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-30T01:06:24Z' class='post-time'>
                    May 30, 2025,  1:06am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-30T01:06:24Z'>
              <span itemprop='position'>11</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="arraybolt3" data-post="9" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>Also wrote a rather thorough ‚Äúforce shutdown‚Äù script based partially on <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/maltfield">@maltfield</a>‚Äôs suggestions above.</p>
</blockquote>
</aside>
<p>Does it use the existing <code>ram-wipe</code> package as <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/nth9r6">@NTH9R6</a> mentioned?</p>
<blockquote>
<p>Once this is done and working</p>
</blockquote>
<p>Any way to donate towards this work specifically?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_12' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-30T12:59:55Z' class='post-time'>
                    May 30, 2025, 12:59pm
                  </time>
                  <meta itemprop='dateModified' content='2025-05-30T12:59:55Z'>
              <span itemprop='position'>12</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <aside class="quote no-group" data-username="Quiksilver" data-post="11" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Does it use the existing <code>ram-wipe</code> package as <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/nth9r6">@NTH9R6</a> mentioned?</p>
</blockquote>
</aside>
<p>Packaging hasn‚Äôt been discussed/decided yet.</p>
<p>When there‚Äôs something to announce, we‚Äôll post here and mention it in the next release changelog.</p>
<aside class="quote no-group quote-modified" data-username="Quiksilver" data-post="11" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="../../user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<blockquote>
<p>Once this is done and working</p>
</blockquote>
<p>Any way to donate towards this work specifically?</p>
</blockquote>
</aside>
<p>Goal specific donations are unsupported.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_13' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-05-31T01:19:24Z' class='post-time'>
                    May 31, 2025,  1:19am
                  </time>
                  <meta itemprop='dateModified' content='2025-05-31T01:19:24Z'>
              <span itemprop='position'>13</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>It doesn‚Äôt use ram-wipe at the moment. It may be desirable for something like that to be done, but given the limitations we‚Äôre operating under to avoid crashes, it might not be possible or practical. Good TODO for me to research.</p>
<p>I currently have some higher-priority tasks in my queue that are keeping me from getting back to this, but it‚Äôs definitely not dropped off my radar and I‚Äôm looking forward to finishing this when I can.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="1" />
              <span class='post-likes'>1 Like</span>
            </div>

          </div>
          <div id='post_14' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/NTH9R6'><span itemprop='name'>NTH9R6</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-06-16T02:20:35Z' class='post-time'>
                    June 16, 2025,  2:20am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-16T02:20:35Z'>
              <span itemprop='position'>14</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Sorry for the late reply to the post but I wanted to follow up with what I did and what I‚Äôm trying to troubleshoot at the moment.</p>
<p>What worked for me so far or the steps I have taken.<br>
Prob might have to re-edit this when I double check on my other system I‚Äôm testing this with, just have been busy with things like work atm.</p>
<p>Thanks to <a class="mention" href="../../../external.html?link=https://forums.kicksecure.com/u/maltfield">@maltfield</a> for buskill and providing the to code start from.</p>
<hr>
<p>I created a udev rule:</p>
<p><code>/etc/udev/rules.d/emergencyshutdown.rules</code></p>
<ul>
<li>udev shutdown rule:</li>
</ul>
<p><code>ACTION=="remove", SUBSYSTEM=="usb", ENV{ID_MODEL}=="Samsung Model" RUN+="/usr/bin/systemctl poweroff --force --ignore-inhibit"</code></p>
<p><code>shutdown -h now</code> didn‚Äôt work for me since I was logged in as another user and the other user was still logged in. Normally this would be no issue on traditional linux but on systemd-based systems <code>/sbin/shutdown</code> is typically a symlink to <code>/usr/bin/systemctl</code>. This means that when you run shutdown, you‚Äôre indirectly using systemctl. I don‚Äôt recall <code>shutdown --force</code> helping, though I will have to check my notes.</p>
<p>So I went with the <code>systemctl poweroff --force --ignore-inhibit</code> since parameter that modifies the shutdown process by forcing it to proceed and ignoring inhibitor locks, allowing the system to shut down even if other users are logged in. Which seemed to be an issue for me.</p>
<ul>
<li>udev Environment variables vs <code>ATTRS{idVendor}</code> and  <code>ATTRS{idProduct}</code></li>
</ul>
<p>So I‚Äôm not sure if its my device (External Samsung SSD) or since I‚Äôm running it off the external SSD, but it appears that <code>ATTRS{idVendor}</code> <code>ATTRS{idProduct}</code> only worked but I need to double check again.<br>
Samsung has been known for issues like with things like SMART support so that something to take into account maybe related.</p>
<p>I used <code>lsusb</code> do get the ID_VENDOR (first hexadecimal number) and the ID_PRODUCT (:second hexadecimal number).</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_15' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/NTH9R6'><span itemprop='name'>NTH9R6</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-06-16T02:26:29Z' class='post-time'>
                    June 16, 2025,  2:26am
                  </time>
                  <meta itemprop='dateModified' content='2025-06-16T02:26:29Z'>
              <span itemprop='position'>15</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Now onto closing LUKS volumes followed clearing memory and then shutting down.</p>
<p>I mainly took from buskill for the script but I changed something since it doesn‚Äôt appear to explicitly check if its a luks device in the loop before suspending it. The logging was me trying to debug it to see what was going on.</p>
<pre data-code-wrap="sh"><code class="lang-sh"># Set up logging
LOG_FILE="/var/log/emergency-shutdown.log"

# Function to suspend LUKS volumes
echo "Emergency shutdown initiated: $(date)" &gt; "$LOG_FILE"
suspend_luks_volumes() {
    echo "INFO: Removing decryption keys from memory" &gt;&gt; "$LOG_FILE"
    for device in /dev/mapper/*; do
        if cryptsetup isLuks "$device"; then
            echo "Suspending $device..." &gt;&gt; "$LOG_FILE"
            if cryptsetup luksSuspend "$device"; then
                echo "Successfully suspended $device" &gt;&gt; "$LOG_FILE"
            else
                echo "Failed to suspend $device. Error: $?" &gt;&gt; "$LOG_FILE"
            fi
        fi
    done
}
</code></pre>
<p>The system locks up and doesn‚Äôt go to a black screen and show anything?<br>
I‚Äôm not sure if this cause the root filesystem is the luks volume (FDE) or what?</p>
<p>Do I need to kill x &amp; lightdm or switch over to a minimal env or a tty to switch over to a black screen?</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
