<!DOCTYPE html>
<html lang="en">
  <!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
    <meta charset="utf-8">
    <title>Investigate security (SUID) impact of polkitd and policykit libraries - Development - Kicksecure Forums</title>
    <meta name="description" content="Todo: research 
We still have SUID (alike) functionality due to the following packages / libraries? 

polkitd
libpolkit-agent-1-0
libpolkit-gobject-1-0

Potential consumers: 

udisksd
accounts-daemon

context: SUID Disab&amp;hellip;">
    <meta name="generator" content="Discourse 3.4.5 - https://github.com/discourse/discourse version 1a1314f41d82402ff28164f94174d82f7bff8d7d">
<link rel="icon" type="image/png" href="../../uploads/default/optimized/1X/0db9935a1fdd7302cae516aaa752af0de307d388_2_32x32.png">
<link rel="apple-touch-icon" type="image/png" href="../../uploads/default/optimized/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67_2_180x180.png">
<meta name="theme-color" media="all" content="#fff">

<meta name="color-scheme" content="light">

<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, viewport-fit=cover">
<link rel="canonical" href="1075.html" />

<link rel="search" type="application/opensearchdescription+xml" href="../../opensearch.xml" title="Kicksecure Forums Search">

    <link href="../../stylesheets/color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c162268923430.css_%3b%20filename_%3dUTF-8%27%27color_definitions_base__3_58d3e6a62bbcfd837d27bf50c11c1622689234306?__ws=forums.kicksecure.com" media="all" rel="stylesheet" class="light-scheme"/>

  <link href="../../stylesheets/desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop"  />



  <link href="../../stylesheets/checklist_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27checklist_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="checklist"  />
  <link href="../../stylesheets/discourse-details_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-details_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-details"  />
  <link href="../../stylesheets/discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-lazy-videos_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-lazy-videos"  />
  <link href="../../stylesheets/discourse-local-dates_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-local-dates_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-local-dates"  />
  <link href="../../stylesheets/discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-narrative-bot_27a873e6f6411872159c8df0158556932392cab261cf?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-narrative-bot"  />
  <link href="../../stylesheets/discourse-presence_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27discourse-presence_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="discourse-presence"  />
  <link href="../../stylesheets/docker_manager_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27docker_manager_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="docker_manager"  />
  <link href="../../stylesheets/footnote_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27footnote_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="footnote"  />
  <link href="../../stylesheets/poll_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll"  />
  <link href="../../stylesheets/poll_desktop_27a873e6f6411872159c8df0158556932392cab2.css_%3b%20filename_%3dUTF-8%27%27poll_desktop_27a873e6f6411872159c8df0158556932392cab261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="poll_desktop"  />

  <link href="../../stylesheets/desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c8.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_3_a6149e272e30d7f0925ea74416c90af282eea4c861cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="3" data-theme-name="graceful"/>
<link href="../../stylesheets/desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a92.css_%3b%20filename_%3dUTF-8%27%27desktop_theme_2_f12616e0ab837bd2681302351e35914a09eb0a9261cf.css?__ws=forums.kicksecure.com" media="all" rel="stylesheet" data-target="desktop_theme" data-theme-id="2" data-theme-name="header"/>

    <!--
START custom CSS / JS

Configured here:
https://forums.kicksecure.com/admin/customize/themes/2/common/head_tag/edit
-->

<!-- START End of Year Banner -->


<!-- Not needed currently because banner inactive
<link rel="stylesheet" href="/mw-autogen/src-copy/CodeSelect.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/PayViaPaypal.css">
<link rel="stylesheet" href="/mw-autogen/src-copy/Sitenotice_EndOfYear.css">
-->

<!-- Not needed currently because banner inactive
<script type="text/javascript" defer src="/mw-autogen/src-copy/CodeSelect.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/PayViaPaypal.js"></script>
<script type="text/javascript" defer src="/mw-autogen/src-copy/Sitenotice_EndOfYear.js"></script>
-->

<style type="text/css">
  #donate-end-of-year div,
  #donate-end-of-year span,
  #donate-end-of-year a {
    box-sizing: border-box;
  }
  
  #end-of-year-banner-wrapper {
      margin: 0 10px 25px;
  }

  #donate-end-of-year i {
    width: 20px;
    height: 20px;
    background-size: contain;
    background-position: center;
    background-repeat: no-repeat;
    filter: brightness(2);
    display: inline-block;
  }

  #donate-end-of-year i.dismiss {
    background-image: url('../../w/images/0/0b/End-of-year-times.png');
  }

  #donate-end-of-year .slideshow > .content img {
    float: left;
    margin-right: 20px;
  }

  #donate-end-of-year .slideshow .flow i {
    cursor: pointer;
    filter: brightness(1);
    height: 17px;
    width: 17px;
    vertical-align: middle;
  }

  #donate-end-of-year .slideshow .flow i.is-play {
    background-image: url('../../w/images/3/32/End-of-year-pause.png');
  }

  #donate-end-of-year .slideshow .flow i.is-pause {
    background-image: url('../../w/images/c/c8/End-of-year-play.png');
  }

</style>



<!-- END End of Year Banner -->

<!--
END custom CSS / JS
-->

    
        <link rel="alternate nofollow" type="application/rss+xml" title="RSS feed of &#39;Investigate security (SUID) impact of polkitd and policykit libraries&#39;" href="1075.rss" />
    <meta property="og:site_name" content="Kicksecure Forums" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:image" content="https://forums.kicksecure.com/uploads/default/original/1X/cbdfe4b0c05c97069961301225ed1ccd6e766f67.png" />
<meta property="og:url" content="https://forums.kicksecure.com/t/investigate-security-suid-impact-of-polkitd-and-policykit-libraries/1075" />
<meta name="twitter:url" content="https://forums.kicksecure.com/t/investigate-security-suid-impact-of-polkitd-and-policykit-libraries/1075" />
<meta property="og:title" content="Investigate security (SUID) impact of polkitd and policykit libraries" />
<meta name="twitter:title" content="Investigate security (SUID) impact of polkitd and policykit libraries" />
<meta property="og:description" content="Todo: research  We still have SUID (alike) functionality due to the following packages / libraries?   polkitd libpolkit-agent-1-0 libpolkit-gobject-1-0  Potential consumers:   udisksd accounts-daemon  context: SUID Disabler and Permission Hardener  Originally brought up by Hizonner on https://www.reddit.com/r/Whonix/comments/1ktc1nb/comment/mvrnj3e/" />
<meta name="twitter:description" content="Todo: research  We still have SUID (alike) functionality due to the following packages / libraries?   polkitd libpolkit-agent-1-0 libpolkit-gobject-1-0  Potential consumers:   udisksd accounts-daemon  context: SUID Disabler and Permission Hardener  Originally brought up by Hizonner on https://www.reddit.com/r/Whonix/comments/1ktc1nb/comment/mvrnj3e/" />
<meta property="og:article:section" content="Development" />
<meta property="og:article:section:color" content="25AAE2" />
<meta property="og:article:tag" content="status_open_issue_todo" />
<meta property="article:published_time" content="2025-06-03T19:03:31+00:00" />
<meta property="og:ignore_canonical" content="true" />


    
  </head>
  <body class="crawler ">
    <div class="background-container"></div>
<div class="header-brand-nav">
    <a class="home" href="../../../external.html?link=https://www.kicksecure.com/">Kicksecure Wiki</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Download">Download</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Documentation">Docs</a>
    <a href="../../c/news/5.html">News</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Support">Support</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Forum_Best_Practices">Tips</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Reporting_Bugs#Issue_Tracker">Issues</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Contribute">Contribute</a>
    <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Donate">DONATE</a>
</div>
    <header>
  <a href="../../index.html">
    Kicksecure Forums
  </a>
</header>

    <div id="main-outlet" class="wrap" role="main">
        <div id="topic-title">
    <h1>
      <a href="1075.html">Investigate security (SUID) impact of polkitd and policykit libraries</a>
    </h1>

      <div class="topic-category" itemscope itemtype="http://schema.org/BreadcrumbList">
          <span itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem">
            <a href="../../c/development/7.html" class="badge-wrapper bullet" itemprop="item">
              <span class='badge-category-bg' style='background-color: #25AAE2'></span>
              <span class='badge-category clear-badge'>
                <span class='category-name' itemprop='name'>Development</span>
              </span>
            </a>
            <meta itemprop="position" content="1" />
          </span>
      </div>

      <div class="topic-category">
        <div class='discourse-tags list-tags'>
            <a href='../../tag/status_open_issue_todo.html' class='discourse-tag' rel="tag">status_open_issue_todo</a>
        </div>
      </div>
  </div>

  

    <div itemscope itemtype='../../../external.html?link=http://schema.org/DiscussionForumPosting'>
      <meta itemprop='headline' content='Investigate security (SUID) impact of polkitd and policykit libraries'>
      <link itemprop='url' href='1075.html'>
      <meta itemprop='datePublished' content='2025-06-03T19:03:31Z'>
        <meta itemprop='articleSection' content='Development'>
      <meta itemprop='keywords' content='status_open_issue_todo'>
      <div itemprop='publisher' itemscope itemtype="../../../external.html?link=http://schema.org/Organization">
        <meta itemprop='name' content='Kicksecure - a secure by default operating system'>
          <div itemprop='logo' itemscope itemtype="../../../external.html?link=http://schema.org/ImageObject">
            <meta itemprop='url' content='../../uploads/default/original/1X/b25d14d50e56313c399bc031caf564b64756e72b.png'>
          </div>
      </div>


          <div id='post_1'  class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/Patrick'><span itemprop='name'>Patrick</span></a>
                
              </span>

                <link itemprop="mainEntityOfPage" href="1075.html">


              <span class="crawler-post-infos">
                  <time  datetime='2025-06-03T19:03:31Z' class='post-time'>
                    June 3, 2025,  7:03pm
                  </time>
                  <meta itemprop='dateModified' content='2025-06-03T19:03:31Z'>
              <span itemprop='position'>1</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>Todo: research</p>
<p>We still have SUID (alike) functionality due to the following packages / libraries?</p>
<ul>
<li><code>polkitd</code></li>
<li><code>libpolkit-agent-1-0</code></li>
<li><code>libpolkit-gobject-1-0</code></li>
</ul>
<p>Potential consumers:</p>
<ul>
<li><code>udisksd</code></li>
<li><code>accounts-daemon</code></li>
</ul>
<p>context: <a href="../../../external.html?link=https://www.kicksecure.com/wiki/SUID_Disabler_and_Permission_Hardener" class="inline-onebox">SUID Disabler and Permission Hardener</a></p>
<p>Originally brought up by <a href="../../../external.html?link=https://www.reddit.com/user/Hizonner/">Hizonner</a> on <a href="../../../external.html?link=https://www.reddit.com/r/Whonix/comments/1ktc1nb/comment/mvrnj3e/">https://www.reddit.com/r/Whonix/comments/1ktc1nb/comment/mvrnj3e/</a></p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
          <div id='post_2' itemprop='comment' itemscope itemtype='http://schema.org/Comment' class='topic-body crawler-post'>
            <div class='crawler-post-meta'>
              <span class="creator" itemprop="author" itemscope itemtype="../../../external.html?link=http://schema.org/Person">
                <a itemprop="url" rel='nofollow' href='../../../external.html?link=https://forums.kicksecure.com/u/arraybolt3'><span itemprop='name'>arraybolt3</span></a>
                
              </span>



              <span class="crawler-post-infos">
                  <time itemprop='datePublished' datetime='2025-06-10T22:59:31Z' class='post-time'>
                    June 10, 2025, 10:59pm
                  </time>
                  <meta itemprop='dateModified' content='2025-06-10T22:59:31Z'>
              <span itemprop='position'>2</span>
              </span>
            </div>
            <div class='post' itemprop='text'>
              <p>I’ve looked at polkit’s documentation in <code>man 8 polkit</code>, and while I’m not exactly thrilled with some of how it works (and how it interacts with systemd), I don’t consider it a serious threat to a system’s security, and do consider it dangerous to remove or attempt removal of.</p>
<p>To be clear, polkitd does NOT by itself provide SUID-alike functionality. polkitd’s job is to tell other software whether it should let a user do something they’ve asked to do. It does not by itself actually grant any further access, it only helps other software decide whether to grant further access.</p>
<p>Hizonner’s main complaint against polkitd seems to be:</p>
<blockquote>
<p>I know it’s popular, but trying to use a separate reference monitor to enforce an externally defined “security policy” on requests to software is a recipe for errors.</p>
</blockquote>
<p>I don’t really agree with this statement. He seems to be saying, as far as I can tell, that it’s dangerous to have a process that tells other processes whether they are allowed to do things or not. This is what polkitd does - there’s a central daemon that receives connections from other software, asking it “is it OK for me to allow user Y to take action Z?” polkitd then looks at its configuration, decides whether to say “yes” or “no”, and then returns that answer to the caller. What the caller does with the answer from there is entirely up to it - in the case of systemd, it might allow an unprivileged user to start and stop system units, in the case of pkexec, it allows an unprivileged user to run things as root. That’s strictly because of how systemd and pkexec are designed though, there’s nothing polkitd does that inherently grants any extra access by itself.</p>
<p>Now, it is true that there is significant complexity in <em>how</em> polkitd decides to tell a user whether they are allowed to do something or not. polkit’s configuration is a combination of XML and JavaScript (yes, JavaScript!), which is capable of taking arbitrarily complex actions including launching external processes, as part of determining whether to authorize an action or not. This sounds pretty bad initially, but polkitd runs all of these actions in a sandboxed environment under a non-privileged user account, thus limiting the damage they can do on their own and the chances that they will be exploited. The biggest danger here is that a software package might might configure polkitd in an insecure way, and that’s a danger that’s present with any flexible authentication framework.</p>
<p>If we were to consider polkit’s method of operation dangerous, we’d have to also consider PAM dangerous, since it also runs sysadmin-defined code from a complex configuration repo as part of determining whether to grant authorization or not. PAM just authorizes logins rather than privileged actions. There’s nothing inherently dangerous about polkit’s and PAM’s method of operation other than complexity, and the jobs polkit and PAM have to do are complex enough to warrant that complexity. I believe it would be much more worthwhile to audit polkit’s configuration than to audit polkit itself.</p>
<p>Another complaint Hizonner made was:</p>
<blockquote>
<p>It only gets worse when that policy is defined by a patchwork of separately installable bits from who-knows-where. Basically any package installed in the system can include polkit rules, which means that any maintaner who’s frustrated that something doesn’t have automatic access to some service can make that “problem” go away.</p>
</blockquote>
<p>This also doesn’t seem like a problem to me. Sure, a package maintainer <em>could</em> use polkit as part of hacking around some privilege barrier. There are plenty of ways to do that though, including installing a SUID executable, dropping a sudoers config file into <code>/etc/sudoers.d</code>, or just installing a systemd service that does things on behalf of some other application. Getting rid of polkit wouldn’t prevent this, or even make it particularly harder.</p>
<p>I believe the concerns raised in this Reddit thread are a matter of opinion and not concrete security issues. Is it technically safer to live without polkit, udisksd, accounts-daemon, and the like? Maybe. It’s technically safer to live without a GUI, Bluetooth, WiFi, and USB too. Getting rid of Ethernet would also be helpful. Does that mean we should get rid of all of the above in the name of security? No, because that would render the system unusable to most people. There are systems where configurations like this make sense, a Kicksecure or Whonix desktop is not one of them.</p>
<hr>
<p>It is worth noting, polkitd is a security-sensitive component of the system and must <em>not</em> be compromised for the system to remain secure. Access to polkitd or the polkitd user account is equivalent to root access, as the polkitd process can use systemd APIs to escalate to root, authorizing its own request when systemd asks it if that request is permissible or not. polkitd’s sandboxing is not intended to prevent it from talking to systemd and requesting root access, and in my testing a process sandboxed as tightly as polkitd was able to gain access to an unsandboxed root shell using <code>run0</code> on Fedora 42. So despite the fact that polkitd doesn’t provide additional privileges to applicatiosn that call it, it can gain additional privileges itself.</p>
            </div>

            <div itemprop="interactionStatistic" itemscope itemtype="../../../external.html?link=http://schema.org/InteractionCounter">
              <meta itemprop="interactionType" content="../../../external.html?link=http://schema.org/LikeAction"/>
              <meta itemprop="userInteractionCount" content="0" />
              <span class='post-likes'></span>
            </div>

          </div>
    </div>


    




    </div>
    <footer class="container wrap">
  <nav class='crawler-nav'>
    <ul>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../index.html' itemprop="url">Home </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../categories.html' itemprop="url">Categories </a>
        </span>
      </li>
      <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
        <span itemprop='name'>
          <a href='../../guidelines.html' itemprop="url">Guidelines </a>
        </span>
      </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service' itemprop="url">Terms of Service </a>
          </span>
        </li>
        <li itemscope itemtype='../../../external.html?link=http://schema.org/SiteNavigationElement'>
          <span itemprop='name'>
            <a href='../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy' itemprop="url">Privacy Policy </a>
          </span>
        </li>
    </ul>
  </nav>
  <p class='powered-by-link'>Powered by <a href="../../../external.html?link=https://www.discourse.org/">Discourse</a>, best viewed with JavaScript enabled</p>
</footer>

    <div class="footer-brand-nav">
    <div class="legal">
        By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
        <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
    </div>
</div>

    <noscript>
    <div class="footer-brand-nav">
        <div class="legal">
            By using this website, you acknowledge you have read, understood, and agree to be bound by these these agreements:
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Terms_of_Service" title="Terms of Service">Terms of Service</a>, and
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Privacy_Policy" title="Privacy Policy">Privacy Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Cookie_Policy" title="Cookie Policy">Cookie Policy</a>,
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/E-Sign_Consent" title="E-Sign Consent">E-Sign Consent</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/DMCA">DMCA</a>
            <a href="../../../external.html?link=https://www.kicksecure.com/wiki/Imprint">Imprint</a>
        </div>
    </div>

    <style type="text/css">
        /* Here is room for styles for when Javascript is deactivated */
    </style>
</noscript>
  </body>
  
</html>
