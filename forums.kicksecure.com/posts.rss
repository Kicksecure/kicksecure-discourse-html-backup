<?xml version="1.0" encoding="UTF-8" ?>
<rss version="2.0" xmlns:discourse="http://www.discourse.org/" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:dc="http://purl.org/dc/elements/1.1/">
  <channel>
    <title>Kicksecure Forums - Latest posts</title>
    <link>https://forums.kicksecure.com</link>
    <description>Latest posts</description>
      <item>
        <title>Question about grub-live and writable file system</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>That looks OK to me. As long as it’s <em>only</em> /boot/efi that hasn’t been mounted read-only (as the dialog shows), then you’re no worse off than before.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/question-about-grub-live-and-writable-file-system/1221#post_14</link>
        <pubDate>Thu, 28 Aug 2025 21:06:05 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3323</guid>
      </item>
      <item>
        <title>Question about grub-live and writable file system</title>
        <dc:creator><![CDATA[@Jac]]></dc:creator>
        <description><![CDATA[ <p></p><div class="lightbox-wrapper"><a class="lightbox" href="https://forums.kicksecure.com/uploads/default/original/1X/01c5091cd40533c5e9d5d82834d2f37ca3d9479e.png" data-download-href="https://forums.kicksecure.com/uploads/default/01c5091cd40533c5e9d5d82834d2f37ca3d9479e" title="4-50"><img src="https://forums.kicksecure.com/uploads/default/original/1X/01c5091cd40533c5e9d5d82834d2f37ca3d9479e.png" alt="4-50" data-base62-sha1="fECHLmRImLoddQvzUhyBxp3QKi" width="690" height="395" data-dominant-color="96999F"></a></div><p></p> ]]></description>
        <link>https://forums.kicksecure.com/t/question-about-grub-live-and-writable-file-system/1221#post_13</link>
        <pubDate>Thu, 28 Aug 2025 07:27:32 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3322</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="Quiksilver" data-post="16" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>While the current rules look like they will broadly cover rejecting device with HID interfaces. Would it be good to block specific vendor ids that are used for such products like rubber ducky and other hacker sold products?</p>
</blockquote>
</aside>
<p>That spooks me a bit. Atmel is a reputable microcontroller production company, do we want to block every keyboard or mouse that uses their controllers? I wouldn’t expect so. The Hak5 rubber ducky presents itself as an Atmel device by default (according to information from <a href="https://forums.hak5.org/topic/25510-question-vendor-id-and-product-id-of-the-duck/" rel="noopener nofollow ugc">https://forums.hak5.org/topic/25510-question-vendor-id-and-product-id-of-the-duck/</a> and <a href="https://devicehunt.com/all-usb-vendors" class="inline-onebox" rel="noopener nofollow ugc">All USB Vendors | Device Hunt</a> anyway), but a lot of other devices might do the same.</p>
<p>Also, bear in mind that the vendor ID and product ID of the Rubber Ducky can be changed by the attacker according to <a href="https://github.com/cypher2048/ducky-decode-wiki/blob/master/Guide_Change_USB_VID_PID.wiki" class="inline-onebox" rel="noopener nofollow ugc">ducky-decode-wiki/Guide_Change_USB_VID_PID.wiki at master · cypher2048/ducky-decode-wiki · GitHub</a>, so at best, vendor ID rejection would only protect against attackers who didn’t really know what they were doing. I’m sure there’s a lot of those kinds of attackers out there, but I don’t really the benefits outweigh the costs here.</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="17" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Not trying to get off topic but rndis is kernel driver:</p>
</blockquote>
</aside>
<p>If we don’t block that already in security-misc, we really should. We have modprobe config for disabling things…</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="18" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Android devices should be blocked by default</p>
</blockquote>
</aside>
<p>Yeah, that’s the sort of thing I was afraid of. Then I think probably leaving MTP off is better.</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="18" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>For easy usability and user choice I think a USBGuard element/button part on the sysmaint panel should open the <code>30_security-misc.conf</code> in nano so users can comment or un comment out what they need.</p>
</blockquote>
</aside>
<p>Hmm, I like that idea!</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="19" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Also USB A-to-B or USB C-to-B “printer cables” that come with or in my case had to buy to plug into the the “printer port” (USB B) and into my PC via (USB A) would not be able to bypass this rule correct?</p>
</blockquote>
</aside>
<p>It shouldn’t, at the end of the day the cable isn’t anything more than an electrical connector that gets four (or nine, in the case of USB 3) pins from the device attached to your computer. Unless the cable is itself malicious (which is a thing), it shouldn’t present any extra danger as opposed to usual USB devices. Of course, if you were unlucky enough to use <a href="https://hak5.org/collections/homepage-collection-grid/products/omg-cable" rel="noopener nofollow ugc">one of these</a> then there would be a problem, but USBGuard should protect you in that instance, again, assuming you have a normal USB keyboard already connected and the cable wasn’t plugged in at boot time.</p>
<aside class="quote no-group" data-username="Quiksilver" data-post="19" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/quiksilver/48/110_2.png" class="avatar"> Quiksilver:</div>
<blockquote>
<p>Would or could some printers come up as Mass Storage Class (0x08) or Communication and CDC Class (0x02 or 0x0A) and bypass it?</p>
</blockquote>
</aside>
<p>I don’t know enough about how the USB protocol works under the hood to give a definitive answer there. I would hope the USB protocol isn’t so poorly designed as to allow a flash drive to call itself a flash drive but then act like a printer (which is the kind of think that would be enabled if a printer could still work as a printer even if it called itself a flash drive).</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_20</link>
        <pubDate>Wed, 27 Aug 2025 23:55:56 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3321</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>FWIW, CUPS doesn’t even appear to be installed on Kicksecure 17 by default, unless I accidentally uninstalled it in my development VM during other work:</p>
<pre><code class="lang-auto">[sysmaint ~]% apt list --installed | grep cups

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

libcups2/oldstable,oldstable-security,now 2.4.2-3+deb12u8 amd64 [installed,automatic]
</code></pre> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_7</link>
        <pubDate>Wed, 27 Aug 2025 20:47:30 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3320</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>Printers</p>
<ul>
<li>Could introduce attack surface that we don’t want, see <a href="https://www.evilsocket.net/2024/09/26/Attacking-UNIX-systems-via-CUPS-Part-I/" rel="noopener nofollow ugc">Attacking UNIX Systems via CUPS, Part I</a></li>
</ul>
</blockquote>
</aside>
<p>Occasionally do use my printer myself to print sometimes but I wouldn’t mind if you rejected printers (class 0x07) with <code>reject with-interface 07</code> by default.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="12" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>and <code>with-interface-type</code> should just be <code>with-interface</code> according to <a href="https://usbguard.github.io/documentation/rule-language" rel="noopener nofollow ugc">Rule Language | USBGuard</a>.</p>
</blockquote>
</aside>
<p>Looking at that both <code>reject with-interface interface-type="07"</code> or <code>reject with-interface 07</code> syntax’s seem to be correct but I would stick with whatever matches the style of the rest of your USBGuard policy so in this case <code>reject with-interface 07</code></p>
<p>Also USB A-to-B or  USB C-to-B “printer cables” that come with or in my case had to buy to plug into the the “printer port” (USB B) and into my PC via (USB A) would not be able to bypass this rule correct?</p>
<p>Would or could some printers come up as Mass Storage Class (0x08) or Communication and CDC Class (0x02 or 0x0A) and bypass it?</p>
<p><strong>HP</strong> Printers and scanners:</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/usbids/usbids/blob/master/usb.ids#L211-L756">
  <header class="source">

      <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L211-L756" target="_blank" rel="noopener nofollow ugc">github.com/usbids/usbids</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/usbids/usbids/blob/master/usb.ids#L211-L756" target="_blank" rel="noopener nofollow ugc">usb.ids</a></h4>

<div class="git-blob-info">
  <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L211-L756" rel="noopener nofollow ugc"><code>master</code></a>
</div>


  This file is binary. <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L211-L756" target="_blank" rel="noopener nofollow ugc">show original</a>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p><strong>Epson</strong> Printers and scanners:</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/usbids/usbids/blob/master/usb.ids#L4761-L4953">
  <header class="source">

      <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L4761-L4953" target="_blank" rel="noopener nofollow ugc">github.com/usbids/usbids</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/usbids/usbids/blob/master/usb.ids#L4761-L4953" target="_blank" rel="noopener nofollow ugc">usb.ids</a></h4>

<div class="git-blob-info">
  <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L4761-L4953" rel="noopener nofollow ugc"><code>master</code></a>
</div>


  This file is binary. <a href="https://github.com/usbids/usbids/blob/master/usb.ids#L4761-L4953" target="_blank" rel="noopener nofollow ugc">show original</a>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Two other common vendors are Cannon and Brother when it comes to printers and scanners.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_19</link>
        <pubDate>Wed, 27 Aug 2025 20:38:58 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3319</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <p>Honestly I really doubt upstream or Debian would add anything that disables network and LAN printing such as:</p>
<pre><code class="lang-auto">CapabilityBoundingSet=CAP_NET_BIND_SERVICE
PrivateNetwork=yes
</code></pre>
<p>However they might be accepting to <code>NoNewPrivileges=yes</code> and others.</p>
<p>People do indeed use network printing or LAN printing (I don’t do either personally) but maybe a new thread regarding CUPS should be made like “should CUPS even come disabled by default” or the ideas mentioned here.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_6</link>
        <pubDate>Wed, 27 Aug 2025 20:34:37 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3318</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>Yes, systemd configuration snippet drop-in support is amazing.</p>
<p>(As a distribution we should use folder <code>/usr/lib/systemd/system</code> rather than <code>/etc</code>.)</p>
<p>Any systemd hardening options:</p>
<ol>
<li>Please try to submit them upstream. (Such as to cups.) If that does not work,</li>
<li>Submit them to Debian.</li>
<li>Only then consider submitting these to Kicksecure.</li>
</ol>
<p>This is for the purpose of maintainability.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.kicksecure.com/wiki/Dev/maintainability">
  <header class="source">
      <img src="https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1756287028" class="site-icon" alt="" width="151" height="151">

      <a href="https://www.kicksecure.com/wiki/Dev/maintainability" target="_blank" rel="noopener" title="01:34PM - 25 August 2025">Kicksecure – 25 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/387;"><img src="https://www.kicksecure.com/w/images/5/51/Kicksecure-image-twitter-post.jpg?version=30a0ad75271a4836786771c345c960b8" class="thumbnail" alt="" width="690" height="388"></div>

<h3><a href="https://www.kicksecure.com/wiki/Dev/maintainability" target="_blank" rel="noopener">Maintainability</a></h3>

  <p>Exploring the challenges of maintainability in the Kicksecure project and Open Source development.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>See also:</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream">
  <header class="source">
      <img src="https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1756287028" class="site-icon" alt="" width="151" height="151">

      <a href="https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream" target="_blank" rel="noopener" title="02:18PM - 07 August 2025">Kicksecure – 7 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/387;"><img src="https://www.kicksecure.com/w/images/5/51/Kicksecure-image-twitter-post.jpg?version=30a0ad75271a4836786771c345c960b8" class="thumbnail" alt="" width="690" height="388"></div>

<h3><a href="https://www.kicksecure.com/wiki/Dev/Relationship_With_Upstream" target="_blank" rel="noopener">Relationship With Upstream</a></h3>

  <p>Kicksecure Relationship with Upstream Projects.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>This is not on our immediate roadmap: <a href="https://www.kicksecure.com/wiki/Security_Roadmap" class="inline-onebox">Kicksecure Security Roadmap</a></p>
<p>But anyone feel free to work on this.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_5</link>
        <pubDate>Wed, 27 Aug 2025 18:46:01 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3317</guid>
      </item>
      <item>
        <title>Unplugging external drive should trigger a shutdown</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>The status is still the same:</p><aside class="quote" data-post="20" data-topic="994">
  <div class="title">
    <div class="quote-controls"></div>
    <img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar">
    <div class="quote-title__text-content">
      <a href="https://forums.kicksecure.com/t/unplugging-external-drive-should-trigger-a-shutdown/994/20">Unplugging external drive should trigger a shutdown</a> <a class="badge-category__wrapper " href="https://forums.kicksecure.com/c/development/7"><span data-category-id="7" style="--category-badge-color: #25AAE2; --category-badge-text-color: #FFF;" data-drop-close="true" class="badge-category --style-square " title="Development of Kicksecure software and source code."><span class="badge-category__name">Development</span></span></a>
    </div>
  </div>
  <blockquote>
    Unplugging external drive → shutdown: This feature has been implemented in packages security-misc, helper-scripts and user-sysmaint-split by <a class="mention" href="https://forums.kicksecure.com/u/arraybolt3">@arraybolt3</a>. This feature will most likely become available in Kicksecure 18.
  </blockquote>
</aside>

<p>Distribution morphing won’t be special in this regard. Will be the same the “regular” version.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unplugging-external-drive-should-trigger-a-shutdown/994?page=2#post_27</link>
        <pubDate>Wed, 27 Aug 2025 18:35:20 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3316</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>Allowing “X system” to be booted alongside Kicksecure aids Kicksecure<br>
development because a surprising amount of the time, “X system” provides an<br>
environment for developing some component for an OS that cannot be easily<br>
developed or tested on that OS. Examples:</p>
<ul>
<li>Kloak version 2, intended for Kicksecure 18, could not be developed on<br>
Kicksecure 17 as the needed Wayland compositor (labwc) was not present in<br>
Debian 12’s repos. I had to install Debian 13 in a multiboot scenario to<br>
develop and test it properly, and physical hardware was needed to get<br>
touchpad support working</li>
<li>Xen kernel command line support in GRUB, intended for Qubes OS R4.3 (or<br>
maybe R4.4 at this point), could not be developed on Qubes OS R4.3 because<br>
contributing the feature to upstream GRUB was necessary, requiring the<br>
compilation of both Xen and GRUB from upstream sources on a very up-to-date<br>
distribution. I had to install Arch Linux in a multiboot scenario to<br>
develop and test this feature properly, and physical hardware was needed to<br>
properly test virtualization-related functions.</li>
</ul>
<p>Now in both situations you could argue I should just get another computer<br>
in that instance, or swap hard drives. But that requires purchasing<br>
additional drives and/or computers, and while a world where all developers<br>
have infinite resources, that would be great, but that isn’t the world most<br>
open-source devs live in. It’s within my means to buy another computer or<br>
NVMe drive, but I’d rather not.</p>
<p>It costs us nothing to not go out of our way to break multiboot. It saves<br>
me and others time and money. If we really are worried about multiboot, we<br>
could pop up a warning, but that’s the most I’d be comfortable with.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_9</link>
        <pubDate>Wed, 27 Aug 2025 18:14:07 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3315</guid>
      </item>
      <item>
        <title>Unplugging external drive should trigger a shutdown</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="Patrick" data-post="20" data-topic="994">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/p/b2d939/48.png" class="avatar"> Patrick:</div>
<blockquote>
<p>This feature has been implemented in packages security-misc, helper-scripts and user-sysmaint-split</p>
</blockquote>
</aside>
<p>Should it be added to disro morphs now when you go to upgrade?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unplugging-external-drive-should-trigger-a-shutdown/994?page=2#post_26</link>
        <pubDate>Wed, 27 Aug 2025 18:16:05 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3314</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <p>Thanks for sharing this info I was not aware of this. <code>PrivateNetwork=yes/no</code> looks like a good option for CUPS and others we don’t need network access.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_4</link>
        <pubDate>Wed, 27 Aug 2025 18:13:47 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3313</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <p><a class="mention" href="https://forums.kicksecure.com/u/arraybolt3">@arraybolt3</a><br>
On the USBGuard thread you mentioned CUPS, does systemd support a drop in file? it looks like documentation states it does?</p>
<blockquote>
<p>Along with a unit file foo.service, a “drop-in” directory foo.service.d/ may exist. All files with the suffix “.conf” from this directory will be merged in the alphanumeric order and parsed after the main unit file itself has been parsed. This is useful to alter or add configuration settings for a unit, without having to modify unit files. Each drop-in file must contain appropriate section headers. For instantiated units, this logic will first look for the instance “.d/” subdirectory (e.g. “foo@bar.service.d/”) and read its “.conf” files, followed by the template “.d/” subdirectory (e.g. “foo@.service.d/”) and the “.conf” files there. Moreover, for unit names containing dashes (“-”), the set of directories generated by repeatedly truncating the unit name after all dashes is searched too. Specifically, for a unit name foo-bar-baz.service not only the regular drop-in directory foo-bar-baz.service.d/ is searched but also both foo-bar-.service.d/ and foo-.service.d/. This is useful for defining common drop-ins for a set of related units, whose names begin with a common prefix. This scheme is particularly useful for mount, automount and slice units, whose systematic naming structure is built around dashes as component separators. Note that equally named drop-in files further down the prefix hierarchy override those further up, i.e. foo-bar-.service.d/10-override.conf overrides foo-.service.d/10-override.conf.</p>
</blockquote>
<blockquote>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.unit.html" class="inline-onebox" rel="noopener nofollow ugc">systemd.unit</a></p>
</blockquote>
<p>Couldn’t we create a CUPS drop in <code>/etc/systemd/system/cups.service.d/hardening.conf</code> that would apply some hardened options that would essentially mitigate:</p>
<blockquote>
<p>WAN / public internet: a remote attacker sends an UDP packet to port 631. No authentication whatsoever.<br>
LAN: a local attacker can spoof zeroconf / mDNS / DNS-SD advertisements (we will talk more about this in the next writeup ) and achieve the same code path leading to RCE.</p>
</blockquote>
<p>I don’t think the package manager would ever touch it either with upgrades to CUPS?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_3</link>
        <pubDate>Wed, 27 Aug 2025 18:12:18 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3312</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>Uses or at least used to use Media Transfer Protocol. Unsure what the risks are here.</p>
</blockquote>
</aside>
<p>Android devices should be blocked by default</p>
<blockquote>
<p>An attacker can manipulate filenames or directory paths sent over MTP to read or write files outside the intended media storage area.<br>
Flaws in the MTP driver’s handling of buffers can lead to crashes or remote code execution if crafted packets trigger invalid memory accesses.<br>
On systems where the MTP service runs with elevated rights, exploiting a driver bug may allow an attacker to gain higher privileges.<br>
Improper validation of MTP commands can expose private media or metadata to a malicious host.</p>
</blockquote>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://nvd.nist.gov/vuln/detail/CVE-2018-16872">
  <header class="source">
      <img src="https://nvd.nist.gov/site-media/images/favicons/favicon-32x32.png" class="site-icon" alt="" width="32" height="32">

      <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-16872" target="_blank" rel="noopener nofollow ugc">nvd.nist.gov</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="https://nvd.nist.gov/vuln/detail/CVE-2018-16872" target="_blank" rel="noopener nofollow ugc">NVD - CVE-2018-16872</a></h3>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox allowlistedgeneric" data-onebox-src="https://nvd.nist.gov/vuln/detail/CVE-2022-36847">
  <header class="source">
      <img src="https://nvd.nist.gov/site-media/images/favicons/favicon-32x32.png" class="site-icon" alt="" width="32" height="32">

      <a href="https://nvd.nist.gov/vuln/detail/CVE-2022-36847" target="_blank" rel="noopener nofollow ugc">nvd.nist.gov</a>
  </header>

  <article class="onebox-body">
    

<h3><a href="https://nvd.nist.gov/vuln/detail/CVE-2022-36847" target="_blank" rel="noopener nofollow ugc">NVD - CVE-2022-36847</a></h3>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>For easy usability and user choice I think a USBGuard element/button part on the sysmaint panel should open the <code>30_security-misc.conf</code> in nano so users can comment or un comment out what they need.</p>
<blockquote>
<p>Consider to allow only 3 and above USB version?</p>
</blockquote>
<p>This is too restrictive and blocking USB 2.0 only devices does not eliminate DMA or the BadUSB exploits. It would simply break a heap of legacy peripherals while giving a false sense of security.<br>
Best defense is allow listing devices by vid/pid (as rejecting devices that have HID), enabled IOMMU enforcement and disabling autorun/auto-mount features which I believe Kicksecure already does right?</p>
<p>Blocking USB 2.0 devices for security is impractical due to their widespread use, despite potential security risks.<br>
USB 3.0 does reduce passive sniffing but both USB 2.0 and USB 3.0 can be used for BadUSB, or DMA based memory corruption.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_18</link>
        <pubDate>Wed, 27 Aug 2025 17:59:29 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3311</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <p>Not trying to get off topic but rndis is kernel driver:</p>
<p><code>find /lib/modules/$(uname -r) -type f -name '*.ko*' | grep -E 'rndis'</code></p>
<pre><code class="lang-auto">/lib/modules/6.1.0-38-amd64/kernel/drivers/net/usb/rndis_host.ko
/lib/modules/6.1.0-38-amd64/kernel/drivers/net/wireless/rndis_wlan.ko
/lib/modules/6.1.0-38-amd64/kernel/drivers/usb/gadget/function/usb_f_rndis.ko
</code></pre>
<p>On the topic of USB WiFI (rndis_wlan) I want to put in my voice here I dont think we should block USB WiFi adapters only USB WiFi devices with HID if that’s possible.<br>
I dont know of Adapters that use <code>rndis_wlan</code> and think it would have to look into this like <a class="mention" href="https://forums.kicksecure.com/u/nth9r6">@NTH9R6</a> mentioned like USB Ethernet adapters on whats common on the market.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_17</link>
        <pubDate>Wed, 27 Aug 2025 17:56:39 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3310</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Quiksilver]]></dc:creator>
        <description><![CDATA[ <p>Disabled USB joysticks?</p>
<p>That would be good to to promote nofap among Kicksecure users lol</p>
<p>Joking aside I think Kicksecure should reject USB Webcams honestly and agree with <a class="mention" href="https://forums.kicksecure.com/u/desi_fubu">@desi_fubu</a> in relation to Keytap2. While also realistically agreeing with what <a class="mention" href="https://forums.kicksecure.com/u/arraybolt3">@arraybolt3</a> about how if they want to get your keystrokes an attacker would try to go with installing a software keylogger on your system as it’s less work. However since AI is becoming more and more relevant I can see Keytap2 based malware or attacks as a probability in the future.</p>
<p>The only thing is modeprobe also doesn’t disable the driver uvcvideo so if you were to you need to un comment that part in the conf also.</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/Kicksecure/security-misc/blob/master/etc/modprobe.d/30_security-misc_disable.conf#L294-L297">
  <header class="source">

      <a href="https://github.com/Kicksecure/security-misc/blob/master/etc/modprobe.d/30_security-misc_disable.conf#L294-L297" target="_blank" rel="noopener nofollow ugc">github.com/Kicksecure/security-misc</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/Kicksecure/security-misc/blob/master/etc/modprobe.d/30_security-misc_disable.conf#L294-L297" target="_blank" rel="noopener nofollow ugc">etc/modprobe.d/30_security-misc_disable.conf</a></h4>

<div class="git-blob-info">
  <a href="https://github.com/Kicksecure/security-misc/blob/master/etc/modprobe.d/30_security-misc_disable.conf#L294-L297" rel="noopener nofollow ugc"><code>master</code></a>
</div>



    <pre class="onebox"><code class="lang-conf">
      <ol class="start lines" start="294" style="counter-reset: li-counter 293 ;">
          <li>## USB Video Device Class:</li>
          <li>## Disables the USB-based video streaming driver for devices like some webcams and digital camcorders.</li>
          <li>##</li>
          <li>#install uvcvideo /usr/bin/disabled-miscellaneous-by-security-misc</li>
      </ol>
    </code></pre>



  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>I really like the addition of USBGuard I think it will bolster and draw more users in to Kicksecure.</p>
<p>While the current rules look like they will broadly cover rejecting device with HID interfaces. Would it be good to block specific vendor ids that are used for such products like rubber ducky and other hacker sold products?</p>
<p><a href="https://forums.hak5.org/topic/16696-version-1-usb-vendor-idproduct-id/" class="onebox" target="_blank" rel="noopener nofollow ugc">https://forums.hak5.org/topic/16696-version-1-usb-vendor-idproduct-id/</a></p>
<p>USB vendor ID that OpenMoko released (0x1D50) has become a popular building HID keyboard emulator style rubber ducky projects:</p>
<aside class="onebox githubblob" data-onebox-src="https://github.com/openmoko/openmoko-usb-oui/blob/master/usb_product_ids.psv">
  <header class="source">

      <a href="https://github.com/openmoko/openmoko-usb-oui/blob/master/usb_product_ids.psv" target="_blank" rel="noopener nofollow ugc">github.com/openmoko/openmoko-usb-oui</a>
  </header>

  <article class="onebox-body">
    <h4><a href="https://github.com/openmoko/openmoko-usb-oui/blob/master/usb_product_ids.psv" target="_blank" rel="noopener nofollow ugc">usb_product_ids.psv</a></h4>

<div class="git-blob-info">
  <a href="https://github.com/openmoko/openmoko-usb-oui/blob/master/usb_product_ids.psv" rel="noopener nofollow ugc"><code>master</code></a>
</div>


      <pre><code class="lang-psv">Vendor ID | Product ID | Description
0x1d50 | 0x1db5 | [http://www.almesberger.net/misc/idbg/ IDBG] in DFU mode
0x1d50 | 0x1db6 | [http://www.almesberger.net/misc/idbg/ IDBG] in normal mode
0x1d50 | 0x4xxx | Reserved for the [http://osmocom.org/ Osmocom] project
0x1457 / 0x1d50 | 0x5117 | Neo1973/FreeRunner kernel usbnet (g_ether, CDC Ethernet) Mode
0x1457 / 0x1d50 | 0x5118 | Debug Board (FT2232D) for Neo1973/FreeRunner
0x1457 / 0x1d50 | 0x5119 | Neo1973/FreeRunner u-boot usbtty CDC ACM Mode
0x1457 / 0x1d50 | 0x511a | HXD8 u-boot usbtty CDC ACM Mode
0x1457 / 0x1d50 | 0x511b | SMDK2440 u-boot usbtty CDC ACM mode
0x1457 / 0x1d50 | 0x511c | SMDK2443 u-boot usbtty CDC ACM mode
0x1457 / 0x1d50 | 0x511d | QT2410 u-boot usbtty CDC ACM mode
0x1457 / 0x1d50 | 0x511e | Reserved
0x1457 / 0x1d50 | 0x511f | Reserved
0x1457 / 0x1d50 | 0x5120 | Neo1973/FreeRunner u-boot generic serial Mode
0x1457 / 0x1d50 | 0x5121 | Neo1973/FreeRunner kernel mass storage (g_storage) Mode
0x1457 / 0x1d50 | 0x5122 | Neo1973/FreeRunner kernel usbnet (g_ether, RNDIS) Mode
0x1457 / 0x1d50 | 0x5123 | Neo1973/FreeRunner internal USB Bluetooth CSR4 module
0x1457 / 0x1d50 | 0x5124 | Neo1973/FreeRunner Bluetooth Device ID service
0x1457 / 0x1d50 | 0x5125 | TBD *R!*
0x1457 / 0x1d50 | 0x5126 | TBD *R!*
</code></pre>



  This file has been truncated. <a href="https://github.com/openmoko/openmoko-usb-oui/blob/master/usb_product_ids.psv" target="_blank" rel="noopener nofollow ugc">show original</a>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>Another one that comes up is the vendor <em>Amtel</em> when it comes to “Rubber Ducky” type clones.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_16</link>
        <pubDate>Wed, 27 Aug 2025 17:45:28 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3309</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>Some discussion here:</p><aside class="onebox githubcommit" data-onebox-src="https://github.com/Kicksecure/security-misc/commit/cba16879eff9d3d998c127e41c38d2067cdf04cc#r164468290">
  <header class="source">

      <a href="https://github.com/Kicksecure/security-misc/commit/cba16879eff9d3d998c127e41c38d2067cdf04cc#r164468290" target="_blank" rel="noopener">github.com/Kicksecure/security-misc</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Commit">
    <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M10.86 7c-.45-1.72-2-3-3.86-3-1.86 0-3.41 1.28-3.86 3H0v2h3.14c.45 1.72 2 3 3.86 3 1.86 0 3.41-1.28 3.86-3H14V7h-3.14zM7 10.2c-1.22 0-2.2-.98-2.2-2.2 0-1.22.98-2.2 2.2-2.2 1.22 0 2.2.98 2.2 2.2 0 1.22-.98 2.2-2.2 2.2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/Kicksecure/security-misc/commit/cba16879eff9d3d998c127e41c38d2067cdf04cc" target="_blank" rel="noopener">Polish USBGuard configuration</a>
    </h4>

    <div class="github-info">
      <div class="date">
        committed <span class="discourse-local-date" data-format="ll" data-date="2025-08-15" data-time="22:16:42" data-timezone="UTC">10:16PM - 15 Aug 25 UTC</span>
      </div>

      <div class="user">
        <a href="https://github.com/ArrayBolt3" target="_blank" rel="noopener">
          <img alt="" src="https://avatars.githubusercontent.com/u/104878738?v=4" class="onebox-avatar-inline" width="20" height="20">
          ArrayBolt3
        </a>
      </div>

      <div class="lines" title="changed 2 files with 26 additions and 18 deletions">
        <a href="https://github.com/Kicksecure/security-misc/commit/cba16879eff9d3d998c127e41c38d2067cdf04cc" target="_blank" rel="noopener">
          <span class="added">+26</span>
          <span class="removed">-18</span>
        </a>
      </div>
    </div>
  </div>
</div>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
 ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_15</link>
        <pubDate>Wed, 27 Aug 2025 17:36:46 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3308</guid>
      </item>
      <item>
        <title>ISO - Development</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>Kicksecure 18 and above (based on Debian 13 / trixie) will be even better.</p>
<p>Calamares installer can run as <code>root</code> without <code>Xwayland</code>, yet has a functional graphical user interface (GUI).</p>
<p>(According to <a class="mention" href="https://forums.kicksecure.com/u/arraybolt3">@arraybolt3</a> who tested that.)</p>
<p>As for tickets about calamares running without root (rootless), i.e. splitting the frontend graphical user interface (GUI from the backend command line interface (CLI):</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://codeberg.org/Calamares/calamares/issues/2268">
  <header class="source">
      <img src="https://codeberg.org/assets/img/favicon.svg" class="site-icon" alt="" width="16" height="16">

      <a href="https://codeberg.org/Calamares/calamares/issues/2268" target="_blank" rel="noopener">Codeberg.org</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/344;"><img src="https://codeberg.org/Calamares/calamares/issues/2268/summary-card" class="thumbnail" alt="" width="690" height="345"></div>

<h3><a href="https://codeberg.org/Calamares/calamares/issues/2268" target="_blank" rel="noopener">Rootless Calamares, native Wayland support without Xwayland</a></h3>

  <p>If calamares is started without root rights, it shows:

&gt; the installer is not running with administrative rights

Quote Jan 4, 2018 https://calamares.io/calamares-3.2-plan-revised/

&gt; Rootless Calamares (e.g. not running as root) has not been...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p> → </p>
<blockquote>
<p>This is, admittedly, a non-obvious place for it.</p>
</blockquote>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://codeberg.org/Calamares/calamares/issues/1294">
  <header class="source">
      <img src="https://codeberg.org/assets/img/favicon.svg" class="site-icon" alt="" width="16" height="16">

      <a href="https://codeberg.org/Calamares/calamares/issues/1294" target="_blank" rel="noopener">Codeberg.org</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/344;"><img src="https://codeberg.org/Calamares/calamares/issues/1294/summary-card" class="thumbnail" alt="" width="690" height="345"></div>

<h3><a href="https://codeberg.org/Calamares/calamares/issues/1294" target="_blank" rel="noopener">Accessibility issue with Orca screen reader</a></h3>

  <p>Dear C++ specialists,
As I have read, you are using Qt5.9. Please would you have some time to analyse yours source code and other program parts if you have set all stuff so resulting GUI of this installer will be accessible?
Many visually impaired...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
 ]]></description>
        <link>https://forums.kicksecure.com/t/iso-development/371#post_12</link>
        <pubDate>Wed, 27 Aug 2025 15:25:59 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3307</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@nurmagoz]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="9" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>But at the same time, <em>lots</em> of devices are USB 2 only (I don’t think I’ve seen a USB 3 keyboard in my life), so this would probably break way too much. If we were to offer it, it should be something that is opt-in, not opt-out, in my opinion.</p>
</blockquote>
</aside>
<p>Keyboard with USB 3.0: search Kensington K72357FR. But yeah would be nice to have the ability to disable old/backward compatibility as an option for the users.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_14</link>
        <pubDate>Wed, 27 Aug 2025 10:25:27 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3306</guid>
      </item>
      <item>
        <title>Question about grub-live and writable file system</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="9" data-topic="1221">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>it will have to wait until Kicksecure 18, but there’s a known fix now.</p>
</blockquote>
</aside>
<p>Yes.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/question-about-grub-live-and-writable-file-system/1221#post_12</link>
        <pubDate>Wed, 27 Aug 2025 08:44:56 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3304</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>The problem is that <a href="https://github.com/Kicksecure/tb-updater/blob/master/usr/libexec/tb-updater/dispvm"><code>/usr/libexec/tb-updater/dispvm</code></a> does not support yet Mullvad Browser at time of writing.</p>
<p>Instead of only considering folder <code>.tb</code> it would require a loop to also consider folder <code>.mullvadbrowser</code>.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_6</link>
        <pubDate>Wed, 27 Aug 2025 07:50:08 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3303</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@cough]]></dc:creator>
        <description><![CDATA[ <p>Thanks for response but I already tried to create a desktop file like that. When you launch in a disposable you get this error:</p>
<pre data-code-wrap="bash"><code class="lang-bash">Mullvad Browser is currently not installed. 
(Folder /home/user/.mullvadbrowser/mullvad-browser does not exist.)
Start Mullvad Browser Downloader (by Kicksecure developers)?
</code></pre>
<p>You need to launch in the appvm (disposable) template first where it links from /var/cache/tb-binary to $HOME. And when updating it becomes a pain because you also always have to launch the appvm first.</p>
<p>Currently I just copy at startup from /var/cache to $HOME and use the “normal” desktop file that looks like this</p>
<pre><code class="lang-auto">[Desktop Entry]
Type=Application
Name=Mullvad Browser
GenericName=Web Browser
Comment=Mullvad Browser  is +1 for privacy and −1 for mass surveillance
Categories=Network;WebBrowser;Security;
Exec=sh -c '"/home/user/.mullvadbrowser/mullvad-browser/Browser/start-mullvad-browser" || ([ !  -x "/home/user/.mullvadbrowser/mullvad-browser/Browser/start-mullvad-browser" ] &amp;&amp; "$(dirname "$*")"/Browser/start-mullvad-browser)' dummy %k
X-MullvadBrowser-ExecShell=./Browser/start-mullvad-browser --detach
Icon=/home/user/.mullvadbrowser/mullvad-browser/Browser/browser/chrome/icons/default/default128.png
StartupNotify=true
StartupWMClass=Mullvad Browser

</code></pre>
<p>I guess that kinda makes a unique fingerprint?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_5</link>
        <pubDate>Tue, 26 Aug 2025 22:30:45 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3302</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>Mullvad Browser Downloader by Kicksecure developers doesn’t create a <code>.desktop</code> file at time of writing (yet) at time of writing indeed.</p>
<p>I added a new chapter just now on how to create a <code>.desktop</code> file.</p>
<aside class="onebox allowlistedgeneric" data-onebox-src="https://www.kicksecure.com/wiki/Mullvad_Browser">
  <header class="source">
      <img src="https://www.kicksecure.com/favicon.svg?hsversion-headscript-replacement-by-server=1&amp;hsversion_from_server_replacement_unixtime=1756200625" class="site-icon" alt="" width="151" height="151">

      <a href="https://www.kicksecure.com/wiki/Mullvad_Browser" target="_blank" rel="noopener" title="05:24PM - 26 August 2025">Kicksecure – 26 Aug 25</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/387;"><img src="https://www.kicksecure.com/w/images/5/51/Kicksecure-image-twitter-post.jpg?version=30a0ad75271a4836786771c345c960b8" class="thumbnail" alt="" width="690" height="388"></div>

<h3><a href="https://www.kicksecure.com/wiki/Mullvad_Browser" target="_blank" rel="noopener">Mullvad Browser</a></h3>

  <p>How to install Mullvad Browser in Kicksecure.</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<p>We’re not yet on Qubes R4.3 yet either. Still on R4.2 at time of writing.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_4</link>
        <pubDate>Tue, 26 Aug 2025 17:48:30 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3301</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@cough]]></dc:creator>
        <description><![CDATA[ <p>I installed kicksecure using the community template in qubes.</p>
<p>And installed the mullvadbrowser with tb-updater</p>
<p>I never knew about browser-choice will try it</p>
<p>EDIT: Can’t use it I am not on 4.3 yet</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_3</link>
        <pubDate>Tue, 26 Aug 2025 10:35:28 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3299</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group quote-modified" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<blockquote>
<p>Webcams</p>
</blockquote>
<p><a href="https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html">https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html</a></p>
</blockquote>
</aside>
<p>I am not sure this is something we can address in context of the threat model of USBGuard.</p>
<p>It is not an issue specific to webcams. We need to read the original source, not the news report. From the original report…</p>
<p>Quote <a href="https://eclypsium.com/blog/badcam-now-weaponizing-linux-webcams/" class="inline-onebox">BadCam: Turning Linux Webcams Into BadUSB Attack Tools - Eclypsium | Supply Chain Security for the Modern Enterprise</a></p>
<blockquote>
<ul>
<li>Two attack paths are possible: 1) An attacker can send someone a backdoored webcam (or, with physical access, attach a weaponized webcam to a computer) or 2) remotely compromise a computer and infect the Linux-based webcam to perform attacks.</li>
</ul>
</blockquote>
<p>There is nothing very specific about webcams in this report. Yes, it happened with a webcam. But it could also been a different class of devices.</p>
<p>For instance, the firmware of a hard drive has also been compromised. See <a href="https://www.kicksecure.com/wiki/Backdoor#Hard_Drive_Firmware_Trojan">Hard Drive Firmware Trojan</a>.</p>
<p>eclypsium is providing a nice illustrative image <a href="https://eclypsium.com/wp-content/uploads/badcam-diagram.png">badcam-diagram.png</a>. Their first step starts with “initial compromise”.</p>
<blockquote>
<p>attacker gains remote access to victim’s PC through phising, malware or software exploit</p>
</blockquote>
<p>They then discover a vulnerable device, that supports firmware update but does not verify firmware signature (webcam) and then starts abusing that device.</p>
<p>The threat model of USBGuard is a different one: The PC is not compromised and an attacker attaches a malicious USB device such as a USB Rubber Ducky.</p>
<hr>
<p><a href="https://github.com/Kicksecure/security-misc?tab=readme-ov-file#bluetooth-hardening">Bluetooth Hardening</a></p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_13</link>
        <pubDate>Tue, 26 Aug 2025 08:04:32 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3298</guid>
      </item>
      <item>
        <title>NetworkManager: Disable automatic connection to wired networks?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>I don’t know if wired connections get notifications or not, my “network” (alright, it’s a cellular hotspot with some laptops connected to it) is purely wireless so I don’t really work with wired connections much. I would kind of hope NetworkManager would allow “trust on first use” with wired networks if at all possible though, similar to how it treats WiFi. Then you could explicitly connect the first time but not subsequent times, thus avoiding things like a USB device pretending to be Ethernet in order to hack things.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/networkmanager-disable-automatic-connection-to-wired-networks/1260#post_3</link>
        <pubDate>Tue, 26 Aug 2025 03:49:53 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3297</guid>
      </item>
      <item>
        <title>Protecting the Kernel Command Line</title>
        <dc:creator><![CDATA[@NTH9R6]]></dc:creator>
        <description><![CDATA[ <p>I was not aware of “Sovereign Boot” sounds much needed since UEFI is literally the devil</p> ]]></description>
        <link>https://forums.kicksecure.com/t/protecting-the-kernel-command-line/1251#post_2</link>
        <pubDate>Tue, 26 Aug 2025 03:47:48 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3296</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="NTH9R6" data-post="10" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>Is this correct for the classifications?</p>
</blockquote>
</aside>
<p>That looks correct to me at first glance.</p>
<aside class="quote no-group" data-username="NTH9R6" data-post="10" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>If so is this format correct and would it only block RNDIS based devices such as Ethernet USB adapters?</p>
</blockquote>
</aside>
<p>I don’t think the <code>0x</code> at the start of <code>0xef</code> is correct, and <code>with-interface-type</code> should just be <code>with-interface</code> according to <a href="https://usbguard.github.io/documentation/rule-language" class="inline-onebox" rel="noopener nofollow ugc">Rule Language | USBGuard</a>. You’d probably want:</p>
<pre><code class="lang-auto">reject with-interface ef:04:01
</code></pre>
<p>Or, better yet since RNDIS in general is dangerous I believe:</p>
<pre><code class="lang-auto">reject with-interface ef:04:*
</code></pre>
<p>(Or should that be <code>reject with-interface one-of { ef:04:* }</code>? The documentation doesn’t make it entirely clear to me…)</p>
<aside class="quote no-group" data-username="NTH9R6" data-post="10" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>Well does that mean that adapters aimed at cross‑platform use (Linux/macOS, embedded boards, Android) often implement CDC‑ECM or vendor‑specific classes instead of RNDIS?<br>
Is it safe to say that the standard is CDC‑ECM in most Ethernet USB adapters rather then RDNIS?</p>
</blockquote>
</aside>
<p>I have no idea. I know Linux has supported RNDIS for a while and that every Android device I’ve ever tethered to uses it for USB Ethernet.</p>
<aside class="quote no-group" data-username="NTH9R6" data-post="10" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>However I also read this though from 2023 so I dont know?</p>
</blockquote>
</aside>
<p>This is about using USB Ethernet adapters <em>on</em> Android. I’m talking about Android phones presenting themselves as Ethernet devices to laptops (this weird-sounding feature is called USB tethering). That’s what uses RNDIS all the times I’ve seen.</p>
<aside class="quote no-group" data-username="NTH9R6" data-post="11" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/b2d939/48.png" class="avatar"> NTH9R6:</div>
<blockquote>
<p>Couldn’t you just harden CUPS to disable remote printing and turn off printer sharing among other hardening or you talking the CUPS service in general?</p>
</blockquote>
</aside>
<p>Hardening CUPS might be possible, but I don’t know how much I trust it. I linked an article by a security research about CUPS above, he has an <em>extremely</em> low opinion of it, and given that he just woke up one day, decided to hunt for a CVE in CUPS, and was rewarded with a severity 9.9 CVE after a couple days of research, I’d argue his opinion is probably well-supported.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_12</link>
        <pubDate>Tue, 26 Aug 2025 03:44:42 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3295</guid>
      </item>
      <item>
        <title>NetworkManager: Disable automatic connection to wired networks?</title>
        <dc:creator><![CDATA[@NTH9R6]]></dc:creator>
        <description><![CDATA[ <p>Let me ask you this though if you set it to manual connection for NetworkManager or what ever equivalent setting. Would a device that is already wired in before the machine starts still require manual connecting or would it get loaded. Honestly I would find it annoying if I plugged in ethernet to my device to my router then booted up my system to then have to manual connect. You would have to see test this to see how that works.</p>
<p>Besides <code>xfce4-notifyd</code> or whatever the desktop nofication popup for telling you wifi networks available I don’t think it will notify that a new wired is available?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/networkmanager-disable-automatic-connection-to-wired-networks/1260#post_2</link>
        <pubDate>Tue, 26 Aug 2025 03:37:17 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3294</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@NTH9R6]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="7" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>RNDIS aside, one could argue that if a device presented itself as something normal <em>and</em> a USB Ethernet device, that could be used to mount an attack against running services on the system. Assuming Kicksecure has no open ports by default (I wouldn’t expect it to, but haven’t actually checked), this probably isn’t much of a concern, but if someone’s running something like CUPS on their machine, LAN access to the machine could be enough to take it over completely</p>
</blockquote>
</aside>
<p>Couldn’t you just harden CUPS to disable remote printing and turn off printer sharing among other hardening or you talking the CUPS service in general?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_11</link>
        <pubDate>Tue, 26 Aug 2025 03:25:13 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3293</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@NTH9R6]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="7" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>There are other USB Ethernet protocols besides RNDIS, I don’t have as much of a problem with the protocols there</p>
</blockquote>
</aside>
<p>Ok, so I wanted to chime in on this discussion. I saw this and it made me do some digging into this.<br>
Is this correct for the classifications?</p>
<blockquote>
<p><a href="https://www.usb.org/defined-class-codes#anchor_BaseClassEFh" class="inline-onebox" rel="noopener nofollow ugc">Defined Class Codes | USB-IF</a></p>
</blockquote>
<pre><code class="lang-auto">    USB‑IF class  0xEF (Miscellaneous)
    Subclass    0x04 (RNDIS)
    Protocol    0x01 (RNDIS‑over‑Ethernet)
</code></pre>
<p>If so is this format correct and would it only block RNDIS based devices such as Ethernet USB adapters?</p>
<pre><code class="lang-auto"># Block any USB device that advertises the RNDIS Ethernet interface
reject with-interface-type 0xef:04:01
</code></pre>
<p>Or would you need a wildcard if the device has its interface not as interface <span class="hashtag-raw">#0</span> or presents the class/subclass further down the descriptor?<br>
<code>reject interface all-of { 0xef 0x04 0x01 }</code></p>
<p><strong>How common is RNDIS for USB‑Ethernet adapters?</strong></p>
<p>Wikipedia states RNDIS is “a Microsoft proprietary protocol used mostly on top of USB”. What I also read is that inexpensive adapters sold for Windows PCs expose the RNDIS class because Windows already includes a built‑in RNDIS driver, making the device “plug and play”.</p>
<p>Well does that mean that adapters aimed at cross‑platform use (Linux/macOS, embedded boards, Android) often implement CDC‑ECM or vendor‑specific classes instead of RNDIS?<br>
Is it safe to say that the standard is CDC‑ECM in most Ethernet USB adapters rather then RDNIS?</p>
<blockquote>
<p><a href="https://old.reddit.com/r/embedded/comments/aeqxbl/which_usbethernet_standard_should_i_implement/edrrd03/" rel="noopener nofollow ugc">https://old.reddit.com/r/embedded/comments/aeqxbl/which_usbethernet_standard_should_i_implement/edrrd03/</a></p>
</blockquote>
<p>However I also read this though from 2023 so I dont know?</p>
<blockquote>
<p><a href="https://jordemort.dev/blog/why-android-cant-use-cdc-ethernet/" class="inline-onebox" rel="noopener nofollow ugc">Why Android can't use CDC Ethernet</a></p>
</blockquote>
<p>You would need see what the standard that is found commonly on the market? My guess is in cheap Chinese brands or adapters use RDNIS?</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_10</link>
        <pubDate>Tue, 26 Aug 2025 03:23:23 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3292</guid>
      </item>
      <item>
        <title>NetworkManager: Disable automatic connection to wired networks?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>Random idea that hit me while writing <a href="https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248/7:">https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248/7:</a> one potential threat vector for USB devices is if they provide a virtual Ethernet interface. This would allow the device to attack arbitrary services with open ports on the host. A firewall would help here (maybe, depends on whether it blocked the LAN or not), but what might help even more is if NetworkManager didn’t automatically connect the system to any wired network interfaces it sees.</p>
<p>Would it be desirable to turn off this wired autoconnect feature by default? Users could still use wired networks, they would just have to explicitly connect to them using the network management widget.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/networkmanager-disable-automatic-connection-to-wired-networks/1260#post_1</link>
        <pubDate>Tue, 26 Aug 2025 03:20:15 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3291</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="nurmagoz" data-post="3" data-topic="1249">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>We should not have a single concern about what xyz wants to have on his laptop. Our concern is to deliver the best security possible for the end user while he’s using our OS/products. If something doesn’t work unless you allow insecurities, it is unsupported.</p>
</blockquote>
</aside>
<p>In general I understand this sentiment, but in practice these kinds of capabilities are needed to develop Kicksecure itself. It’s difficult to say “XYZ should not be supported on Kicksecure” when Kicksecure depends somewhat on XYZ to exist.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="3" data-topic="1249">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>The user is going to need to play with those on bare metal VM or emulator. Or buy insecure, testing purpose hardware (secure OS/hardware doesn’t support this).</p>
</blockquote>
</aside>
<p>Neither is an option for many Kicksecure development workflows because the developer must test specifically how the OS behaves on specific physical hardware platforms. Virtualization isn’t useful here. For example, <code>emerg-shutdown</code>, which is intended to be a component of Kicksecure 18, was triggering a bug that caused physical hardware with an Intel GPU to panic rather than shutting down when the emergency condition was triggered. This didn’t occur in a VM because the VM did not have an Intel GPU. Being able to discover and fix this bug is a vital part of why <code>emerg-shutdown</code> will actually be usable once development is finished.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_7</link>
        <pubDate>Tue, 26 Aug 2025 02:27:09 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3290</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>I don’t think we harden specific “third-party” services yet, but we definitely use these kinds of things for applicable services in Kicksecure and Whonix. See <a href="https://github.com/Kicksecure/sdwdate/blob/master/usr/lib/systemd/system/sdwdate.service" class="inline-onebox" rel="noopener nofollow ugc">sdwdate/usr/lib/systemd/system/sdwdate.service at master · Kicksecure/sdwdate · GitHub</a> for instance, there’s a whole battery of hardening options enabled here, including a syscall filter.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_2</link>
        <pubDate>Tue, 26 Aug 2025 02:21:16 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3289</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="nurmagoz" data-post="3" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>USB to VGA?</p>
</blockquote>
</aside>
<p>This requires third-party kernel drivers (DisplayLink), so it would be a pain to get this sort of thing to work anyway. I don’t see a problem with leaving this disabled by default.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="3" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>USB joysticks?</p>
</blockquote>
</aside>
<p>Agreed, leave disabled by default.</p>
<aside class="quote no-group" data-username="nurmagoz" data-post="3" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/n/8e7dd6/48.png" class="avatar"> nurmagoz:</div>
<blockquote>
<p>Consider to allow only 3 and above USB version?</p>
</blockquote>
</aside>
<p>Not sure if this even can be done with USBGuard, but it’s an interesting question to think about. USB 2, as I understand it, simulcasts data packets to <em>all</em> USB 2 ports on the system, then expects devices to ignore packets that aren’t addressed to them. This allows passively stealing data from the system by logging packets that weren’t addressed to the logging device. USB 3 only sends data to the individual devices it is intended for, thus this potentially reduces risk a bit. But at the same time, <em>lots</em> of devices are USB 2 only (I don’t think I’ve seen a USB 3 keyboard in my life), so this would probably break way too much. If we were to offer it, it should be something that is opt-in, not opt-out, in my opinion.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_9</link>
        <pubDate>Tue, 26 Aug 2025 02:18:51 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3288</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="MetalMoxie" data-post="6" data-topic="1248" data-full="true">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/m/51bf81/48.png" class="avatar"> MetalMoxie:</div>
<blockquote>
<p>Allow us to chose just like with the web browsers.</p>
</blockquote>
</aside>
<p>Agreed. If users can’t choose what to use or not use on their own systems, something is badly wrong. We’re discussing what to allow or disallow <em>by default</em>, the user will have free reign to override the defaults however they want.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_8</link>
        <pubDate>Tue, 26 Aug 2025 02:02:07 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3287</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p><a href="https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html" rel="noopener nofollow ugc">https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html</a></p>
</blockquote>
</aside>
<p>I’m not really concerned about this because:</p>
<ul>
<li>You have to compromise the system to overwrite the camera’s firmware and turn it malicious. By the time you’ve compromised the system enough to do that, it’s already “game over”.</li>
<li>The camera has to present itself as a keyboard device in order to attack the system. If the camera is plugged into the system after boot, USBGuard will see one of two things, depending on how the camera presents itself:
<ul>
<li>Either, it will see a camera and a keyboard together, and will thus reject the camera because it combines a human interface device with some other device.</li>
<li>Or, it will see just a keyboard, in which case if the user has any other USB keyboard already attached, it will reject the keyboard. (If the user doesn’t have a USB keyboard already attached, then it’s “game over”, but if the camera is <em>only</em> presenting itself as a keyboard and not as a camera, it would be able to evade even the current highly strict settings.</li>
</ul>
</li>
<li>If the camera is already plugged into the system at bootup, then it’s “game over”, but again, that would be the case even with the current highly strict settings, and if an attacker is able to compromise a system enough to flash a camera with non-standard firmware, they can probably also control USBGuard and allow the camera to be used so it can be attacked.
<ul>
<li>A counter-argument to this is that USBGuard makes an attacker have to take one more step to attack the camera (maybe - does this exploit work even if the system doesn’t the camera? It probably doesn’t…), and that one more step may be enough to thwart an attacker that doesn’t know they need to take that step.</li>
</ul>
</li>
</ul>
<aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p>Same as webcams they can be used to record passwords and text via acoustic keyboard eavesdropping with tools like <a href="https://github.com/ggerganov/kbd-audio" rel="noopener nofollow ugc">Keytap2</a>. The best thing if someone was concerned would be to unplug these ribbon cables from their computer or de-solder them if its a newer (landfill device) where everything is soldered in.</p>
</blockquote>
</aside>
<p>I’m not sure how I see how this applies to the threat model USBGuard is intended to help with - Keytap-style attacks require either compromising the user’s computer (in which case, why bother with Keytap, just install a keylogger and be done), or requires the attacker to be able to place their own microphone physically close to the victim (in which case the victim’s computer isn’t the one the microphone is plugged into).</p>
<aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p>Arduinos can indeed be used as MIDI interfaces and are used in hacking peripheral devices</p>
</blockquote>
</aside>
<p>I don’t really understand how that would work but it sounds neat, maybe you can share a link?</p>
<aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p>No brainer here Bluetooth is unsafe</p>
</blockquote>
</aside>
<p>I don’t think it’s quite that cut-and-dried, but I agree in general that individual Bluetooth devices can have questionable security (as is true with wireless devices in general sadly) and I would not rely on them in a high-risk situation. That being said, I personally use a Bluetooth mouse and keyboard with my workstation, but I also don’t have a threat model that includes nearby skilled attackers with radio equipment.</p>
<aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p>I don’t get it considering there’s good amount of people that use them to get around Intel ME. Many people including myself would remove the WiFi card and us an external Ethernet USB Adapter as a mitigation technique.</p>
</blockquote>
</aside>
<p>I’m not referencing the idea of USB Ethernet <em>in general</em> when calling it very high-risk, though I do consider it a risk as I’ll explain in a bit. The main problem with USB Ethernet is the implementation - RNDIS (which is used for most Android USB tethering sadly) reportedly has serious protocol-level vulnerabilities, so bad that the kernel maintainer who is arguably second-in-command to Linux Torvalds has tried to remove support for the protocol from Linux entirely, three times. He hasn’t shared <em>what</em> the vulnerabilities are yet, but I think he probably knows what he’s talking about and wouldn’t try to do this if the protocol wasn’t legitimately unsafe. There are other USB Ethernet protocols besides RNDIS, I don’t have as much of a problem with the protocols there.</p>
<p>RNDIS aside, one could argue that if a device presented itself as something normal <em>and</em> a USB Ethernet device, that could be used to mount an attack against running services on the system. Assuming Kicksecure has no open ports by default (I wouldn’t expect it to, but haven’t actually checked), this probably isn’t much of a concern, but if someone’s running something like CUPS on their machine, LAN access to the machine could be enough to take it over completely, if one security researcher is to be believed. See the link about CUPS vulnerabilities in the original post. A device could present itself as USB Ethernet to gain LAN access to the machine, assuming the machine automatically connected to the “network” presented by the device (I believe NetworkManager does this by default).</p>
<p>I do not deny the very good usability benefits of USB Ethernet, but I think in general it presents a significant attack vector from the standpoint of USB devices mounting attacks against a system. I’d prefer if we documented how users can manually allow USB Ethernet, instead of allowing it in general.</p>
<p>This brings up a potential hardening idea I’ll save for another post, it might be possible to mitigate this risk such that we can allow USB Ethernet by default. (Edit: I filed the post, for those who are interested: <a href="https://forums.kicksecure.com/t/networkmanager-disable-automatic-connection-to-wired-networks/1260" class="inline-onebox">NetworkManager: Disable automatic connection to wired networks?</a></p>
<aside class="quote no-group" data-username="desi_fubu" data-post="5" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/letter_avatar_proxy/v4/letter/d/da6949/48.png" class="avatar"> desi_fubu:</div>
<blockquote>
<p>Malicious USB ethernet devices exist but the general rule of thumb in this manner is don’t buy online and only buy locally from a trusted vendor (brand). Supply chain attack is a real threat but atleast is wouldn’t be targeted to you specifically unlike buying online.</p>
</blockquote>
</aside>
<p>Keep in mind that one threat vector we have to be ready for is a device that looks like one thing to the user but presents itself as something else to the computer. For instance, a malicious pair of USB headphones may present itself to the computer as a USB Ethernet device as well as a USB audio device. Sometimes the malicious device will be one an attacker walks by and plugs in, so the user’s choice of what to buy may not protect them, and the user’s understanding of what they’re plugging into their system may be wrong.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_7</link>
        <pubDate>Tue, 26 Aug 2025 02:00:15 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3286</guid>
      </item>
      <item>
        <title>Systemd Service Hardening?</title>
        <dc:creator><![CDATA[@goose4]]></dc:creator>
        <description><![CDATA[ <p>So I was learning about the options for Systemd services for restricting or in another word “hardening” services.</p>
<p>This made me question does Kicksecure deploy certain hardening for it’s services or certain Kicksecure specific services?</p>
<p>These are some interesting options I will note here:</p>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivateNetwork=" rel="noopener nofollow ugc"><code>PrivateNetwork=yes/no</code></a><br>
Gives the service its own network namespace. It can’t see or use the host’s network interfaces unless you explicitly bind sockets. Seems useful to prevent leaks or prevent services from being ran without networking?</p>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivatePIDs=" rel="noopener nofollow ugc"><code>PrivatePIDs=yes/no</code></a><br>
Gives a service an isolated view of the process table, which is a useful “defense in depth” measure, especially for daemons that don’t need to inspect or manage other system processes.</p>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#PrivateTmp=" rel="noopener nofollow ugc"><code>PrivateTmp=yes/no</code></a><br>
Provides a private /tmp and /var/tmp for the service, isolating it from the host’s temporary directories. One service can’t read temporary files left by another service, which mitigates attacks that rely on guessing or stealing temp‑file names.</p>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#MemoryDenyWriteExecute=" rel="noopener nofollow ugc"><code>MemoryDenyWriteExecute=yes/no</code></a><br>
Remounts parts of the filesystem read‑only (or makes the whole tree read‑only) for the service. (helps mitigate code‑injection attacks).</p>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.exec.html#ProtectSystem=" rel="noopener nofollow ugc"><code>ProtectSystem=full/strict/yes</code></a><br>
Remounts parts of the filesystem read‑only (or makes the whole tree read‑only) for the service.</p>
<p>There is many others but these few caught my eye.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/systemd-service-hardening/1258#post_1</link>
        <pubDate>Tue, 26 Aug 2025 01:47:58 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3284</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>How are you installing Mullvad Browser? If you install it into a template using Mullvad’s deb repository, it should create a desktop file like most other applications and will be updated along with normal template updates. If you install Mullvad Browser using the <code>browser-choice</code> utility in Kicksecure, it will install the deb repository for you, so that’s probably the easiest way to do it. You can launch it from a template by running <code>browser-choice</code> in a terminal.</p>
<p>(Note that there is a wiki page for browser-choice at <a href="https://www.kicksecure.com/wiki/Browser-choice" class="inline-onebox" rel="noopener nofollow ugc">Browser Choice - Browser Selection Installer Dialog</a>, but it is very incomplete. Most of the info about it is in the development planning page at <a href="https://www.kicksecure.com/wiki/Dev/browser-choice#criteria_for_inclusion_into_browser_choice" class="inline-onebox" rel="noopener nofollow ugc">Browser Choice</a> which focuses more on how browser-choice works internally.)</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_2</link>
        <pubDate>Tue, 26 Aug 2025 01:33:04 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3283</guid>
      </item>
      <item>
        <title>How is Mullvad Browser supposed to be used in Qubes</title>
        <dc:creator><![CDATA[@cough]]></dc:creator>
        <description><![CDATA[ <p>There is no .desktop file provided and putting /usr/bin/mulvadbrowser into a .desktop file also does not seem to work properly.</p>
<p>Only usable way is launching it in a terminal first then basing a dispvm on top of that appvm to use the generated .desktop file. But updating like that is a pain.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/how-is-mullvad-browser-supposed-to-be-used-in-qubes/1256#post_1</link>
        <pubDate>Mon, 25 Aug 2025 23:55:24 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3281</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@MetalMoxie]]></dc:creator>
        <description><![CDATA[ <p>Allow us to chose just like with the web browsers.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_6</link>
        <pubDate>Mon, 25 Aug 2025 21:38:40 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3277</guid>
      </item>
      <item>
        <title>Packages Source for App-per-VM</title>
        <dc:creator><![CDATA[@desi_fubu]]></dc:creator>
        <description><![CDATA[ <p>What gets me about Android is how they do per-user storage, not global. I wish Debian’s APT did this but its limited due to the nature of its design.</p>
<p>I tried installing a <code>.deb</code> package locally with dpkg but it will always be system-wide unavoidly.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/packages-source-for-app-per-vm/1167#post_2</link>
        <pubDate>Mon, 25 Aug 2025 21:33:51 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3275</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@desi_fubu]]></dc:creator>
        <description><![CDATA[ <p>should be blocked or not blocked by default?</p>
<blockquote>
<p>Webcams</p>
</blockquote>
<p><a href="https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html" class="onebox" target="_blank" rel="noopener nofollow ugc">https://thehackernews.com/2025/08/linux-based-lenovo-webcams-flaw-can-be.html</a></p>
<blockquote>
<p>Microphones</p>
</blockquote>
<p>Same as webcams they can be used to record passwords and text via acoustic keyboard eavesdropping with tools like <a href="https://github.com/ggerganov/kbd-audio" rel="noopener nofollow ugc">Keytap2</a>. The best thing if someone was concerned would be to unplug these ribbon cables from their computer or de-solder them if its a newer (landfill device) where everything is soldered in.</p>
<blockquote>
<p>MIDI interfaces</p>
</blockquote>
<p>Arduinos can indeed be used as MIDI interfaces and are used in hacking peripheral devices</p>
<blockquote>
<p>Bluetooth dongles</p>
</blockquote>
<p>No brainer here Bluetooth is unsafe</p>
<hr>
<p>Thing I’m conflicted on here.</p>
<blockquote>
<p>USB Ethernet</p>
</blockquote>
<aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>I would consider this very high-risk and would NOT enable it.</p>
</blockquote>
</aside>
<p>I don’t get it considering there’s good amount of people that use them to get around Intel ME. Many people including myself would remove the WiFi card and us an external Ethernet USB Adapter as a mitigation technique.</p>
<blockquote>
<blockquote>
<p>Machines whose AMT version is 6.x (Q57/Q67/C206 chipsets, 2010-2011 (early 2012) Core i3/i5/i7) have ME that can talk only through the NIC that is soldered to the board, no external NIC will ever be visible to the ME.</p>
</blockquote>
</blockquote>
<p>It’s even debatable if it can communicate on newer device through an adapter in my opinion.</p>
<p>Not to mention people that only want wired many newer (landfill devices) computers require you to buy an USB adapter since they don’t seem to have them on boards anymore (laptops).</p>
<p>On the other hand external peripheral devices are generally no allowed by organizations and corporate companies due to attack vector with the exceptions of mouse and keyboard. Malicious USB ethernet devices exist but the general rule of thumb in this manner is don’t buy online and only buy locally from a trusted vendor (brand). Supply chain attack is a real threat but atleast is wouldn’t be targeted to you specifically unlike buying online.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_5</link>
        <pubDate>Mon, 25 Aug 2025 21:17:14 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3273</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>related:</p>
<aside class="onebox discoursetopic" data-onebox-src="https://forums.whonix.org/t/usbguard-on-kicksecure-to-prevent-hardware-keyloggers-badusb/11988">
  <header class="source">
      <img src="https://forums.whonix.org/uploads/default/optimized/2X/3/37fe81e592143b0c01c9656c44069b4bfdd3990e_2_32x32.ico" class="site-icon" alt="" width="32" height="32">

      <a href="https://forums.whonix.org/t/usbguard-on-kicksecure-to-prevent-hardware-keyloggers-badusb/11988" target="_blank" rel="noopener" title="05:04PM - 22 July 2021">Whonix Forum – 22 Jul 21</a>
  </header>

  <article class="onebox-body">
    <div class="aspect-image" style="--aspect-ratio:690/255;"><img src="https://forums.whonix.org/uploads/default/original/2X/5/5ac973ff4302e69269667e09e67d850c0b628c7a.jpeg" class="thumbnail" width="690" height="255"></div>

<div class="title-wrapper">
  <h3><a href="https://forums.whonix.org/t/usbguard-on-kicksecure-to-prevent-hardware-keyloggers-badusb/11988" target="_blank" rel="noopener">USBGuard on Kicksecure to prevent hardware keyloggers/BadUSB</a></h3>
  <div class="topic-category">
      <span class="badge-wrapper bullet">
        <span class="badge-category-bg" style="background-color: #25AAE2;"></span>
        <span class="badge-category clear-badge">
          <span class="category-name">Development</span>
        </span>
      </span>
  </div>
</div>

  <p>“The USBGuard software framework helps to protect your computer against rogue USB devices (a.k.a. [BadUSB]) by implementing basic whitelisting and blacklisting capabilities based on device attributes.”  From their Github.  Maybe could help someone...</p>


  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubissue" data-onebox-src="https://github.com/QubesOS/qubes-issues/issues/10174">
  <header class="source">

      <a href="https://github.com/QubesOS/qubes-issues/issues/10174" target="_blank" rel="noopener">github.com/QubesOS/qubes-issues</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue" data-github-private-repo="false">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/QubesOS/qubes-issues/issues/10174" target="_blank" rel="noopener">Consider the impact of USBGuard in sys-usb</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2025-08-22" data-time="18:22:07" data-timezone="UTC">06:22PM - 22 Aug 25 UTC</span>
      </div>

        <div class="date">
          closed <span class="discourse-local-date" data-format="ll" data-date="2025-08-23" data-time="00:42:19" data-timezone="UTC">12:42AM - 23 Aug 25 UTC</span>
        </div>

      <div class="user">
        <a href="https://github.com/ArrayBolt3" target="_blank" rel="noopener">
          <img alt="" src="https://avatars.githubusercontent.com/u/104878738?v=4" class="onebox-avatar-inline" width="20" height="20">
          ArrayBolt3
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          R: not applicable
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          P: default
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">[How to file a helpful issue](https://www.qubes-os.org/doc/issue-tracking/)

I a<span class="show-more-container"><a href="" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">pologize in advance if this isn't really the right spot for this, I couldn't find a "development" category on the forums so this is the closest I could figure out.

### The problem you're addressing (if any)

In Kicksecure 18 and higher, we're going to be shipping USBGuard, enabled by default, with a configuration that allows all devices that are present in the system on bootup, and blocks all non-whitelisted devices that are plugged in after bootup. By default, the whitelist in Kicksecure will allow USB mass storage devices, and will allow a single mouse and keyboard at a time (additional keyboards are rejected). All other devices are rejected, including devices that combine a USB mass storage interface with anything else, and devices that combine a keyboard or mouse interface with anything (except for "unified" keyboard/mouse devices like are common with some wireless receivers). The goal is to allow a limited subset of common USB devices to work out of the box, while also thwarting devices like the USB "rubber ducky".

This feature set makes good sense for Kicksecure on the desktop, but we're unsure if it makes sense in Qubes OS, if a user chooses to use Kicksecure on sys-usb. On the one hand, USBGuard in sys-usb could substantially increase the security of users who have to pass through USB keyboards and mice to dom0 (only one keyboard and mouse would be allowed, a keystroke injection device would be rejected so long as it was not present when sys-usb booted and a legitimate USB keyboard was already plugged in). On the other hand, USBGuard could frustrate users who need to work with things such as USB headsets, webcams, touchscreens, and other "advanced" devices. In theory a user could reboot sys-usb to get these devices to work (assuming our configuration actually does trust everything present on bootup), but maybe that's too much hassle?

The USBGuard configuration we intend to ship in Kicksecure 18 can be seen [here](https://github.com/Kicksecure/security-misc/blob/master/etc/usbguard/rules.d/30_security-misc.conf).

### The solution you'd like

Determine if USBGuard in a Kicksecure-based sys-usb makes sense, and if any configuration changes are needed in the event it is useful in Qubes OS.

### The value to a user and who that user might be

If we choose to leave it enabled, users will be able to pass through input devices to dom0 with less risk of malicious devices being able to take over the system.

If we choose to disable it, users won't end up facing new issues with USB device passthrough.

### Completion criteria checklist

(This section is for developer use only. Please do not modify it.)</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>

<aside class="onebox githubissue" data-onebox-src="https://github.com/QubesOS/qubes-issues/issues/8820">
  <header class="source">

      <a href="https://github.com/QubesOS/qubes-issues/issues/8820" target="_blank" rel="noopener">github.com/QubesOS/qubes-issues</a>
  </header>

  <article class="onebox-body">
    <div class="github-row">
  <div class="github-icon-container" title="Issue" data-github-private-repo="false">
	  <svg width="60" height="60" class="github-icon" viewBox="0 0 14 16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg>
  </div>

  <div class="github-info-container">
    <h4>
      <a href="https://github.com/QubesOS/qubes-issues/issues/8820" target="_blank" rel="noopener">Hardened option for single USB keyboard</a>
    </h4>

    <div class="github-info">
      <div class="date">
        opened <span class="discourse-local-date" data-format="ll" data-date="2024-01-02" data-time="12:29:26" data-timezone="UTC">12:29PM - 02 Jan 24 UTC</span>
      </div>


      <div class="user">
        <a href="https://github.com/emanruse" target="_blank" rel="noopener">
          <img alt="" src="https://avatars.githubusercontent.com/u/40140013?v=4" class="onebox-avatar-inline" width="20" height="20">
          emanruse
        </a>
      </div>
    </div>

    <div class="labels">
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          P: default
        </span>
        <span style="display:inline-block;margin-top:2px;background-color: #B8B8B8;padding: 2px;border-radius: 4px;color: #fff;margin-left: 3px;">
          C: input proxy
        </span>
    </div>
  </div>
</div>

  <div class="github-row">
    <p class="github-body-container">### The problem you're addressing (if any)

Currently, on systems which can us<span class="show-more-container"><a href="" rel="noopener" class="show-more">…</a></span><span class="excerpt hidden">e only USB keyboards, it seems possible to have unrestricted number of such USB keyboards that are automatically allowed to connect to dom0 due to `/etc/qubes-rpc/policy/qubes.InputKeyboard` permissive policy. This makes it possible a malicious USB device (e.g. a USB memory stick) to represent itself as a keyboard, do its mischief, then switch back to being a non-keyboard.

Using usbguard inside sys-usb to allow only specific predefined keyboards is a possibility, however it might result in a situation when the user gets locked out of the system. Example: The user has only one physical keyboard and whitelists it in usbguard rules. If the keyboard hardware stops functioning (e.g. the keyboard is physically damaged), the user will be compelled to replace it with another. However, since the new keyboard will not be whitelisted, the user won't be able to access the system through it, regardless of the fact that it is a good (non-malicious) device.


### The solution you'd like

Provide an option (perhaps even enforced by default) which allows the user to restrict the number of possible USB keyboards on the system to 1 (one) at a time.


### The value to a user, and who that user might be

The proposed solution would make it impossible for a malicious device to act as described, as a second keyboard will be denied. The only way to use another USB keyboard would be to physically disconnect the first one, then connect another. That must also be documented properly.

#### Possible caveat

**I don't know if that is possible** (there are [some](https://forums.tomshardware.com/threads/every-usb-port-will-randomly-disconnect-for-a-few-seconds-on-new-pc.3793952/) [reports](https://superuser.com/questions/1450976/external-usb-hard-drive-momentarily-disconnects-when-additional-external-hard-dr)), but just for extra consideration:

If for some reason (e.g. a driver bug, power related issues or other) the malicious USB device is able to cause the original keyboard to (appear to) disconnect or simply "sneak in" while the original good keyboard is actually disconnected, the proposed solution will not work *per se* - the malicious device may still connect as a keyboard and accomplish the described attack, and during that period the actual keyboard will be blocked. To prevent such possibility, additional possible measures to the solution might be:

- Enable any newly connected USB keyboard **only after reboot**

In this way, even if a temporary disconnect happens, no other device would be able to take over a running the system, because to accomplish an attack the malicious device would have to cause a reboot of dom0 through sys-usb, which seems impossible in Qubes OS (at least not without a serious security bug).

- UI for easy whitelisting of newly connected keyboards (using usbguard rules in sys-usb)

Without other input device (e.g. at least a mouse able to click and confirm the newly connected keyboards), a possibility for user input might be the power button of the system. A service like `acpid` may be used to monitor for events. Example usage:

A new keyboard is connected. The UI dialog shows up and asks for confirmation. The user is required to press the power button of the system to activate the new keyboard, after which it gets whitelisted in `/etc/usbguard/rules`. The `acpid` service may probably run in a separate VM (sys-acpi), thus making it impossible for a malicious device to attack both sys-usb and sys-acpi. Having sys-acpi may even provide extra security, e.g. the number of presses within a period of time might be configurable, e.g. "must press 3 times within 10 seconds", and may serve as a "password" for allowing new USB devices.

**Additional notes**:

As by default passwordless root is enabled in VMs, whitelisting devices in sys-usb itself may turn out vulnerable. I don't know what inter-VM communication mechanism for this may be suitable but it seems better to isolate the "credentials" of devices - have another VM store and verify if a device is whitelisted, then report the result back to sys-usb.</span></p>
  </div>

  </article>

  <div class="onebox-metadata">
    
    
  </div>

  <div style="clear: both"></div>
</aside>
 ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_4</link>
        <pubDate>Mon, 25 Aug 2025 15:18:12 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3272</guid>
      </item>
      <item>
        <title>The workstation has stopped booting.</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>See also <a href="https://www.kicksecure.com/wiki/Recovery#Hard_Drive_Recovery">Hard Drive Recovery</a>.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/the-workstation-has-stopped-booting/1246#post_3</link>
        <pubDate>Mon, 25 Aug 2025 15:13:48 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3271</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <ul>
<li><strong>User documentation recommending against dual-boot / multi-boot:</strong> Wiki chapter <a href="https://www.kicksecure.com/wiki/System_Configuration_and_Access#Use_a_Dedicated_Host_Operating_System_and_Computer">Use a Dedicated Host Operating System and Computer</a>.</li>
<li><strong>Security support:</strong> None required related specifically to dual/multi boot.</li>
<li><strong>Security impact:</strong> Almost entirely the same discussion as <a href="https://forums.kicksecure.com/t/no-rescue-mode/1171" class="inline-onebox">No Rescue Mode</a>.</li>
<li><strong>Overhead from dual-boot / multi-boot technical/documentation/forum support requests:</strong> Non-existing at this point. I could not find any questions at this time on the topic of dual-boot / multi-boot support requests. If this were to happen minimal to no time would be spend on these requests as this is notoriously difficult to debug. This would most likely be redirected as per <a href="https://www.kicksecure.com/wiki/Unspecific" class="inline-onebox">Potential Solutions Beyond Kicksecure!</a> and <a href="https://www.kicksecure.com/wiki/Self_Support_First_Policy" class="inline-onebox">Self Support First Policy for Kicksecure</a>.</li>
<li><strong>Developer use cases</strong>: These remain “supported” (as in “possible”) (as in developers can figure it out) without “support” from the project required. When Kicksecure is installed on standard Intel/AMD64 hardware, this feature is a by-product. There is nothing useful from a security point of view that we can do to stop “supporting” (meaning, this being possible) that feature.</li>
<li><strong>Future:</strong> As we make more progress towards <a href="https://www.kicksecure.com/wiki/Verified_Boot" class="inline-onebox">Verified Boot</a> (<a href="https://forums.kicksecure.com/t/verified-boot-development-discussion/901" class="inline-onebox">Verified Boot - Development Discussion</a>), the issues discussed in <a href="https://forums.kicksecure.com/t/protecting-the-kernel-command-line/1251" class="inline-onebox">Protecting the Kernel Command Line</a> and <a href="https://forums.kicksecure.com/t/no-rescue-mode/1171" class="inline-onebox">No Rescue Mode</a> and this forum thread will organically be considered.</li>
<li><strong>Solution:</strong> Once hardware becomes available that supports <a href="https://www.kicksecure.com/wiki/Sovereign_Boot" class="inline-onebox">Sovereign Boot</a>, dual/multi boot security concerns can be addressed.</li>
</ul> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_5</link>
        <pubDate>Mon, 25 Aug 2025 14:38:20 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3270</guid>
      </item>
      <item>
        <title>Protecting the Kernel Command Line</title>
        <dc:creator><![CDATA[@Patrick]]></dc:creator>
        <description><![CDATA[ <p>new wiki chapter:<br>
<a href="https://www.kicksecure.com/wiki/Verified_Boot#Protecting_the_Kernel_Command_Line">Protecting the Kernel Command Line</a></p> ]]></description>
        <link>https://forums.kicksecure.com/t/protecting-the-kernel-command-line/1251#post_1</link>
        <pubDate>Mon, 25 Aug 2025 14:31:35 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3269</guid>
      </item>
      <item>
        <title>USBGuard - what should we allow or disallow by default?</title>
        <dc:creator><![CDATA[@nurmagoz]]></dc:creator>
        <description><![CDATA[ <aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>We don’t want to block so much that users disable USBGuard because they can’t live with it, but we also don’t want to allow so much that malicious devices work in common configurations.</p>
</blockquote>
</aside>
<p>If it were me, I wouldn’t have given this a second thought. If security requires disabling so much, then it is what it is.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>2FA keys</p>
</blockquote>
</aside>
<p>Good to have.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="1" data-topic="1248">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>Anything else we should consider allowing or not allowing by default?</p>
</blockquote>
</aside>
<p>Old bs stuff e.g:</p>
<ul>
<li>USB to VGA?</li>
<li>USB joysticks?</li>
<li>Consider to allow only 3 and above USB version?</li>
</ul> ]]></description>
        <link>https://forums.kicksecure.com/t/usbguard-what-should-we-allow-or-disallow-by-default/1248#post_3</link>
        <pubDate>Mon, 25 Aug 2025 08:09:43 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3267</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@nurmagoz]]></dc:creator>
        <description><![CDATA[ <p>This aligns with the OS/hardware relation, as I have pointed out (in “Operating System from Heaven”) the insecurity of having a separation between OS and hardware. There is another threat, which is having multiboot, as it poses stability and security issues.</p>
<p>So it’s like a path of a consistent, homogeneous methodology for security.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="2" data-topic="1249">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>multiboot may be very valuable for developer use cases</p>
</blockquote>
</aside>
<p>We should not have a single concern about what xyz wants to have on his laptop. Our concern is to deliver the best security possible for the end user while he’s using our OS/products. If something doesn’t work unless you allow insecurities, it is unsupported.</p>
<aside class="quote no-group" data-username="arraybolt3" data-post="2" data-topic="1249">
<div class="title">
<div class="quote-controls"></div>
<img alt="" width="24" height="24" src="https://forums.kicksecure.com/user_avatar/forums.kicksecure.com/arraybolt3/48/88_2.png" class="avatar"> arraybolt3:</div>
<blockquote>
<p>I for instance run a multiboot setup on my test laptop, Kubuntu/Lubuntu/Qubes OS/Debian/Arch.</p>
</blockquote>
</aside>
<p>The user is going to need to play with those on bare metal VM or emulator. Or buy insecure, testing purpose hardware (secure OS/hardware doesn’t support this).</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_3</link>
        <pubDate>Mon, 25 Aug 2025 07:42:16 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3266</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@arraybolt3]]></dc:creator>
        <description><![CDATA[ <p>Might be worth drawing a line between “security support” and “technical support” here - multiboot may be very valuable for developer use cases (where all operating systems on the system are trusted equally). Such a setup may be discouraged from a security standpoint, but essential for development. I for instance run a multiboot setup on my test laptop, Kubuntu/Lubuntu/Qubes OS/Debian/Arch.</p>
<p>Qubes OS doesn’t <em>support</em> multiboot, but in practice it can be multibooted pretty easily.</p>
<p>Also, how would this interact with portable installations? They have some of the same risks, but may be very valuable because they can provide enhanced security even when a user has to use a machine that runs less secure operating systems other times.</p> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_2</link>
        <pubDate>Sun, 24 Aug 2025 17:56:37 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3264</guid>
      </item>
      <item>
        <title>Unsupported Multi/Dual Boot [Developers-Only Discussion]</title>
        <dc:creator><![CDATA[@nurmagoz]]></dc:creator>
        <description><![CDATA[ <p>Its not only can cause a usability issue as <a href="https://www.kicksecure.com/wiki/Troubleshooting#Dual_Boot">mentioned here</a>, but its a <a href="https://forum.qubes-os.org/t/multibooting-qubes/18988">security issue</a> as well:</p>
<blockquote>
<p>One problem is that when you dual or multiboot, even if you are using encryption on your Qubes installation, /boot is still unprotected and could be maliciously modified by the other OS, possibly leading to Qubes itself being maliciously modified.</p>
<p>The other problem is firmware security - for example the other system could infect the BIOS firmware, which might enable compromise or spying on the Qubes system.</p>
</blockquote> ]]></description>
        <link>https://forums.kicksecure.com/t/unsupported-multi-dual-boot-developers-only-discussion/1249#post_1</link>
        <pubDate>Sun, 24 Aug 2025 17:29:19 +0000</pubDate>
        <guid isPermaLink="false">forums.kicksecure.com-post-3263</guid>
      </item>
  </channel>
</rss>
